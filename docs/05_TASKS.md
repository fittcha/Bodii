# Bodii - TaskMaster 태스크 목록

## 프로젝트 메타데이터

```json
{
  "projectName": "Bodii",
  "version": "1.0.0",
  "description": "AI 기반 건강 관리 iOS 앱",
  "techStack": ["SwiftUI", "Core Data", "HealthKit"],
  "phases": ["MVP", "AI", "Social"]
}
```

---

## Phase 1: MVP

### 1. 프로젝트 설정

#### TASK-001: Xcode 프로젝트 생성
- **우선순위**: Critical
- **예상 시간**: 1h
- **의존성**: 없음
- **설명**: SwiftUI 기반 iOS 프로젝트 생성
- **체크리스트**:
  - [ ] Xcode 프로젝트 생성 (iOS 17+, SwiftUI)
  - [ ] Bundle Identifier 설정
  - [ ] 기본 폴더 구조 생성
  - [ ] .gitignore 설정
  - [ ] README.md 작성

#### TASK-002: Core Data 모델 설정
- **우선순위**: Critical
- **예상 시간**: 4h
- **의존성**: TASK-001
- **설명**: ERD 기반 Core Data 모델 구현
- **체크리스트**:
  - [ ] .xcdatamodeld 파일 생성
  - [ ] User Entity 생성 (current* 필드 포함)
  - [ ] BodyRecord Entity 생성
  - [ ] MetabolismSnapshot Entity 생성 (신규)
  - [ ] Food Entity 생성
  - [ ] FoodRecord Entity 생성 (calculated* 필드 포함)
  - [ ] ExerciseRecord Entity 생성
  - [ ] SleepRecord Entity 생성
  - [ ] DailyLog Entity 생성 (확장된 필드)
  - [ ] Goal Entity 생성 (goalType, start* 필드 포함)
  - [ ] Entity 관계 설정
  - [ ] PersistenceController 구현

#### TASK-003: 앱 아키텍처 설정
- **우선순위**: High
- **예상 시간**: 2h
- **의존성**: TASK-001
- **설명**: MVVM 아키텍처 기반 구조 설정
- **체크리스트**:
  - [ ] 폴더 구조 생성 (Views, ViewModels, Models, Services, Utils)
  - [ ] 공통 Extension 파일 생성
  - [ ] 색상/폰트 에셋 정의
  - [ ] 환경 변수 설정 (Config)

#### TASK-004: 앱 상태 관리 서비스
- **우선순위**: Critical
- **예상 시간**: 2h
- **의존성**: TASK-001
- **설명**: 앱 상태 (첫 실행, 온보딩 완료 등) 관리
- **체크리스트**:
  - [ ] AppStateService 클래스 생성
  - [ ] UserDefaults 기반 상태 저장
  - [ ] 첫 실행 여부 확인 메서드
  - [ ] 온보딩 완료 여부 확인 메서드
  - [ ] 오늘 수면 팝업 표시 여부 확인 (스킵 횟수 포함)

#### TASK-005: 날짜 유틸리티 서비스
- **우선순위**: Critical
- **예상 시간**: 2h
- **의존성**: TASK-001
- **설명**: 앱 전반에서 사용할 날짜 관련 유틸리티
- **체크리스트**:
  - [ ] DateUtils 클래스 생성
  - [ ] 하루 기준 로직 (02:00 기준 수면일 계산)
  - [ ] 날짜 포맷터 ("yyyy.MM.dd", "M월 d일" 등)
  - [ ] 날짜 비교 메서드 (isSameDay, isToday, daysBetween)
  - [ ] 주간/월간 기간 계산
  - [ ] 자정/새벽 2시 경계 처리

#### TASK-006: 입력 검증 유틸리티
- **우선순위**: High
- **예상 시간**: 2h
- **의존성**: TASK-001
- **설명**: 체성분, 음식, 수면 등 입력값 검증
- **체크리스트**:
  - [ ] ValidationService 클래스 생성
  - [ ] 체성분 검증 (키: 100~250cm, 체중: 20~300kg, 체지방률: 1~60%)
  - [ ] 수면 시간 검증 (최소 0분, 최대 24시간)
  - [ ] 음식 칼로리/영양소 검증 (양수, 섭취량 최소 0.1)
  - [ ] 운동 시간 검증 (최소 1분)
  - [ ] 에러 메시지 생성 로직

---

### 2. 온보딩

#### TASK-010: 온보딩 UI 구현
- **우선순위**: High
- **예상 시간**: 6h
- **의존성**: TASK-001, TASK-002, TASK-004
- **설명**: 첫 실행 시 온보딩 화면 구현
- **체크리스트**:
  - [ ] 온보딩 PageView 구현
  - [ ] 앱 소개 화면
  - [ ] 기본 정보 입력 화면 (이름, 성별, 생년월일)
  - [ ] 체성분 입력 화면 (키, 몸무게)
  - [ ] 활동 수준 선택 화면
  - [ ] 온보딩 진행 상태 저장 (중간 종료 대비)
  - [ ] 온보딩 완료 플래그 저장

#### TASK-011: 사용자 데이터 저장 로직
- **우선순위**: High
- **예상 시간**: 3h
- **의존성**: TASK-002, TASK-010, TASK-043
- **설명**: User Entity 저장 및 BMR/TDEE 초기 계산
- **체크리스트**:
  - [ ] UserService 클래스 생성
  - [ ] 사용자 생성 메서드 (+ BMR/TDEE 계산하여 current* 저장)
  - [ ] 사용자 조회 메서드
  - [ ] 사용자 수정 메서드 (+ 필요시 BMR/TDEE 재계산)
  - [ ] User.current* 필드 업데이트 로직

---

### 3. 탭 네비게이션

#### TASK-020: 메인 TabView 구현
- **우선순위**: Critical
- **예상 시간**: 2h
- **의존성**: TASK-001
- **설명**: 하단 탭 네비게이션 구현
- **체크리스트**:
  - [ ] TabView 구현 (홈, 식단, 운동, 수면, 설정)
  - [ ] 탭 아이콘 및 라벨 설정
  - [ ] 각 탭별 빈 View 연결

---

### 4. 홈 (대시보드)

#### TASK-030: 대시보드 UI 구현
- **우선순위**: High
- **예상 시간**: 4h
- **의존성**: TASK-020
- **설명**: 홈 화면 대시보드 UI
- **체크리스트**:
  - [ ] 일일 칼로리 현황 카드 (원형 프로그레스)
  - [ ] 매크로 현황 바 차트
  - [ ] 오늘의 운동 요약 카드
  - [ ] 수면 상태 카드 (🔵/🟢/🟡/🔴/🟠)
  - [ ] 체성분 요약 카드
  - [ ] 날짜 표시

#### TASK-031: 대시보드 ViewModel
- **우선순위**: High
- **예상 시간**: 2h
- **의존성**: TASK-030, TASK-002, TASK-035
- **설명**: 대시보드 데이터 로직 (계산 없이 조회만)
- **체크리스트**:
  - [ ] DashboardViewModel 생성
  - [ ] User에서 currentTDEE, currentWeight 조회
  - [ ] DailyLog에서 오늘 데이터 조회
  - [ ] 데이터 없을 때 기본값 처리
  - [ ] 로딩/에러 상태 관리

---

### 5. DailyLog 관리

#### TASK-035: DailyLog 서비스
- **우선순위**: Critical
- **예상 시간**: 4h
- **의존성**: TASK-002, TASK-005
- **설명**: DailyLog 생성/업데이트/조회 서비스
- **체크리스트**:
  - [ ] DailyLogService 클래스 생성
  - [ ] getOrCreate(for date) 메서드 - 없으면 User.current* 값으로 생성
  - [ ] 음식 추가 시 증분 업데이트 메서드
  - [ ] 음식 삭제 시 감소 업데이트 메서드
  - [ ] 운동 추가/삭제 시 업데이트 메서드
  - [ ] 체성분 입력 시 업데이트 메서드 (당일만)
  - [ ] 수면 입력 시 업데이트 메서드
  - [ ] 매크로 비율 재계산 로직
  - [ ] netCalories 재계산 로직

---

### 6. 체성분 관리

#### TASK-040: 체성분 목록 화면
- **우선순위**: High
- **예상 시간**: 3h
- **의존성**: TASK-020, TASK-002
- **설명**: 체성분 기록 히스토리 화면
- **체크리스트**:
  - [ ] 체성분 목록 View (최신순)
  - [ ] 리스트 아이템 (날짜, 체중, 체지방률, 변화량)
  - [ ] 수정/삭제 스와이프 액션

#### TASK-041: 체성분 입력 모달
- **우선순위**: High
- **예상 시간**: 3h
- **의존성**: TASK-040, TASK-006
- **설명**: 체성분 기록 입력 화면
- **체크리스트**:
  - [ ] Sheet 모달 구현
  - [ ] 측정일 선택 (DatePicker, 기본값: 현재 일시)
  - [ ] 몸무게 입력 (필수)
  - [ ] 체지방량 입력 (선택)
  - [ ] 체지방률 입력 (선택)
  - [ ] 체지방량/체지방률 자동 계산 로직
  - [ ] 골격근량 입력 (선택)
  - [ ] 유효성 검증 (ValidationService 사용)
  - [ ] 저장 로직

#### TASK-042: 체성분 그래프
- **우선순위**: Medium
- **예상 시간**: 5h
- **의존성**: TASK-040, TASK-044
- **설명**: 체성분 변화 추이 그래프
- **체크리스트**:
  - [ ] Swift Charts 구현
  - [ ] 몸무게 라인 차트
  - [ ] 체지방률 라인 차트 (토글)
  - [ ] BMR/TDEE 라인 차트 (토글) - MetabolismSnapshot 사용
  - [ ] 기간 필터 (1주, 1개월, 3개월, 6개월, 1년)
  - [ ] 데이터 포인트 터치 시 상세 정보

#### TASK-043: BMR/TDEE 계산 서비스
- **우선순위**: Critical
- **예상 시간**: 2h
- **의존성**: TASK-002
- **설명**: 기초대사량, 활동대사량 계산
- **체크리스트**:
  - [ ] MetabolismService 클래스 생성
  - [ ] Katch-McArdle BMR 계산 (체지방률 있을 때)
  - [ ] Mifflin-St Jeor BMR 계산 (체지방률 없을 때)
  - [ ] TDEE 계산 (BMR × 활동계수)
  - [ ] 활동계수 Enum 정의

#### TASK-044: 체성분 저장 서비스
- **우선순위**: Critical
- **예상 시간**: 3h
- **의존성**: TASK-002, TASK-043, TASK-035
- **설명**: 체성분 저장 + 연쇄 업데이트
- **체크리스트**:
  - [ ] BodyRecordService 클래스 생성
  - [ ] 체성분 저장 메서드
  - [ ] User.current* 업데이트 (BMR/TDEE 포함)
  - [ ] MetabolismSnapshot 생성
  - [ ] DailyLog 업데이트 (당일인 경우)
  - [ ] 체성분 수정 시 연쇄 업데이트
  - [ ] 체성분 삭제 시 연쇄 업데이트 (최신 기록으로 재계산)

---

### 7. 식단 관리

#### TASK-050: 식단 일별 화면
- **우선순위**: High
- **예상 시간**: 4h
- **의존성**: TASK-020, TASK-002, TASK-035
- **설명**: 일별 식단 기록 화면
- **체크리스트**:
  - [ ] 날짜 선택 헤더 (좌우 이동)
  - [ ] 끼니별 섹션 (아침/점심/저녁/간식)
  - [ ] 각 섹션 음식 리스트
  - [ ] 음식 추가 버튼
  - [ ] 일일 총 칼로리/매크로 표시 (DailyLog에서 조회)
  - [ ] 매크로 비율 원 그래프 (DailyLog.*Ratio 사용)
  - [ ] 음식 삭제 스와이프

#### TASK-051: 음식 검색 화면
- **우선순위**: High
- **예상 시간**: 3h
- **의존성**: TASK-050
- **설명**: 음식 검색 및 선택 화면
- **체크리스트**:
  - [ ] 검색바 구현
  - [ ] 검색 결과 리스트
  - [ ] 최근 먹은 음식 섹션
  - [ ] 사용자 정의 음식 섹션
  - [ ] 음식 선택 시 상세 화면 이동

#### TASK-052: 식약처 API 연동
- **우선순위**: High
- **예상 시간**: 6h
- **의존성**: TASK-051
- **설명**: 식약처 식품영양성분DB API 연동 (한국 음식)
- **체크리스트**:
  - [ ] FoodAPIService 클래스 생성
  - [ ] API 키 관리 (Config)
  - [ ] 음식 검색 API 호출
  - [ ] 응답 파싱 및 Food Entity 변환
  - [ ] 에러 핸들링 (네트워크, 타임아웃, 파싱)
  - [ ] 로딩 상태 관리
  - [ ] 검색 결과 캐싱 (선택)

#### TASK-052-B: USDA API 연동
- **우선순위**: Medium
- **예상 시간**: 4h
- **의존성**: TASK-052
- **설명**: USDA FoodData Central API 연동 (외국 음식)
- **체크리스트**:
  - [ ] USDA API 키 발급 및 관리
  - [ ] 검색 API 호출
  - [ ] 응답 파싱 (영어 → Food 모델)
  - [ ] 영양정보 단위 변환 (oz → g 등)
  - [ ] 에러 핸들링

#### TASK-052-C: 통합 음식 검색 서비스
- **우선순위**: High
- **예상 시간**: 2h
- **의존성**: TASK-052, TASK-052-B
- **설명**: 식약처 + USDA 통합 검색 로직
- **체크리스트**:
  - [ ] UnifiedFoodSearchService 클래스 생성
  - [ ] 1순위: 식약처 검색
  - [ ] 2순위: 결과 없으면 USDA 검색
  - [ ] 3순위: 결과 없으면 직접 입력 유도
  - [ ] 검색 결과 병합 및 우선순위 정렬

#### TASK-053: 음식 상세 및 추가 화면
- **우선순위**: High
- **예상 시간**: 3h
- **의존성**: TASK-051, TASK-052-C, TASK-056
- **설명**: 음식 영양정보 및 섭취량 입력
- **체크리스트**:
  - [ ] 영양정보 표시 (칼로리, 탄단지, 나트륨)
  - [ ] 섭취량 입력 (인분 또는 g)
  - [ ] 끼니 선택
  - [ ] 칼로리/영양소 자동 계산
  - [ ] FoodRecord 저장 (FoodRecordService 호출)

#### TASK-054: 음식 직접 입력 화면
- **우선순위**: Medium
- **예상 시간**: 2h
- **의존성**: TASK-051, TASK-006
- **설명**: DB에 없는 음식 직접 입력
- **체크리스트**:
  - [ ] 음식명 입력
  - [ ] 칼로리/탄단지 입력
  - [ ] 1회 제공량 입력
  - [ ] 유효성 검증
  - [ ] 사용자 정의 Food 저장 (source = 2)

#### TASK-055: AI 식단 코멘트 기능
- **우선순위**: High
- **예상 시간**: 6h
- **의존성**: TASK-053
- **설명**: 끼니 입력 완료 시 Gemini API로 코멘트 생성
- **체크리스트**:
  - [ ] GeminiService 클래스 생성
  - [ ] API 키 관리 (Config)
  - [ ] 프롬프트 설계 (식단 정보 + User.currentTDEE 전달)
  - [ ] 응답 파싱 (좋은점, 개선점, 총평, 점수)
  - [ ] 코멘트 팝업 UI
  - [ ] 로딩/에러 상태 처리
  - [ ] Rate Limit 처리 (15 RPM)
  - [ ] 오프라인 시 기본 메시지 표시

#### TASK-056: 음식 기록 서비스
- **우선순위**: Critical
- **예상 시간**: 2h
- **의존성**: TASK-002, TASK-035
- **설명**: 음식 기록 저장 + DailyLog 연쇄 업데이트
- **체크리스트**:
  - [ ] FoodRecordService 클래스 생성
  - [ ] 음식 추가 메서드 (+ DailyLog 증분)
  - [ ] 음식 수정 메서드 (+ DailyLog 조정)
  - [ ] 음식 삭제 메서드 (+ DailyLog 감소)

---

### 8. 운동 관리

#### TASK-060: 운동 기록 화면
- **우선순위**: High
- **예상 시간**: 3h
- **의존성**: TASK-020, TASK-002, TASK-035
- **설명**: 운동 기록 목록 화면
- **체크리스트**:
  - [ ] 날짜별 운동 목록
  - [ ] 운동 카드 (종류, 시간, 칼로리)
  - [ ] 오늘의 총 소모 칼로리 (DailyLog에서 조회)
  - [ ] 총 운동 시간 (DailyLog.exerciseMinutes)
  - [ ] 걸음 수 표시 (DailyLog.steps)
  - [ ] 운동 추가 버튼

#### TASK-061: 운동 입력 모달
- **우선순위**: High
- **예상 시간**: 3h
- **의존성**: TASK-060, TASK-062, TASK-006
- **설명**: 운동 기록 입력 화면
- **체크리스트**:
  - [ ] 운동 종류 선택 그리드
  - [ ] 운동 시간 입력 (최소 1분 검증)
  - [ ] 강도 선택 (저/중/고)
  - [ ] 예상 소모 칼로리 실시간 계산 (User.currentWeight 사용)
  - [ ] ExerciseRecord 저장 (ExerciseRecordService 호출)

#### TASK-062: MET 기반 칼로리 계산
- **우선순위**: High
- **예상 시간**: 2h
- **의존성**: TASK-002
- **설명**: 운동별 칼로리 소모량 계산
- **체크리스트**:
  - [ ] ExerciseCalcService 클래스 생성
  - [ ] MET 값 테이블 정의 (운동 종류 × 강도)
  - [ ] 소모 칼로리 계산 (MET × User.currentWeight × 시간)

#### TASK-063: 운동 기록 서비스
- **우선순위**: Critical
- **예상 시간**: 2h
- **의존성**: TASK-002, TASK-035, TASK-062
- **설명**: 운동 기록 저장 + DailyLog 연쇄 업데이트
- **체크리스트**:
  - [ ] ExerciseRecordService 클래스 생성
  - [ ] 운동 추가 메서드 (+ DailyLog 증분: totalCaloriesOut, exerciseMinutes, exerciseCount)
  - [ ] 운동 수정 메서드 (+ DailyLog 조정)
  - [ ] 운동 삭제 메서드 (+ DailyLog 감소)

---

### 9. 수면 관리

#### TASK-075: 수면 입력 팝업
- **우선순위**: High
- **예상 시간**: 4h
- **의존성**: TASK-020, TASK-002, TASK-004, TASK-005
- **설명**: 새벽 2시 이후 첫 실행 시 수면 입력 팝업
- **체크리스트**:
  - [ ] 하루 기준 로직 (02:00 ~ 다음날 02:00)
  - [ ] 첫 실행 여부 확인 로직 (AppStateService)
  - [ ] Picker Wheel UI (시/분, 10분 단위)
  - [ ] "나중에" 버튼 처리 (최대 3회 재팝업)
  - [ ] SleepRecord 저장 (SleepRecordService 호출)

#### TASK-076: 수면 상태 계산 서비스
- **우선순위**: High
- **예상 시간**: 1h
- **의존성**: TASK-002
- **설명**: 수면 시간 기준 상태 계산 (5단계)
- **체크리스트**:
  - [ ] SleepCalcService 클래스 생성
  - [ ] 상태 계산 (Bad/Soso/Good/Excellent/Oversleep)
  - [ ] 분 → 시간:분 변환 유틸
  - [ ] 상태별 색상 매핑

#### TASK-077: 수면 탭 화면
- **우선순위**: High
- **예상 시간**: 5h
- **의존성**: TASK-075, TASK-076, TASK-035
- **설명**: 수면 히스토리 및 그래프 화면
- **체크리스트**:
  - [ ] 수면 기록 리스트 (최신순)
  - [ ] 상태별 색상 표시 (🔵/🟢/🟡/🔴/🟠)
  - [ ] 날짜 클릭 시 수정 모달
  - [ ] 수면 바 차트 (상태별 색상) - DailyLog.sleepDuration 사용
  - [ ] 기간 필터 (1주, 1개월, 3개월)
  - [ ] 평균 수면 시간 표시
  - [ ] 상태 범례 표시

#### TASK-078: 수면 기록 서비스
- **우선순위**: Critical
- **예상 시간**: 2h
- **의존성**: TASK-002, TASK-035, TASK-076
- **설명**: 수면 기록 저장 + DailyLog 연쇄 업데이트
- **체크리스트**:
  - [ ] SleepRecordService 클래스 생성
  - [ ] 수면 저장 메서드 (+ 상태 계산 + DailyLog 업데이트)
  - [ ] 수면 수정 메서드 (+ DailyLog 업데이트)
  - [ ] 수면 삭제 메서드 (+ DailyLog null 처리)

---

### 10. HealthKit 연동

#### TASK-070: HealthKit 권한 요청
- **우선순위**: High
- **예상 시간**: 3h
- **의존성**: TASK-001
- **설명**: HealthKit 사용 권한 설정
- **체크리스트**:
  - [ ] HealthKit Capability 추가
  - [ ] Info.plist 권한 설명 추가
  - [ ] HKHealthStore 권한 요청 로직
  - [ ] 권한 상태 확인 메서드

#### TASK-071: HealthKit 데이터 읽기
- **우선순위**: High
- **예상 시간**: 4h
- **의존성**: TASK-070, TASK-035
- **설명**: HealthKit에서 데이터 가져오기
- **체크리스트**:
  - [ ] HealthKitService 클래스 생성
  - [ ] 걸음 수 조회 → DailyLog.steps 업데이트
  - [ ] 활동 칼로리 조회
  - [ ] 운동 데이터 조회 (중복 체크: healthKitId)
  - [ ] 체중 데이터 조회
  - [ ] 백그라운드 업데이트 (옵션)

#### TASK-072: HealthKit 데이터 쓰기
- **우선순위**: Low
- **예상 시간**: 2h
- **의존성**: TASK-070
- **설명**: Bodii 데이터를 HealthKit에 저장
- **체크리스트**:
  - [ ] 체중 데이터 저장
  - [ ] 체지방률 저장
  - [ ] 식이 칼로리 저장

---

### 11. 설정

#### TASK-080: 설정 화면 UI
- **우선순위**: Medium
- **예상 시간**: 3h
- **의존성**: TASK-020
- **설명**: 설정 메뉴 화면 구현
- **체크리스트**:
  - [ ] 설정 목록 View
  - [ ] 프로필 섹션 링크
  - [ ] 신체 정보 섹션 링크
  - [ ] HealthKit 연동 토글
  - [ ] 알림 설정 섹션
  - [ ] 앱 정보 섹션

#### TASK-081: 프로필 수정 화면
- **우선순위**: Medium
- **예상 시간**: 2h
- **의존성**: TASK-080, TASK-011
- **설명**: 사용자 프로필 수정
- **체크리스트**:
  - [ ] 이름, 성별, 생년월일 수정
  - [ ] 키, 활동 수준 수정 (+ BMR/TDEE 재계산 트리거)
  - [ ] User 업데이트 로직

---

### 12. 테스트 및 마무리

#### TASK-090: 유닛 테스트
- **우선순위**: Medium
- **예상 시간**: 5h
- **의존성**: 전체 기능 완료 후
- **설명**: 핵심 로직 테스트
- **체크리스트**:
  - [ ] BMR/TDEE 계산 테스트
  - [ ] MET 칼로리 계산 테스트
  - [ ] 수면 상태 계산 테스트
  - [ ] 날짜 유틸 테스트 (02:00 경계)
  - [ ] DailyLog 증분/감소 테스트
  - [ ] 매크로 비율 계산 테스트

#### TASK-091: UI 테스트
- **우선순위**: Low
- **예상 시간**: 3h
- **의존성**: TASK-090
- **설명**: 주요 플로우 UI 테스트
- **체크리스트**:
  - [ ] 온보딩 플로우
  - [ ] 체성분 기록 플로우
  - [ ] 음식 추가 플로우

#### TASK-092: 앱 아이콘 및 런치 스크린
- **우선순위**: Medium
- **예상 시간**: 2h
- **의존성**: TASK-001
- **설명**: 앱 아이콘 및 시작 화면
- **체크리스트**:
  - [ ] 앱 아이콘 디자인 (Bodii 로고)
  - [ ] 앱 아이콘 등록 (모든 사이즈)
  - [ ] 런치 스크린 구현

#### TASK-093: 앱스토어 준비
- **우선순위**: High
- **예상 시간**: 3h
- **의존성**: 전체 완료 후
- **설명**: 앱스토어 제출 준비
- **체크리스트**:
  - [ ] 스크린샷 준비 (6.5", 5.5")
  - [ ] 앱 설명 작성
  - [ ] 개인정보 처리방침 URL
  - [ ] App Store Connect 설정

---

## Phase 2: AI 기능

### 13. 사진 인식

#### TASK-100: 카메라 및 갤러리 접근
- **우선순위**: High
- **예상 시간**: 3h
- **의존성**: Phase 1 완료
- **설명**: 사진 촬영/선택 기능
- **체크리스트**:
  - [ ] 카메라 권한 요청
  - [ ] 사진 라이브러리 권한 요청
  - [ ] UIImagePickerController 또는 PhotosPicker 구현
  - [ ] 이미지 리사이징

#### TASK-101: Google Cloud Vision API 연동
- **우선순위**: High
- **예상 시간**: 4h
- **의존성**: TASK-100
- **설명**: 이미지에서 음식 인식
- **체크리스트**:
  - [ ] VisionAPIService 클래스 생성
  - [ ] API 키 관리
  - [ ] 이미지 → Base64 변환
  - [ ] Label Detection API 호출
  - [ ] 응답 파싱 (음식 관련 라벨 필터링)
  - [ ] 에러 핸들링
  - [ ] 사용량 추적 (월 1,000건 제한)

#### TASK-102: 인식 결과 → DB 매칭
- **우선순위**: High
- **예상 시간**: 3h
- **의존성**: TASK-101, TASK-052-C
- **설명**: 인식된 라벨로 음식 검색
- **체크리스트**:
  - [ ] 라벨 → 한글 변환 (필요시)
  - [ ] UnifiedFoodSearchService로 검색
  - [ ] 다중 매칭 결과 제안
  - [ ] 매칭 실패 시 직접 입력 유도

#### TASK-103: 인식 결과 수정 UI
- **우선순위**: High
- **예상 시간**: 3h
- **의존성**: TASK-102
- **설명**: 사용자가 인식 결과 수정
- **체크리스트**:
  - [ ] 인식된 음식 목록 표시
  - [ ] 개별 음식 삭제
  - [ ] 음식 추가 (검색)
  - [ ] 각 음식 양 조절
  - [ ] 확정 후 FoodRecord 저장 (FoodRecordService)

---

### 14. 목표 관리

#### TASK-110: 목표 설정 화면
- **우선순위**: High
- **예상 시간**: 5h
- **의존성**: Phase 1 완료
- **설명**: 다중 목표 설정 UI (체중/체지방률/근육량)
- **체크리스트**:
  - [ ] 목표 유형 선택 (감량/유지/증량)
  - [ ] 목표 항목 선택 (체중, 체지방률, 근육량 - 각각 독립 토글)
  - [ ] 각 항목별 목표값 입력
  - [ ] 각 항목별 주간 변화량 입력
  - [ ] 최소 1개 이상 목표 필수 검증
  - [ ] 복수 목표 시 정합성 검증
  - [ ] 예상 달성일 계산 (항목별)
  - [ ] 일일 칼로리 목표 계산 (선택적)
  - [ ] Goal Entity 저장 (start* 스냅샷 포함)

#### TASK-111: 목표 진행률 대시보드
- **우선순위**: High
- **예상 시간**: 5h
- **의존성**: TASK-110
- **설명**: 목표 대비 현황 표시 (다중 목표 지원)
- **체크리스트**:
  - [ ] 설정된 목표만 그래프 표시
  - [ ] 항목별 진행률 바 (시작 → 현재 → 목표)
  - [ ] 항목별 남은 값/기간 표시
  - [ ] 예상 그래프 (실제 vs 예상 라인)
  - [ ] 복수 목표 시 탭 전환 UI
  - [ ] 일일 칼로리 목표 표시 (설정 시)

#### TASK-112: 그래프 자동 업데이트
- **우선순위**: Medium
- **예상 시간**: 3h
- **의존성**: TASK-111
- **설명**: 실제 데이터 기반 예상 경로 조정
- **체크리스트**:
  - [ ] 실제 체중 변화 추적
  - [ ] 예상 경로 재계산 로직
  - [ ] 그래프 업데이트 트리거

---

## Phase 3: 소셜 기능

### 15. 서버 연동

#### TASK-120: 백엔드 서버 구축
- **우선순위**: Critical
- **예상 시간**: 8h
- **의존성**: Phase 2 완료
- **설명**: 소셜 기능용 서버 구축
- **체크리스트**:
  - [ ] 기술 스택 결정 (Spring Boot 또는 Firebase)
  - [ ] 서버 프로젝트 생성
  - [ ] 데이터베이스 설정
  - [ ] API 엔드포인트 설계
  - [ ] 배포 환경 구성

#### TASK-121: 인증 시스템 구현
- **우선순위**: Critical
- **예상 시간**: 6h
- **의존성**: TASK-120
- **설명**: 회원가입/로그인 시스템
- **체크리스트**:
  - [ ] 이메일/비밀번호 인증
  - [ ] Apple 로그인 연동
  - [ ] JWT 토큰 관리
  - [ ] 클라이언트 AuthService

---

### 16. 친구 기능

#### TASK-130: 친구 추가/관리
- **우선순위**: High
- **예상 시간**: 5h
- **의존성**: TASK-121
- **설명**: 친구 시스템 구현
- **체크리스트**:
  - [ ] 닉네임 검색
  - [ ] 친구 요청 보내기
  - [ ] 친구 요청 수락/거절
  - [ ] 친구 목록 조회
  - [ ] 친구 삭제

---

### 17. 커뮤니티

#### TASK-140: 피드 구현
- **우선순위**: High
- **예상 시간**: 6h
- **의존성**: TASK-130
- **설명**: 활동 공유 피드
- **체크리스트**:
  - [ ] 피드 타임라인 UI
  - [ ] 활동 공유 기능
  - [ ] 좋아요 기능
  - [ ] 댓글 기능

#### TASK-141: 챌린지/랭킹
- **우선순위**: Medium
- **예상 시간**: 5h
- **의존성**: TASK-140
- **설명**: 그룹 목표 및 순위
- **체크리스트**:
  - [ ] 챌린지 생성/참여
  - [ ] 챌린지 진행률
  - [ ] 친구 간 랭킹
  - [ ] 전체 랭킹

---

## 태스크 의존성 그래프

```
Phase 1 (MVP)
─────────────────────────────────────────────────────────────────────────

TASK-001 ──┬──→ TASK-002 ──┬──→ TASK-043 ──→ TASK-044 ──→ TASK-042
           │               │         ↓
           │               │   TASK-011 ←── TASK-010
           │               │
           ├──→ TASK-003   ├──→ TASK-035 ──┬──→ TASK-056 ──→ TASK-053
           │               │               ├──→ TASK-063 ──→ TASK-061
           ├──→ TASK-004 ──┼──→ TASK-005   ├──→ TASK-078 ──→ TASK-075
           │               │               └──→ TASK-031
           ├──→ TASK-006   │
           │               ├──→ TASK-040 ──→ TASK-041
           ├──→ TASK-020 ──┤
           │               ├──→ TASK-050 ──→ TASK-051 ──→ TASK-052
           │               │                            ↓
           │               │               TASK-052-B ──→ TASK-052-C
           │               │
           │               ├──→ TASK-060 ──→ TASK-062
           │               │
           │               └──→ TASK-076 ──→ TASK-077
           │
           ├──→ TASK-070 ──→ TASK-071
           │               ↓
           │            TASK-072
           │
           ├──→ TASK-080 ──→ TASK-081
           │
           └──→ TASK-092
                              
                              TASK-090 ──→ TASK-091 ──→ TASK-093


Phase 2 (AI)
─────────────────────────────────────────────────────────────────────────

Phase 1 완료 ──→ TASK-100 ──→ TASK-101 ──→ TASK-102 ──→ TASK-103
            │
            └──→ TASK-110 ──→ TASK-111 ──→ TASK-112


Phase 3 (Social)
─────────────────────────────────────────────────────────────────────────

Phase 2 완료 ──→ TASK-120 ──→ TASK-121 ──→ TASK-130 ──→ TASK-140 ──→ TASK-141
```

---

## 서비스 레이어 정리

### 핵심 서비스 목록

| 서비스 | 담당 | 주요 메서드 |
|--------|------|-------------|
| **UserService** | User CRUD | create, get, update |
| **MetabolismService** | BMR/TDEE 계산 | calculateBMR, calculateTDEE |
| **DailyLogService** | 일일 집계 관리 | getOrCreate, updateFood, updateExercise, updateSleep |
| **BodyRecordService** | 체성분 + 연쇄업데이트 | save, update, delete (+ User, Snapshot, DailyLog) |
| **FoodRecordService** | 음식 + 연쇄업데이트 | add, update, delete (+ DailyLog) |
| **ExerciseRecordService** | 운동 + 연쇄업데이트 | add, update, delete (+ DailyLog) |
| **SleepRecordService** | 수면 + 연쇄업데이트 | save, update, delete (+ DailyLog) |
| **ExerciseCalcService** | MET 칼로리 계산 | calculate |
| **SleepCalcService** | 수면 상태 계산 | calculateStatus |
| **FoodAPIService** | 식약처 API | search |
| **USDAAPIService** | USDA API | search |
| **UnifiedFoodSearchService** | 통합 음식 검색 | search |
| **GeminiService** | AI 코멘트 | generateComment |
| **HealthKitService** | HealthKit 연동 | readSteps, readExercise, write* |
| **AppStateService** | 앱 상태 관리 | isFirstLaunch, isOnboardingComplete |
| **ValidationService** | 입력 검증 | validateBody, validateFood, validateSleep |
| **DateUtils** | 날짜 유틸 | isSameDay, getSleepDate, format |

---

## 병렬 작업 가능 그룹 (Claude Squad용)

### Phase 1 병렬 그룹

**그룹 A: 프로젝트 설정 & 기초 유틸** (Week 1)
- TASK-001, TASK-002, TASK-003, TASK-004, TASK-005, TASK-006

**그룹 B: UI 기본 + 온보딩** (Week 1-2, TASK-001 완료 후)
- TASK-010, TASK-020, TASK-092

**그룹 C: 핵심 서비스** (Week 2, TASK-002 완료 후)
- TASK-043, TASK-035, TASK-011

**그룹 D: 체성분 기능** (Week 2-3, TASK-043 완료 후)
- TASK-044, TASK-040, TASK-041, TASK-042

**그룹 E: 식단 기능** (Week 3-4, TASK-035 완료 후)
- TASK-050, TASK-051, TASK-052, TASK-052-B, TASK-052-C, TASK-053, TASK-054, TASK-055, TASK-056

**그룹 F: 운동 기능** (Week 3-4, TASK-035 완료 후)
- TASK-060, TASK-061, TASK-062, TASK-063

**그룹 G: 수면 기능** (Week 3-4, TASK-035 완료 후)
- TASK-075, TASK-076, TASK-077, TASK-078

**그룹 H: HealthKit** (Week 2-3, TASK-001 완료 후)
- TASK-070, TASK-071, TASK-072

**그룹 I: 대시보드** (Week 4, TASK-035 완료 후)
- TASK-030, TASK-031

**그룹 J: 설정** (Week 4, TASK-011 완료 후)
- TASK-080, TASK-081

**그룹 K: 테스트 & 출시** (Week 5)
- TASK-090, TASK-091, TASK-093

---

## 예상 일정

| Phase | 태스크 수 | 예상 시간 | 병렬 작업 시 |
|-------|----------|-----------|-------------|
| Phase 1 (MVP) | 43개 | ~118h | ~60h (5주) |
| Phase 2 (AI) | 7개 | ~26h | ~18h (1.5주) |
| Phase 3 (Social) | 5개 | ~30h | ~20h (2주) |
| **총계** | 55개 | ~174h | ~98h (~8.5주) |

### Phase 1 주차별 예상

| 주차 | 그룹 | 주요 산출물 |
|------|------|-------------|
| 1주 | A, B | 프로젝트 설정, 온보딩, 탭 구조 |
| 2주 | C, D, H | 핵심 서비스, 체성분 기능, HealthKit |
| 3주 | E, F, G | 식단, 운동, 수면 기능 |
| 4주 | I, J | 대시보드, 설정 |
| 5주 | K | 테스트, 앱스토어 제출 |

---

*문서 버전: 2.0*
*작성일: 2026-01-11*
*수정: 서비스 레이어 분리, 연쇄 업데이트 태스크 추가, 의존성 재정리, 예상 시간 조정*
