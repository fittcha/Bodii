# Bodii - ì—£ì§€ ì¼€ì´ìŠ¤ ì •ì˜ì„œ

## 1. ì˜¨ë³´ë”©

### 1.1 ì˜¨ë³´ë”© ì¤‘ê°„ ì¢…ë£Œ

| ì¼€ì´ìŠ¤ | ìƒí™© | ì²˜ë¦¬ ë°©ì•ˆ |
|--------|------|-----------|
| **ì•± ê°•ì œ ì¢…ë£Œ** | ì˜¨ë³´ë”© 3ë‹¨ê³„(ì²´ì„±ë¶„ ìž…ë ¥) ì¤‘ ì•± ì¢…ë£Œ | ë‹¤ìŒ ì‹¤í–‰ ì‹œ 3ë‹¨ê³„ë¶€í„° ìž¬ê°œ |
| **í™ˆ ë²„íŠ¼ ëˆ„ë¦„** | ì˜¨ë³´ë”© ì§„í–‰ ì¤‘ ë°±ê·¸ë¼ìš´ë“œ ì „í™˜ | í¬ê·¸ë¼ìš´ë“œ ë³µê·€ ì‹œ í˜„ìž¬ ë‹¨ê³„ ìœ ì§€ |
| **ì „í™” ìˆ˜ì‹ ** | ì˜¨ë³´ë”© ì¤‘ ì „í™” | í†µí™” ì¢…ë£Œ í›„ í˜„ìž¬ ë‹¨ê³„ ìœ ì§€ |

**êµ¬í˜„ ë°©ì•ˆ:**
```swift
// AppStateService
func saveOnboardingProgress(step: Int, data: OnboardingData?)
func getOnboardingProgress() -> (step: Int, data: OnboardingData?)
func clearOnboardingProgress()

// ì €ìž¥ ì‹œì : ê° ë‹¨ê³„ "ë‹¤ìŒ" ë²„íŠ¼ í´ë¦­ ì‹œ
// ë³µêµ¬ ì‹œì : ì•± ì‹¤í–‰ ì‹œ ì˜¨ë³´ë”© ë¯¸ì™„ë£Œ + ì§„í–‰ ë°ì´í„° ìžˆìœ¼ë©´ í•´ë‹¹ ë‹¨ê³„ë¡œ
```

### 1.2 ì˜¨ë³´ë”© ìŠ¤í‚µ

| ì¼€ì´ìŠ¤ | ìƒí™© | ì²˜ë¦¬ ë°©ì•ˆ |
|--------|------|-----------|
| **ìŠ¤í‚µ ë²„íŠ¼** | ì˜¨ë³´ë”© ìŠ¤í‚µ ì˜µì…˜ ì œê³µ ì—¬ë¶€ | âŒ ìŠ¤í‚µ ë¶ˆê°€ (í•„ìˆ˜ ì •ë³´ ìž…ë ¥) |
| **ë’¤ë¡œ ê°€ê¸°** | ì´ì „ ë‹¨ê³„ë¡œ ëŒì•„ê°€ê¸° | âœ… í—ˆìš©, ìž…ë ¥ê°’ ìœ ì§€ |

### 1.3 ì˜¨ë³´ë”© ìž…ë ¥ ê²€ì¦

| í•„ë“œ | ìœ íš¨ ë²”ìœ„ | ë²”ìœ„ ë²—ì–´ë‚  ì‹œ |
|------|----------|----------------|
| ì´ë¦„ | 1~20ìž | "ì´ë¦„ì„ ìž…ë ¥í•´ì£¼ì„¸ìš”" |
| ìƒë…„ì›”ì¼ | 1900~í˜„ìž¬ | "ì˜¬ë°”ë¥¸ ìƒë…„ì›”ì¼ì„ ì„ íƒí•´ì£¼ì„¸ìš”" |
| í‚¤ | 100~250cm | "í‚¤ëŠ” 100~250cm ì‚¬ì´ë¡œ ìž…ë ¥í•´ì£¼ì„¸ìš”" |
| ëª¸ë¬´ê²Œ | 20~300kg | "ëª¸ë¬´ê²ŒëŠ” 20~300kg ì‚¬ì´ë¡œ ìž…ë ¥í•´ì£¼ì„¸ìš”" |
| ì²´ì§€ë°©ë¥  | 1~60% | "ì²´ì§€ë°©ë¥ ì€ 1~60% ì‚¬ì´ë¡œ ìž…ë ¥í•´ì£¼ì„¸ìš”" |

---

## 2. ì²´ì„±ë¶„ ê´€ë¦¬

### 2.1 ì²´ì„±ë¶„ ìž…ë ¥

| ì¼€ì´ìŠ¤ | ìƒí™© | ì²˜ë¦¬ ë°©ì•ˆ |
|--------|------|-----------|
| **ê·¹ë‹¨ì  ì²´ì§€ë°©ë¥ ** | 3% ë¯¸ë§Œ ë˜ëŠ” 50% ì´ˆê³¼ | ê²½ê³  ë‹¤ì´ì–¼ë¡œê·¸: "ìž…ë ¥ê°’ì´ ì¼ë°˜ì ì¸ ë²”ìœ„ë¥¼ ë²—ì–´ë‚¬ìŠµë‹ˆë‹¤. ì €ìž¥í•˜ì‹œê² ìŠµë‹ˆê¹Œ?" |
| **ê¸‰ê²©í•œ ì²´ì¤‘ ë³€í™”** | ì „ë‚  ëŒ€ë¹„ Â±3kg ì´ìƒ | ê²½ê³  ë‹¤ì´ì–¼ë¡œê·¸: "ì²´ì¤‘ì´ í¬ê²Œ ë³€í–ˆìŠµë‹ˆë‹¤. ìž…ë ¥ê°’ì„ í™•ì¸í•´ì£¼ì„¸ìš”." |
| **ë™ì¼ ë‚ ì§œ ë³µìˆ˜ ìž…ë ¥** | ê°™ì€ ë‚  ì•„ì¹¨/ì €ë… 2íšŒ ì¸¡ì • | âœ… í—ˆìš©, ì‹œê°„ìˆœ ì •ë ¬, ê·¸ëž˜í”„ëŠ” ìµœì‹  1ê±´ë§Œ |
| **ë¯¸ëž˜ ë‚ ì§œ ìž…ë ¥** | ì¸¡ì •ì¼ì„ ë¯¸ëž˜ë¡œ ì„ íƒ | âŒ ë¶ˆê°€, DatePicker ìµœëŒ€ê°’ = í˜„ìž¬ |
| **ê³¼ê±° ë‚ ì§œ ìž…ë ¥** | 1ë…„ ì „ ê¸°ë¡ ì¶”ê°€ | âœ… í—ˆìš©, í•´ë‹¹ ë‚ ì§œë¡œ ì €ìž¥ |

### 2.2 ì²´ì„±ë¶„ ìˆ˜ì •/ì‚­ì œ

| ì¼€ì´ìŠ¤ | ìƒí™© | ì²˜ë¦¬ ë°©ì•ˆ |
|--------|------|-----------|
| **ìµœì‹  ê¸°ë¡ ì‚­ì œ** | ê°€ìž¥ ìµœê·¼ ì²´ì„±ë¶„ ì‚­ì œ | ì´ì „ ê¸°ë¡ìœ¼ë¡œ User.current* ìž¬ê³„ì‚° |
| **ìœ ì¼í•œ ê¸°ë¡ ì‚­ì œ** | ì²´ì„±ë¶„ ê¸°ë¡ì´ 1ê±´ë¿ì¼ ë•Œ ì‚­ì œ | ê²½ê³ : "ì²´ì„±ë¶„ ê¸°ë¡ì´ ì—†ìœ¼ë©´ TDEEë¥¼ ê³„ì‚°í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤" + User.current* = null |
| **ê³¼ê±° ê¸°ë¡ ìˆ˜ì •** | 1ì£¼ ì „ ì²´ì„±ë¶„ ìˆ˜ì • | âœ… í—ˆìš©, í•´ë‹¹ ê¸°ë¡ë§Œ ìˆ˜ì • (User.current*ëŠ” ìµœì‹  ê¸°ë¡ ê¸°ì¤€) |
| **DailyLog ì˜í–¥** | ì˜¤ëŠ˜ ì²´ì„±ë¶„ ì‚­ì œ | DailyLog.weight/bodyFatPct = nullë¡œ ë³€ê²½ |

### 2.3 ì²´ì§€ë°© ìžë™ ê³„ì‚°

| ì¼€ì´ìŠ¤ | ìƒí™© | ì²˜ë¦¬ ë°©ì•ˆ |
|--------|------|-----------|
| **ì²´ì§€ë°©ëŸ‰ë§Œ ìž…ë ¥** | 13.2kg ìž…ë ¥ | ì²´ì§€ë°©ë¥  = 13.2 / 72.5 Ã— 100 = 18.2% ìžë™ ê³„ì‚° |
| **ì²´ì§€ë°©ë¥ ë§Œ ìž…ë ¥** | 18.2% ìž…ë ¥ | ì²´ì§€ë°©ëŸ‰ = 72.5 Ã— 0.182 = 13.2kg ìžë™ ê³„ì‚° |
| **ë‘˜ ë‹¤ ìž…ë ¥** | ì²´ì§€ë°©ëŸ‰ê³¼ ì²´ì§€ë°©ë¥  ê°ê° ìž…ë ¥ | ë§ˆì§€ë§‰ ìž…ë ¥ê°’ ê¸°ì¤€ìœ¼ë¡œ ë‹¤ë¥¸ ê°’ ìž¬ê³„ì‚° |
| **ë¶ˆì¼ì¹˜ ìž…ë ¥** | ì²´ì§€ë°©ëŸ‰ 15kg, ì²´ì§€ë°©ë¥  18% | ë§ˆì§€ë§‰ ìž…ë ¥ í•„ë“œ ê¸°ì¤€ ìž¬ê³„ì‚° |

---

## 3. ì‹ë‹¨ ê´€ë¦¬

### 3.1 ìŒì‹ ê²€ìƒ‰

| ì¼€ì´ìŠ¤ | ìƒí™© | ì²˜ë¦¬ ë°©ì•ˆ |
|--------|------|-----------|
| **ê²€ìƒ‰ ê²°ê³¼ ì—†ìŒ** | "ì•„ì‚¬ì´ë³¼" ê²€ìƒ‰, ì‹ì•½ì²˜/USDA ëª¨ë‘ ì—†ìŒ | "ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤. ì§ì ‘ ìž…ë ¥í•´ì£¼ì„¸ìš”" + ì§ì ‘ ìž…ë ¥ ë²„íŠ¼ |
| **ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜** | API í˜¸ì¶œ ì‹¤íŒ¨ | "ë„¤íŠ¸ì›Œí¬ ì—°ê²°ì„ í™•ì¸í•´ì£¼ì„¸ìš”" + ìµœê·¼/ì‚¬ìš©ìž ìŒì‹ë§Œ í‘œì‹œ |
| **ë¶€ë¶„ ê²€ìƒ‰** | "ê¹€ì¹˜" ê²€ìƒ‰ | í¬í•¨ ê²€ìƒ‰ ("ê¹€ì¹˜ì°Œê°œ", "ê¹€ì¹˜ë³¶ìŒë°¥" ë“± ëª¨ë‘ í‘œì‹œ) |
| **ì´ˆì„± ê²€ìƒ‰** | "ã„±ã…Š" ê²€ìƒ‰ | ì´ˆì„± ë§¤ì¹­ ì§€ì› ì—¬ë¶€ â†’ MVPì—ì„œëŠ” ë¯¸ì§€ì›, Phase 2 ê³ ë ¤ |

### 3.2 ìŒì‹ ìž…ë ¥

| ì¼€ì´ìŠ¤ | ìƒí™© | ì²˜ë¦¬ ë°©ì•ˆ |
|--------|------|-----------|
| **ì„­ì·¨ëŸ‰ 0** | 0ì¸ë¶„ ë˜ëŠ” 0g ìž…ë ¥ | âŒ ë¶ˆê°€, "ìµœì†Œ 0.1 ì´ìƒ ìž…ë ¥í•´ì£¼ì„¸ìš”" |
| **ì„­ì·¨ëŸ‰ ê³¼ë‹¤** | 100ì¸ë¶„ ìž…ë ¥ | ê²½ê³ : "ì„­ì·¨ëŸ‰ì´ ë§¤ìš° ë§ŽìŠµë‹ˆë‹¤. í™•ì¸í•´ì£¼ì„¸ìš”" (ì €ìž¥ì€ í—ˆìš©) |
| **ì¹¼ë¡œë¦¬ 0** | ì§ì ‘ ìž…ë ¥ ì‹œ ì¹¼ë¡œë¦¬ 0 | ê²½ê³ : "ì¹¼ë¡œë¦¬ê°€ 0ìž…ë‹ˆë‹¤. í™•ì¸í•´ì£¼ì„¸ìš”" (ì €ìž¥ì€ í—ˆìš©) |
| **ì˜ì–‘ì •ë³´ ë¶ˆì™„ì „** | API ê²°ê³¼ì— ë‹¨ë°±ì§ˆë§Œ ì—†ìŒ | 0ìœ¼ë¡œ ì²˜ë¦¬, ì‚¬ìš©ìžì—ê²Œ ì•Œë¦¼ ì—†ìŒ |

### 3.3 ìžì • ì´í›„ ì‹ë‹¨

| ì¼€ì´ìŠ¤ | ìƒí™© | ì²˜ë¦¬ ë°©ì•ˆ |
|--------|------|-----------|
| **ìžì • ì´í›„ ê°„ì‹** | 01:30ì— ì•¼ì‹ ê¸°ë¡ | **í˜„ìž¬ ë‚ ì§œ**ë¡œ ê¸°ë¡ (01ì›” 11ì¼ 01:30 â†’ 01ì›” 11ì¼ ê°„ì‹) |
| **ë‚ ì§œ ìˆ˜ë™ ë³€ê²½** | 01:30ì— ì–´ì œ ì €ë…ìœ¼ë¡œ ê¸°ë¡ | âœ… í—ˆìš©, ì„ íƒí•œ ë‚ ì§œë¡œ ì €ìž¥ |

**ì •ì±… ê²°ì •:**
```
ì‹ë‹¨ ê¸°ë¡ ë‚ ì§œ ê¸°ì¤€: í˜„ìž¬ ì‹œìŠ¤í…œ ë‚ ì§œ (00:00 ~ 23:59)
ìˆ˜ë©´ ê¸°ë¡ ë‚ ì§œ ê¸°ì¤€: 02:00 ê¸°ì¤€ (02:00 ~ ë‹¤ìŒë‚  01:59)
```

### 3.4 ìŒì‹ ì‚­ì œ

| ì¼€ì´ìŠ¤ | ìƒí™© | ì²˜ë¦¬ ë°©ì•ˆ |
|--------|------|-----------|
| **ë‹¨ì¼ ìŒì‹ ì‚­ì œ** | ì ì‹¬ì—ì„œ ê¹€ì¹˜ì°Œê°œ ì‚­ì œ | DailyLog ê°ì†Œ ì—…ë°ì´íŠ¸ |
| **ë¼ë‹ˆ ì „ì²´ ì‚­ì œ** | ì ì‹¬ ì „ì²´ ì‚­ì œ | ê° ìŒì‹ ê°œë³„ ì‚­ì œì™€ ë™ì¼ ì²˜ë¦¬ |
| **ê³¼ê±° ìŒì‹ ì‚­ì œ** | 3ì¼ ì „ ì‹ë‹¨ ìˆ˜ì • | âœ… í—ˆìš©, í•´ë‹¹ ë‚ ì§œ DailyLog ì—…ë°ì´íŠ¸ |

---

## 4. ìš´ë™ ê´€ë¦¬

### 4.1 ìš´ë™ ìž…ë ¥

| ì¼€ì´ìŠ¤ | ìƒí™© | ì²˜ë¦¬ ë°©ì•ˆ |
|--------|------|-----------|
| **ìš´ë™ ì‹œê°„ 0ë¶„** | 0ë¶„ ìž…ë ¥ | âŒ ë¶ˆê°€, "ìµœì†Œ 1ë¶„ ì´ìƒ ìž…ë ¥í•´ì£¼ì„¸ìš”" |
| **ìš´ë™ ì‹œê°„ ê³¼ë‹¤** | 480ë¶„ (8ì‹œê°„) ìž…ë ¥ | ê²½ê³ : "ìš´ë™ ì‹œê°„ì´ ë§¤ìš° ê¹ë‹ˆë‹¤. í™•ì¸í•´ì£¼ì„¸ìš”" (ì €ìž¥ í—ˆìš©) |
| **ì²´ì¤‘ ì—†ìŒ** | User.currentWeight = null | MET ê³„ì‚° ë¶ˆê°€, "ì²´ì„±ë¶„ì„ ë¨¼ì € ìž…ë ¥í•´ì£¼ì„¸ìš”" ë©”ì‹œì§€ |
| **ë™ì¼ ìš´ë™ ì¤‘ë³µ** | ëŸ¬ë‹ 30ë¶„ 2íšŒ ìž…ë ¥ | âœ… í—ˆìš©, ê°ê° ë³„ë„ ê¸°ë¡ |

### 4.2 HealthKit ì—°ë™

| ì¼€ì´ìŠ¤ | ìƒí™© | ì²˜ë¦¬ ë°©ì•ˆ |
|--------|------|-----------|
| **ê¶Œí•œ ê±°ë¶€** | HealthKit ê¶Œí•œ ê±°ë¶€ë¨ | ì„¤ì • ì•±ìœ¼ë¡œ ìœ ë„: "ì„¤ì • > ê±´ê°• > Bodiiì—ì„œ ê¶Œí•œì„ í—ˆìš©í•´ì£¼ì„¸ìš”" |
| **ë¶€ë¶„ ê¶Œí•œ** | ìš´ë™ë§Œ í—ˆìš©, ê±¸ìŒìˆ˜ ê±°ë¶€ | í—ˆìš©ëœ ë°ì´í„°ë§Œ ë™ê¸°í™” |
| **ì¤‘ë³µ ìš´ë™** | HealthKit + ìˆ˜ë™ ìž…ë ¥ ë™ì¼ ìš´ë™ | healthKitIdë¡œ ì¤‘ë³µ ì²´í¬, ìžˆìœ¼ë©´ ìŠ¤í‚µ |
| **ê³¼ê±° ë°ì´í„°** | HealthKitì— 1ë…„ì¹˜ ë°ì´í„° | ìµœê·¼ 7ì¼ë§Œ ê°€ì ¸ì˜¤ê¸° (ì„¤ì •ì—ì„œ ë³€ê²½ ê°€ëŠ¥) |
| **HealthKit ë°ì´í„° ì‚­ì œ** | HealthKitì—ì„œ ìš´ë™ ì‚­ì œë¨ | Bodii ë°ì´í„°ëŠ” ìœ ì§€ (ë‹¨ë°©í–¥ ë™ê¸°í™”) |

---

## 5. ìˆ˜ë©´ ê´€ë¦¬

### 5.1 ìˆ˜ë©´ íŒì—…

| ì¼€ì´ìŠ¤ | ìƒí™© | ì²˜ë¦¬ ë°©ì•ˆ |
|--------|------|-----------|
| **ìƒˆë²½ 1ì‹œ ì‹¤í–‰** | 01:00ì— ì•± ì‹¤í–‰ | íŒì—… ì•ˆ ëœ¸ (02:00 ì´í›„ë¶€í„°) |
| **ìƒˆë²½ 3ì‹œ ì‹¤í–‰** | 03:00ì— ì•± ì‹¤í–‰ | íŒì—… ëœ¸ (01ì›” 10ì¼ ìˆ˜ë©´ ìž…ë ¥) |
| **ìŠ¤í‚µ 1íšŒ** | "ë‚˜ì¤‘ì—" í´ë¦­ | ë‹¤ìŒ ì‹¤í–‰ ì‹œ ë‹¤ì‹œ íŒì—… |
| **ìŠ¤í‚µ 3íšŒ** | 3ë²ˆ "ë‚˜ì¤‘ì—" í´ë¦­ | ë” ì´ìƒ íŒì—… ì•ˆ ëœ¸, ìˆ˜ë©´ íƒ­ ìœ ë„ ë°°ë„ˆ |
| **ì´ë¯¸ ìž…ë ¥ë¨** | ìˆ˜ë©´ íƒ­ì—ì„œ ë¯¸ë¦¬ ìž…ë ¥ | íŒì—… ì•ˆ ëœ¸ |
| **ë°¤ìƒ˜** | 0ì‹œê°„ 0ë¶„ ìž…ë ¥ | âœ… í—ˆìš©, ìƒíƒœ = Bad (ðŸ”´) |

### 5.2 ìˆ˜ë©´ ì‹œê°„ ê²½ê³„

| ì¼€ì´ìŠ¤ | ìƒí™© | ì²˜ë¦¬ ë°©ì•ˆ |
|--------|------|-----------|
| **02:00 ì •ê°** | 02:00:00ì— ì•± ì‹¤í–‰ | ìƒˆ í•˜ë£¨ ì‹œìž‘, ì–´ì œ ìˆ˜ë©´ íŒì—… |
| **01:59:59** | 01:59ì— ì•± ì‹¤í–‰ | ì•„ì§ ì „ë‚ , íŒì—… ì•ˆ ëœ¸ |
| **02:01** | 02:01ì— ì•± ì‹¤í–‰ | ìƒˆ í•˜ë£¨, ì–´ì œ ìˆ˜ë©´ íŒì—… |

**êµ¬í˜„ íŒ:**
```swift
func getSleepDate(for date: Date) -> Date {
    let calendar = Calendar.current
    let hour = calendar.component(.hour, from: date)
    
    if hour < 2 {
        // 00:00 ~ 01:59ëŠ” ì „ë‚ ë¡œ ì·¨ê¸‰
        return calendar.date(byAdding: .day, value: -1, to: date)!
    }
    return date
}
```

### 5.3 ìˆ˜ë©´ ìˆ˜ì •

| ì¼€ì´ìŠ¤ | ìƒí™© | ì²˜ë¦¬ ë°©ì•ˆ |
|--------|------|-----------|
| **ì˜¤ëŠ˜ ìˆ˜ë©´ ìˆ˜ì •** | ì˜¤ëŠ˜ ìž…ë ¥í•œ ìˆ˜ë©´ ìˆ˜ì • | âœ… í—ˆìš© |
| **ê³¼ê±° ìˆ˜ë©´ ìˆ˜ì •** | 1ì£¼ ì „ ìˆ˜ë©´ ìˆ˜ì • | âœ… í—ˆìš© (ì œí•œ ì—†ìŒ, MVP) |
| **ìˆ˜ë©´ ì‚­ì œ** | ìˆ˜ë©´ ê¸°ë¡ ì‚­ì œ | DailyLog.sleepDuration/Status = null |

---

## 6. DailyLog ê´€ë¦¬

### 6.1 DailyLog ìƒì„±

| ì¼€ì´ìŠ¤ | ìƒí™© | ì²˜ë¦¬ ë°©ì•ˆ |
|--------|------|-----------|
| **ì²« ê¸°ë¡** | ì˜¤ëŠ˜ ì²« ìŒì‹ ìž…ë ¥ | DailyLog ìƒì„± + User.current* ë³µì‚¬ |
| **User ë°ì´í„° ì—†ìŒ** | ì˜¨ë³´ë”© ë¯¸ì™„ë£Œ ìƒíƒœì—ì„œ ê¸°ë¡ ì‹œë„ | âŒ ë¶ˆê°€, ì˜¨ë³´ë”© ìœ ë„ |
| **ê³¼ê±° ë‚ ì§œ ì²« ê¸°ë¡** | 1ì£¼ ì „ì— ìŒì‹ ì¶”ê°€ | í•´ë‹¹ ë‚ ì§œ DailyLog ìƒì„± (í˜„ìž¬ User.current* ì‚¬ìš©) |

### 6.2 DailyLog ì •í•©ì„±

| ì¼€ì´ìŠ¤ | ìƒí™© | ì²˜ë¦¬ ë°©ì•ˆ |
|--------|------|-----------|
| **í•©ê³„ ë¶ˆì¼ì¹˜** | DailyLog.totalCaloriesIn â‰  FoodRecord í•©ê³„ | ì•± ì‹œìž‘ ì‹œ ê²€ì¦ + ìžë™ ìž¬ê³„ì‚° (ë°±ê·¸ë¼ìš´ë“œ) |
| **ìŒìˆ˜ ì¹¼ë¡œë¦¬** | ì‚­ì œ í›„ -50 kcal | 0ìœ¼ë¡œ ë³´ì • (ë²„ê·¸ ë°©ì§€) |
| **ë¹„ìœ¨ í•©ê³„ ë¶ˆì¼ì¹˜** | íƒ„+ë‹¨+ì§€ â‰  100% | ì†Œìˆ˜ì  ë°˜ì˜¬ë¦¼ìœ¼ë¡œ ë°œìƒ, í‘œì‹œë§Œ ì¡°ì • |

---

## 7. ëª©í‘œ ê´€ë¦¬ (Phase 2)

### 7.1 ëª©í‘œ ì„¤ì •

| ì¼€ì´ìŠ¤ | ìƒí™© | ì²˜ë¦¬ ë°©ì•ˆ |
|--------|------|-----------|
| **ëª©í‘œ ì—†ìŒ** | ëª©í‘œ ë¯¸ì„¤ì • ìƒíƒœ | ëª©í‘œ ê´€ë ¨ UI ìˆ¨ê¹€, ì„¤ì • ìœ ë„ |
| **ëª©í‘œ ë‹¬ì„±** | ëª©í‘œ ì²´ì¤‘ ë„ë‹¬ | ì¶•í•˜ ë©”ì‹œì§€ + "ìƒˆ ëª©í‘œ ì„¤ì •í•˜ì‹œê² ìŠµë‹ˆê¹Œ?" |
| **ëª©í‘œ ì´ˆê³¼** | ê°ëŸ‰ ëª©í‘œì¸ë° ì˜¤ížˆë ¤ ì¦ê°€ | ì˜ˆìƒ ê²½ë¡œ ê·¸ëž˜í”„ ìž¬ê³„ì‚°, ê²©ë ¤ ë©”ì‹œì§€ |
| **ë¶ˆê°€ëŠ¥í•œ ëª©í‘œ** | ì£¼ 2kg ê°ëŸ‰ ì„¤ì • | ê²½ê³ : "ê±´ê°•í•˜ì§€ ì•Šì€ ì†ë„ìž…ë‹ˆë‹¤. 0.5kg ì´í•˜ë¥¼ ê¶Œìž¥í•©ë‹ˆë‹¤" |

### 7.2 ë³µìˆ˜ ëª©í‘œ ì •í•©ì„±

| ì¼€ì´ìŠ¤ | ìƒí™© | ì²˜ë¦¬ ë°©ì•ˆ |
|--------|------|-----------|
| **ë¬¼ë¦¬ì  ë¶ˆê°€ëŠ¥** | 53kg, 18%, 45kg ê·¼ìœ¡ | âŒ ì €ìž¥ ë¶ˆê°€, "ì œì§€ë°©ëŸ‰(43.5kg)ë³´ë‹¤ ê·¼ìœ¡ëŸ‰ì´ ë§Žì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤" |
| **ëª¨ìˆœëœ ìœ í˜•** | ê°ëŸ‰ ì„ íƒ + ì²´ì¤‘ ì¦ê°€ ëª©í‘œ | âŒ ì €ìž¥ ë¶ˆê°€, "ê°ëŸ‰ ëª©í‘œì™€ ë§žì§€ ì•ŠìŠµë‹ˆë‹¤" |

---

## 8. ì‹œìŠ¤í…œ ë ˆë²¨

### 8.1 ì•± ìƒëª…ì£¼ê¸°

| ì¼€ì´ìŠ¤ | ìƒí™© | ì²˜ë¦¬ ë°©ì•ˆ |
|--------|------|-----------|
| **ë°±ê·¸ë¼ìš´ë“œ ì§„ìž…** | ìŒì‹ ìž…ë ¥ ì¤‘ ë°±ê·¸ë¼ìš´ë“œ | ìž…ë ¥ ì¤‘ì¸ ë°ì´í„° ìž„ì‹œ ì €ìž¥ |
| **ë©”ëª¨ë¦¬ ê²½ê³ ** | ì‹œìŠ¤í…œ ë©”ëª¨ë¦¬ ë¶€ì¡± | ìºì‹œ ì •ë¦¬, í•„ìˆ˜ ë°ì´í„°ë§Œ ìœ ì§€ |
| **ì•± ê°•ì œ ì¢…ë£Œ** | ì €ìž¥ ë²„íŠ¼ ëˆ„ë¥´ê¸° ì „ ì¢…ë£Œ | ë¯¸ì €ìž¥ ë°ì´í„° ì†ì‹¤ (ê²½ê³  ì—†ìŒ) |
| **ì•± ì—…ë°ì´íŠ¸** | ìƒˆ ë²„ì „ ì„¤ì¹˜ | Core Data ìžë™ ë§ˆì´ê·¸ë ˆì´ì…˜ |

### 8.2 ë‚ ì§œ ë³€ê²½

| ì¼€ì´ìŠ¤ | ìƒí™© | ì²˜ë¦¬ ë°©ì•ˆ |
|--------|------|-----------|
| **ìžì • ë„˜ê¹€** | 23:50ì— ì•± ì‚¬ìš© ì¤‘ â†’ 00:10 | í˜„ìž¬ í™”ë©´ ìœ ì§€, ìƒˆë¡œê³ ì¹¨ ì‹œ ìƒˆ ë‚ ì§œ |
| **ë‚ ì§œ ìˆ˜ë™ ë³€ê²½** | ì‹œìŠ¤í…œ ë‚ ì§œë¥¼ ê³¼ê±°ë¡œ ë³€ê²½ | Core Data ì €ìž¥ì€ ì •ìƒ, ì •ë ¬ë§Œ í˜¼ëž€ ê°€ëŠ¥ |
| **ì‹œê°„ëŒ€ ë³€ê²½** | í•´ì™¸ ì—¬í–‰ ì¤‘ ì‹œê°„ëŒ€ ë³€ê²½ | ë¡œì»¬ ì‹œê°„ ê¸°ì¤€ ì €ìž¥ (UTC ë³€í™˜ ì•ˆ í•¨) |

### 8.3 ì €ìž¥ ê³µê°„

| ì¼€ì´ìŠ¤ | ìƒí™© | ì²˜ë¦¬ ë°©ì•ˆ |
|--------|------|-----------|
| **ì €ìž¥ ê³µê°„ ë¶€ì¡±** | Core Data ì €ìž¥ ì‹¤íŒ¨ | ì—ëŸ¬ ë‹¤ì´ì–¼ë¡œê·¸: "ì €ìž¥ ê³µê°„ì´ ë¶€ì¡±í•©ë‹ˆë‹¤" |
| **ë°ì´í„° ì†ìƒ** | Core Data íŒŒì¼ ì†ìƒ | ì•± ìž¬ì„¤ì¹˜ ìœ ë„ (ë³µêµ¬ ë¶ˆê°€) |

---

## 9. ë°ì´í„° ë³´ì¡´ ë° ë³µêµ¬

### 9.1 ì•± ì‚­ì œ í›„ ìž¬ì„¤ì¹˜

| ì¼€ì´ìŠ¤ | ìƒí™© | ì²˜ë¦¬ ë°©ì•ˆ |
|--------|------|------------|
| **Phase 1 (ë¡œì»¬ë§Œ)** | ì•± ì‚­ì œ í›„ ìž¬ì„¤ì¹˜ | ëª¨ë“  ë°ì´í„° ì†ì‹¤, ì˜¨ë³´ë”©ë¶€í„° ë‹¤ì‹œ ì‹œìž‘ |
| **Phase 2 (iCloud)** | ì•± ì‚­ì œ í›„ ìž¬ì„¤ì¹˜ | iCloud ë™ê¸°í™” í™œì„±í™” ì‹œ ë°ì´í„° ë³µì› |

**ì•± ì‚­ì œ ì „ ê²½ê³  UX:**
```
ì•± ì‚­ì œ ì‹œë„ ì‹œ (iOS ì„¤ì • > ì•± > Bodii > ì•± ì‚­ì œ):
- iOS ì‹œìŠ¤í…œ ê²½ê³ : "ëª¨ë“  ë°ì´í„°ê°€ ì‚­ì œë©ë‹ˆë‹¤"
- Phase 1ì—ì„œëŠ” ë³µêµ¬ ë¶ˆê°€ëŠ¥
- Phase 2 iCloud í™œì„±í™” ì‹œ ë³µì› ê°€ëŠ¥

ì•± ë‚´ ë°ì´í„° ë°±ì—… ì•ˆë‚´ (ì„¤ì • í™”ë©´):
- "í˜„ìž¬ ë°ì´í„°ëŠ” ì´ ê¸°ê¸°ì—ë§Œ ì €ìž¥ë©ë‹ˆë‹¤"
- "ì•±ì„ ì‚­ì œí•˜ë©´ ëª¨ë“  ê¸°ë¡ì´ ì‚¬ë¼ì§‘ë‹ˆë‹¤"
- Phase 2: "iCloud ë™ê¸°í™”ë¥¼ í™œì„±í™”í•˜ë©´ ë°ì´í„°ë¥¼ ë³´í˜¸í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤"
```

### 9.2 ë‹¤ì¤‘ ê¸°ê¸° ë™ì‹œ ì‚¬ìš© (Phase 2 iCloud)

| ì¼€ì´ìŠ¤ | ìƒí™© | ì²˜ë¦¬ ë°©ì•ˆ |
|--------|------|------------|
| **ë™ì‹œ ìˆ˜ì •** | iPhoneê³¼ iPadì—ì„œ ê°™ì€ ë°ì´í„° ë™ì‹œ ìˆ˜ì • | **Last Write Wins** - ë§ˆì§€ë§‰ ì €ìž¥ëœ ê°’ì´ ìš°ì„  |
| **ì¶©ëŒ ê°ì§€** | CloudKit ì¶©ëŒ ë°œìƒ | ìžë™ í•´ê²° (timestamp ê¸°ì¤€) |
| **ì˜¤í”„ë¼ì¸ ìˆ˜ì •** | ì˜¤í”„ë¼ì¸ì—ì„œ ìˆ˜ì • í›„ ì˜¨ë¼ì¸ | ë¡œì»¬ ë³€ê²½ì‚¬í•­ iCloudë¡œ í‘¸ì‹œ |
| **ë™ê¸°í™” ì§€ì—°** | ë„¤íŠ¸ì›Œí¬ ë¶ˆì•ˆì • | ë¡œì»¬ ìš°ì„  ì €ìž¥, ë°±ê·¸ë¼ìš´ë“œ ë™ê¸°í™” |

**ì¶©ëŒ í•´ê²° ì •ì±…:**
```
iCloud ë™ê¸°í™” ì¶©ëŒ ì‹œ:
1. timestamp ë¹„êµ
2. ë” ìµœì‹  ë ˆì½”ë“œ ìš°ì„ 
3. ì¶©ëŒëœ ê¸°ì¡´ ë ˆì½”ë“œëŠ” ìžë™ íê¸° (ì‚¬ìš©ìž ì•Œë¦¼ ì—†ìŒ)
4. ë°ì´í„° ë¬´ê²°ì„± ìš°ì„  (ì‚¬ìš©ìž ê°œìž… ìµœì†Œí™”)

UX ì •ì±…:
- ì‚¬ìš©ìžì—ê²Œ ì¶©ëŒ ì•Œë¦¼ ì—†ìŒ (UX ë‹¨ìˆœí™”)
- ë™ê¸°í™” ìƒíƒœëŠ” ì„¤ì •ì—ì„œ í™•ì¸ ê°€ëŠ¥
```

### 9.3 User ë°ì´í„° ì—†ì´ DailyLog ìƒì„± ì‹œë„

| ì¼€ì´ìŠ¤ | ìƒí™© | ì²˜ë¦¬ ë°©ì•ˆ |
|--------|------|------------|
| **ì˜¨ë³´ë”© ë¯¸ì™„ë£Œ** | User ì—†ì´ ê¸°ë¡ ì‹œë„ | ì˜¨ë³´ë”© í™”ë©´ìœ¼ë¡œ ê°•ì œ ì´ë™ |
| **User ë°ì´í„° ì†ìƒ** | User Entity ì—†ìŒ | ì˜¨ë³´ë”© ìž¬ì‹¤í–‰ ìœ ë„ |
| **current* ê°’ ì—†ìŒ** | UserëŠ” ìžˆìœ¼ë‚˜ current* = null | ì²´ì„±ë¶„ ìž…ë ¥ ë¨¼ì € ìš”ì²­ |

**êµ¬í˜„ ë¡œì§:**
```swift
// DailyLogService
func getOrCreate(for date: Date) throws -> DailyLog {
    // 1. User ì¡´ìž¬ í™•ì¸
    guard let user = userService.getCurrentUser() else {
        throw BodiiError.userNotOnboarded
    }
    
    // 2. User.currentBMR/TDEE í™•ì¸
    guard user.currentBMR != nil, user.currentTDEE != nil else {
        throw BodiiError.insufficientData("ì²´ì„±ë¶„ì„ ë¨¼ì € ìž…ë ¥í•´ì£¼ì„¸ìš”")
    }
    
    // 3. ê¸°ì¡´ DailyLog í™•ì¸ ë˜ëŠ” ìƒì„±
    if let existing = fetchDailyLog(for: date) {
        return existing
    }
    
    return createDailyLog(for: date, user: user)
}

// ì•± ì‹œìž‘ ì‹œ User ê²€ì¦
func validateAppState() -> AppState {
    guard let user = userService.getCurrentUser() else {
        return .needsOnboarding
    }
    
    guard user.currentBMR != nil else {
        return .needsBodyRecord
    }
    
    return .ready
}
```

**UX íë¦„:**
```
ì•± ì‹œìž‘
    â†“
User ì¡´ìž¬ í™•ì¸
    â†“
â”œâ”€ User ì—†ìŒ â†’ ì˜¨ë³´ë”© í™”ë©´
â”‚
â”œâ”€ User ìžˆìŒ + current* ì—†ìŒ â†’ "ì²´ì„±ë¶„ì„ ìž…ë ¥í•´ì£¼ì„¸ìš”" íŒì—…
â”‚
â””â”€ User ìžˆìŒ + current* ìžˆìŒ â†’ ì •ìƒ ì§„ìž…
```

---

## 10. ê³¼ê±° ë‚ ì§œ DailyLog BMR/TDEE ì •ì±…

### 10.1 ê³¼ê±° ë‚ ì§œì— ê¸°ë¡ ì¶”ê°€ ì‹œ

| ì¼€ì´ìŠ¤ | ìƒí™© | ì²˜ë¦¬ ë°©ì•ˆ |
|--------|------|------------|
| **ê³¼ê±° DailyLog ìžˆìŒ** | 1ì£¼ ì „ ë‚ ì§œì— ìŒì‹ ì¶”ê°€ | ê¸°ì¡´ DailyLogì˜ bmr/tdee ìœ ì§€ |
| **ê³¼ê±° DailyLog ì—†ìŒ** | 1ì£¼ ì „ ë‚ ì§œì— ì²« ê¸°ë¡ | í•´ë‹¹ ë‚ ì§œì— ê°€ìž¥ ê°€ê¹Œìš´ MetabolismSnapshot ê°’ ì‚¬ìš© |

**BMR/TDEE ê²°ì • ë¡œì§:**
```swift
func getBMRForDate(_ date: Date, user: User) -> Decimal {
    // 1. í•´ë‹¹ ë‚ ì§œ ì´ì „ì˜ ê°€ìž¥ ê°€ê¹Œìš´ MetabolismSnapshot ì°¾ê¸°
    if let snapshot = findNearestSnapshot(before: date, userId: user.id) {
        return snapshot.bmr
    }
    
    // 2. ì—†ìœ¼ë©´ í˜„ìž¬ User.currentBMR ì‚¬ìš© (fallback)
    return user.currentBMR ?? 0
}

func findNearestSnapshot(before date: Date, userId: UUID) -> MetabolismSnapshot? {
    let request = MetabolismSnapshot.fetchRequest()
    request.predicate = NSPredicate(
        format: "userId == %@ AND date <= %@", 
        userId as CVarArg, 
        date as CVarArg
    )
    request.sortDescriptors = [NSSortDescriptor(key: "date", ascending: false)]
    request.fetchLimit = 1
    
    return try? context.fetch(request).first
}
```

**ì˜ˆì‹œ ì‹œë‚˜ë¦¬ì˜¤:**
```
íƒ€ìž„ë¼ì¸:
- 1/1: ì²´ì„±ë¶„ ìž…ë ¥ (70kg) â†’ BMR 1600, TDEE 2000
- 1/5: ì²´ì„±ë¶„ ìž…ë ¥ (72kg) â†’ BMR 1650, TDEE 2100
- 1/10: í˜„ìž¬

ê³¼ê±° ê¸°ë¡ ì¶”ê°€ ì‹œ:
- 1/3ì— ìŒì‹ ì¶”ê°€ â†’ 1/1 ìŠ¤ëƒ…ìƒ· ì‚¬ìš© (BMR 1600, TDEE 2000)
- 1/7ì— ìŒì‹ ì¶”ê°€ â†’ 1/5 ìŠ¤ëƒ…ìƒ· ì‚¬ìš© (BMR 1650, TDEE 2100)
- 12/25(ì²´ì„±ë¶„ ì „)ì— ì¶”ê°€ â†’ í˜„ìž¬ ê°’ ì‚¬ìš© (fallback)
```

---

## 11. ê²€ì¦ ì²´í¬ë¦¬ìŠ¤íŠ¸

### Phase 1 ì¶œì‹œ ì „ í•„ìˆ˜ í…ŒìŠ¤íŠ¸

- [ ] ì˜¨ë³´ë”© ì¤‘ê°„ ì¢…ë£Œ í›„ ìž¬ì‹¤í–‰
- [ ] ì²´ì„±ë¶„ ìœ ì¼í•œ ê¸°ë¡ ì‚­ì œ
- [ ] ë„¤íŠ¸ì›Œí¬ ì—†ì´ ìŒì‹ ê²€ìƒ‰
- [ ] 02:00 ê²½ê³„ ìˆ˜ë©´ íŒì—…
- [ ] ìžì • ë„˜ì–´ ì‹ë‹¨ ê¸°ë¡
- [ ] HealthKit ê¶Œí•œ ê±°ë¶€ í›„ ìž¬ìš”ì²­
- [ ] ì•± ë°±ê·¸ë¼ìš´ë“œ â†’ í¬ê·¸ë¼ìš´ë“œ ì „í™˜
- [ ] ì €ìž¥ ê³µê°„ ë¶€ì¡± ìƒí™© ì‹œë®¬ë ˆì´ì…˜

---

*ë¬¸ì„œ ë²„ì „: 1.0*
*ìž‘ì„±ì¼: 2026-01-11*
