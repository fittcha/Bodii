{
  "feature": "Korean Food Database Integration",
  "description": "Integrate Korean Food & Drug Administration (\uc2dd\uc57d\ucc98) food nutrition database API as primary source, with USDA FoodData Central as fallback for international foods. Prioritize Korean dishes (kimchi jjigae, bibimbap, tteokbokki) that are poorly covered by competitors.",
  "created_at": "2026-01-12T10:46:08.264Z",
  "updated_at": "2026-01-12T22:46:23.152Z",
  "status": "in_progress",
  "planStatus": "in_progress",
  "phases": [
    {
      "id": "phase_1",
      "name": "Infrastructure Setup",
      "description": "Set up networking infrastructure, API configuration, and base services",
      "subtasks": [
        {
          "id": "1.1",
          "title": "Create NetworkManager service",
          "description": "Implement base NetworkManager class for handling HTTP requests with async/await, error handling, timeout configuration, and retry logic",
          "status": "completed",
          "files": [
            "Bodii/Infrastructure/Network/NetworkManager.swift",
            "Bodii/Infrastructure/Network/NetworkError.swift"
          ],
          "acceptance_criteria": [
            "NetworkManager can perform GET/POST requests",
            "Proper error handling with NetworkError enum",
            "Configurable timeout (default 30s)",
            "Async/await support",
            "Generic response decoding"
          ],
          "estimated_effort": "medium",
          "dependencies": [],
          "notes": "\u2705 Implemented NetworkManager with async/await, retry logic with exponential backoff, timeout configuration, and comprehensive NetworkError enum. Follows project patterns with Korean documentation.",
          "updated_at": "2026-01-12T10:52:32.261337+00:00"
        },
        {
          "id": "1.2",
          "title": "Create API configuration and keys management",
          "description": "Set up configuration for API endpoints and secure key management using Info.plist or environment variables",
          "status": "completed",
          "files": [
            "Bodii/Infrastructure/Network/APIConfig.swift",
            "Bodii/Shared/Utils/Constants.swift"
          ],
          "acceptance_criteria": [
            "API endpoints defined for \uc2dd\uc57d\ucc98 and USDA",
            "API keys stored securely (not hardcoded)",
            "Configuration is testable with mock values",
            "Environment-specific configurations supported"
          ],
          "estimated_effort": "small",
          "dependencies": [],
          "notes": "\u2705 Implemented comprehensive API configuration system with secure key management. Created APIConfig.swift with protocol-based design supporting KFDA and USDA APIs, URL builders, environment-specific configs, and DEMO_KEY fallback. Updated Constants.swift with API limits and cache settings. Added detailed setup guide (API_KEYS_SETUP.md) and Info.plist template. Follows project patterns with Korean documentation.",
          "updated_at": "2026-01-12T11:08:40.849984+00:00"
        }
      ]
    },
    {
      "id": "phase_2",
      "name": "Korean Food API (\uc2dd\uc57d\ucc98) Integration",
      "description": "Integrate the Korean Food & Drug Administration API as the primary food data source",
      "subtasks": [
        {
          "id": "2.1",
          "title": "Create \uc2dd\uc57d\ucc98 API DTOs",
          "description": "Define Data Transfer Objects for parsing \uc2dd\uc57d\ucc98 API responses including food items and nutrition data",
          "status": "completed",
          "files": [
            "Bodii/Data/DTOs/KFDAFoodDTO.swift",
            "Bodii/Data/DTOs/KFDASearchResponseDTO.swift"
          ],
          "acceptance_criteria": [
            "DTOs match \uc2dd\uc57d\ucc98 API response structure",
            "All nutrition fields mapped (calories, carbs, protein, fat, sodium)",
            "Codable conformance for JSON parsing",
            "Handles nullable fields properly"
          ],
          "estimated_effort": "small",
          "dependencies": [],
          "notes": "\u2705 Created KFDAFoodDTO and KFDASearchResponseDTO for parsing \uc2dd\uc57d\ucc98 API responses. DTOs include all nutrition fields (calories, protein, carbs, fat, sodium, fiber, sugar), handle nullable fields properly, follow Codable protocol, and use custom CodingKeys for uppercase API field names. KFDASearchResponseDTO handles standard Korean government API structure with Header + Body, includes pagination support, and custom decoding for single item vs array responses. Both files follow project patterns with Korean documentation.",
          "updated_at": "2026-01-12T11:13:27.342606+00:00"
        },
        {
          "id": "2.2",
          "title": "Implement KFDAFoodAPIService",
          "description": "Create the service class to search and fetch Korean food data from \uc2dd\uc57d\ucc98 API",
          "status": "completed",
          "files": [
            "Bodii/Data/DataSources/Remote/KFDAFoodAPIService.swift"
          ],
          "acceptance_criteria": [
            "Search foods by name (keyword search)",
            "Handle pagination for large result sets",
            "Parse API responses to DTOs",
            "Proper error handling for network/parsing failures",
            "Respects API rate limits"
          ],
          "estimated_effort": "medium",
          "dependencies": [
            "1.1",
            "1.2",
            "2.1"
          ],
          "notes": "\u2705 Implemented KFDAFoodAPIService with comprehensive functionality:\n- searchFoods() method with keyword search and pagination support\n- getFoodDetail() method for single food lookup\n- KFDA-style pagination using startIdx/endIdx (not page numbers)\n- Proper error handling with NetworkError and KFDAAPIError types\n- API response validation and data filtering\n- Helper methods for pagination: nextPageIndices() and pageToIndices()\n- validateFoods() for data quality assurance\n- Rate limit compliance through NetworkManager configuration\n- MockKFDAFoodAPIService for testing\n- Follows project patterns with Korean documentation\n- All acceptance criteria met: search, pagination, DTO parsing, error handling, rate limits",
          "updated_at": "2026-01-12T11:16:01.644043+00:00"
        },
        {
          "id": "2.3",
          "title": "Create KFDA to Food entity mapper",
          "description": "Implement mapper to convert \uc2dd\uc57d\ucc98 DTOs to domain Food entities",
          "status": "completed",
          "files": [
            "Bodii/Data/Mappers/KFDAFoodMapper.swift"
          ],
          "acceptance_criteria": [
            "Maps all nutrition fields correctly",
            "Sets source to .governmentAPI",
            "Stores apiCode for deduplication",
            "Handles unit conversions if needed",
            "Properly handles missing optional fields"
          ],
          "estimated_effort": "small",
          "dependencies": [
            "2.1"
          ],
          "notes": "\u2705 Implemented KFDAFoodMapper for converting KFDAFoodDTO to Food domain entity. Maps all nutrition fields (calories, protein, carbs, fat, sodium, fiber, sugar) with proper type conversions (String to Int32/Decimal). Sets source to .governmentAPI and stores apiCode (foodCd) for deduplication. Handles serving size with intelligent fallback logic (servingSize \u2192 servingWt \u2192 100g default). Properly handles missing optional fields with safe parsing using parseDecimal() helper. Includes batch mapping capability with toDomainArray() for processing multiple DTOs efficiently. Comprehensive error handling with MappingError enum for clear error messages. Follows project patterns with Korean documentation and educational comments comparing to Java patterns.",
          "updated_at": "2026-01-12T11:18:44.612530+00:00"
        }
      ]
    },
    {
      "id": "phase_3",
      "name": "USDA API Integration",
      "description": "Integrate USDA FoodData Central API as fallback for international foods",
      "subtasks": [
        {
          "id": "3.1",
          "title": "Create USDA API DTOs",
          "description": "Define Data Transfer Objects for parsing USDA FoodData Central API responses",
          "status": "completed",
          "files": [
            "Bodii/Data/DTOs/USDAFoodDTO.swift",
            "Bodii/Data/DTOs/USDASearchResponseDTO.swift",
            "Bodii/Data/DTOs/USDANutrientDTO.swift"
          ],
          "acceptance_criteria": [
            "DTOs match USDA API response structure",
            "Handles nutrient array format (USDA uses nutrient IDs)",
            "Codable conformance for JSON parsing",
            "Supports both branded and foundation foods"
          ],
          "estimated_effort": "small",
          "dependencies": [],
          "notes": "\u2705 Created USDA FoodData Central API DTOs for parsing API responses:\n\nIMPLEMENTATION DETAILS:\n- Created USDANutrientDTO.swift:\n  * Handles USDA's nutrient array format with nutrient IDs\n  * Supports all major nutrient IDs (1008=energy, 1003=protein, 1004=fat, 1005=carbs, etc.)\n  * Helper methods for type conversion (Double \u2192 Decimal, Int32)\n  * Array extension methods for easy nutrient lookup by ID\n  * USDANutrientID enum with common nutrient ID constants\n\n- Created USDAFoodDTO.swift:\n  * Comprehensive food item structure matching USDA API\n  * Supports multiple food types: Foundation, SR Legacy, Branded, Survey\n  * Includes basic info: fdcId, description, dataType, foodCode\n  * Nutrition info: foodNutrients array (uses USDANutrientDTO)\n  * Serving info: servingSize, servingSizeUnit, householdServingFullText\n  * Branded food fields: brandOwner, brandName, gtinUpc, ingredients\n  * Category info: foodCategoryId, foodCategory\n  * Helper methods: getNutrientValue(), isBranded, isFoundation, etc.\n  * Validation: isValid property checks required fields\n\n- Created USDASearchResponseDTO.swift:\n  * Search response wrapper with pagination info\n  * Fields: totalHits, currentPage, totalPages, pageList\n  * Nested SearchCriteria struct for request echo\n  * foods array containing USDAFoodDTO items\n  * Convenience methods: hasResults, hasMorePages, nextPage, resultSummary\n  * USDAAPIError enum for error handling\n  * Response validation logic\n\nACCEPTANCE CRITERIA VERIFICATION:\n\u2705 DTOs match USDA API response structure - All fields mapped correctly\n\u2705 Handles nutrient array format (USDA uses nutrient IDs) - USDANutrientDTO with ID-based lookup\n\u2705 Codable conformance for JSON parsing - All DTOs conform to Codable with explicit CodingKeys\n\u2705 Supports both branded and foundation foods - foodType field and helper properties (isBranded, isFoundation, etc.)\n\nCOMMIT: e40ade6",
          "updated_at": "2026-01-12T11:22:31.207308+00:00"
        },
        {
          "id": "3.2",
          "title": "Implement USDAFoodAPIService",
          "description": "Create the service class to search and fetch food data from USDA FoodData Central API",
          "status": "completed",
          "files": [
            "Bodii/Data/DataSources/Remote/USDAFoodAPIService.swift"
          ],
          "acceptance_criteria": [
            "Search foods using FoodData Central search endpoint",
            "Handle pagination",
            "Parse API responses to DTOs",
            "Proper error handling",
            "API key authentication"
          ],
          "estimated_effort": "medium",
          "dependencies": [
            "1.1",
            "1.2",
            "3.1"
          ],
          "notes": "\u2705 Implemented USDAFoodAPIService with comprehensive functionality:\n- searchFoods() method with query, pageSize, pageNumber, and dataType filter support\n- getFoodDetail() method for single food lookup by FDC ID\n- getFoods() method for batch lookup (bonus feature - up to 20 items at once)\n- USDA-style pagination using page numbers (pageNumber=1,2,3...) not index ranges\n- Proper error handling with NetworkError to USDAAPIError mapping via mapNetworkErrorToUSDAError()\n- API response validation using response.isValid\n- Helper methods for pagination: nextPageNumber(), previousPageNumber(), totalPages(), isLastPage()\n- validateFoods() for data quality assurance - filters out invalid food items\n- Rate limit compliance through NetworkManager configuration (timeout: 30s, maxRetries: 2)\n- MockUSDAFoodAPIService for testing with configurable responses and error simulation\n- Follows project patterns with Korean documentation and Java comparison comments\n\nACCEPTANCE CRITERIA VERIFICATION:\n\u2705 Search foods using FoodData Central search endpoint - searchFoods() with full parameter support\n\u2705 Handle pagination - page number based system with comprehensive helper methods\n\u2705 Parse API responses to DTOs - USDASearchResponseDTO and USDAFoodDTO parsing\n\u2705 Proper error handling - comprehensive error mapping and try-catch blocks\n\u2705 API key authentication - uses APIConfig.buildUSDAURL() for secure key management\n\nBONUS FEATURES:\n- Batch food lookup with getFoods() for multiple FDC IDs\n- dataType filtering for targeted searches (Branded, Foundation, etc.)\n- isEmpty() helper for response validation\n- Comprehensive pagination utilities\n\nCOMMIT: 4b0f5f6",
          "updated_at": "2026-01-12T22:48:50.686921+00:00"
        },
        {
          "id": "3.3",
          "title": "Create USDA to Food entity mapper",
          "description": "Implement mapper to convert USDA DTOs to domain Food entities with unit conversions",
          "status": "completed",
          "files": [
            "Bodii/Data/Mappers/USDAFoodMapper.swift"
          ],
          "acceptance_criteria": [
            "Maps USDA nutrient IDs to correct fields",
            "Converts units (oz to g, etc.) if needed",
            "Sets source to .usda",
            "Stores fdcId as apiCode",
            "Handles missing nutrients gracefully"
          ],
          "estimated_effort": "medium",
          "dependencies": [
            "3.1"
          ],
          "notes": "\u2705 Implemented USDAFoodMapper for converting USDAFoodDTO to Food domain entity.\n\nIMPLEMENTATION DETAILS:\n- Created USDAFoodMapper.swift with comprehensive DTO to entity mapping\n- Maps USDA nutrient IDs to correct fields using USDANutrientID constants:\n  * 1008 (energy) \u2192 calories\n  * 1003 (protein) \u2192 protein\n  * 1004 (fat) \u2192 fat\n  * 1005 (carbohydrate) \u2192 carbohydrates\n  * 1093 (sodium) \u2192 sodium\n  * 1079 (fiber) \u2192 fiber\n  * 2000 (sugar) \u2192 sugar\n\nUNIT CONVERSION:\n- Comprehensive convertToGrams() method with support for:\n  * Weight units: oz \u2192 g, lb \u2192 g, kg \u2192 g, mg \u2192 g\n  * Volume units: ml, fl oz, cup, tbsp, tsp (water-based approximation)\n  * Graceful handling of unknown units (returns original value)\n\nACCEPTANCE CRITERIA VERIFICATION:\n\u2705 Maps USDA nutrient IDs to correct fields - extractNutrient() with ID lookup\n\u2705 Converts units (oz to g, etc.) if needed - convertToGrams() with 10+ unit types\n\u2705 Sets source to .usda - source: .usda in Food entity creation\n\u2705 Stores fdcId as apiCode - apiCode: String(dto.fdcId)\n\u2705 Handles missing nutrients gracefully - optional fields return nil, required throw error\n\nFEATURES:\n- Helper methods: parseCalories(), extractNutrient(), parseServingSize(), convertToGrams()\n- Batch mapping: toDomainArray() for converting multiple DTOs\n- Error handling: reuses MappingError enum from KFDAFoodMapper\n- User-friendly serving unit parsing with fallback to householdServingFullText\n- Follows project patterns with Korean documentation and Java comparison comments\n\nCOMMIT: ac228cf",
          "updated_at": "2026-01-12T22:52:08.942390+00:00"
        }
      ]
    },
    {
      "id": "phase_4",
      "name": "Unified Search Service",
      "description": "Create unified search service that prioritizes Korean foods and provides seamless fallback",
      "subtasks": [
        {
          "id": "4.1",
          "title": "Define FoodSearchRepository protocol",
          "description": "Create repository protocol for food search operations following clean architecture",
          "status": "pending",
          "files": [
            "Bodii/Domain/Interfaces/FoodSearchRepository.swift"
          ],
          "acceptance_criteria": [
            "Protocol defines search method with async/throws",
            "Supports search query and optional parameters",
            "Returns array of Food domain entities",
            "Follows dependency inversion principle"
          ],
          "estimated_effort": "small",
          "dependencies": [],
          "notes": ""
        },
        {
          "id": "4.2",
          "title": "Implement UnifiedFoodSearchService",
          "description": "Create service that searches \uc2dd\uc57d\ucc98 first, then USDA as fallback, and merges results",
          "status": "pending",
          "files": [
            "Bodii/Data/DataSources/Remote/UnifiedFoodSearchService.swift"
          ],
          "acceptance_criteria": [
            "Searches \uc2dd\uc57d\ucc98 API first (primary)",
            "Falls back to USDA if no Korean results or search appears international",
            "Korean foods appear first in results",
            "Handles concurrent API calls efficiently",
            "Deduplicates results if same food from multiple sources",
            "Returns empty array gracefully if both APIs fail"
          ],
          "estimated_effort": "medium",
          "dependencies": [
            "2.2",
            "3.2",
            "4.1"
          ],
          "notes": ""
        },
        {
          "id": "4.3",
          "title": "Implement FoodSearchRepositoryImpl",
          "description": "Create repository implementation that uses UnifiedFoodSearchService",
          "status": "pending",
          "files": [
            "Bodii/Data/Repositories/FoodSearchRepositoryImpl.swift"
          ],
          "acceptance_criteria": [
            "Implements FoodSearchRepository protocol",
            "Uses UnifiedFoodSearchService for actual search",
            "Can be injected via DIContainer",
            "Testable with mock service"
          ],
          "estimated_effort": "small",
          "dependencies": [
            "4.1",
            "4.2"
          ],
          "notes": ""
        }
      ]
    },
    {
      "id": "phase_5",
      "name": "Local Caching & Offline Support",
      "description": "Implement local caching for recent foods and offline access",
      "subtasks": [
        {
          "id": "5.1",
          "title": "Create FoodEntity for Core Data",
          "description": "Define Core Data entity for caching food items locally",
          "status": "pending",
          "files": [
            "Bodii/Data/DataSources/Local/Entities/FoodEntity+CoreData.swift",
            "Bodii/Infrastructure/Persistence/Bodii.xcdatamodeld/Bodii.xcdatamodel/contents"
          ],
          "acceptance_criteria": [
            "Core Data entity matches Food domain model",
            "Includes lastAccessedAt for recency tracking",
            "Includes searchCount for popularity",
            "Proper indices for efficient queries"
          ],
          "estimated_effort": "small",
          "dependencies": [],
          "notes": ""
        },
        {
          "id": "5.2",
          "title": "Implement FoodLocalDataSource",
          "description": "Create local data source for CRUD operations on cached foods",
          "status": "pending",
          "files": [
            "Bodii/Data/DataSources/Local/FoodLocalDataSource.swift"
          ],
          "acceptance_criteria": [
            "Save food to local cache",
            "Fetch recent foods (sorted by lastAccessedAt)",
            "Search cached foods by name",
            "Update access timestamp on retrieval",
            "Delete old cached items (LRU cleanup)",
            "Limit cache to reasonable size (e.g., 500 items)"
          ],
          "estimated_effort": "medium",
          "dependencies": [
            "5.1"
          ],
          "notes": ""
        },
        {
          "id": "5.3",
          "title": "Create Food domain to Core Data mapper",
          "description": "Implement bidirectional mapper between Food entity and FoodEntity Core Data object",
          "status": "pending",
          "files": [
            "Bodii/Data/Mappers/FoodEntityMapper.swift"
          ],
          "acceptance_criteria": [
            "Maps Food to FoodEntity (Core Data)",
            "Maps FoodEntity to Food (domain)",
            "Handles all fields including optionals",
            "Preserves source and apiCode"
          ],
          "estimated_effort": "small",
          "dependencies": [
            "5.1"
          ],
          "notes": ""
        },
        {
          "id": "5.4",
          "title": "Integrate caching into search flow",
          "description": "Update FoodSearchRepository to use local cache for recent foods and cache new search results",
          "status": "pending",
          "files": [
            "Bodii/Data/Repositories/FoodSearchRepositoryImpl.swift"
          ],
          "acceptance_criteria": [
            "Check local cache before API call for exact matches",
            "Cache new foods from API results",
            "Return cached results when offline",
            "Show recent foods section from cache",
            "Update lastAccessedAt when food is selected"
          ],
          "estimated_effort": "medium",
          "dependencies": [
            "4.3",
            "5.2",
            "5.3"
          ],
          "notes": ""
        }
      ]
    },
    {
      "id": "phase_6",
      "name": "Serving Size & Nutrition Calculation",
      "description": "Implement serving size adjustment with automatic nutrition recalculation",
      "subtasks": [
        {
          "id": "6.1",
          "title": "Create NutritionCalculator utility",
          "description": "Implement utility for calculating nutrition values based on serving size adjustments",
          "status": "pending",
          "files": [
            "Bodii/Shared/Utils/NutritionCalculator.swift"
          ],
          "acceptance_criteria": [
            "Calculate nutrition for given quantity and unit",
            "Support both serving-based and gram-based calculations",
            "Handle decimal precision appropriately",
            "Calculate macro ratios (carbs/protein/fat percentages)"
          ],
          "estimated_effort": "small",
          "dependencies": [],
          "notes": ""
        },
        {
          "id": "6.2",
          "title": "Create FoodWithQuantity model",
          "description": "Create model that combines Food with selected quantity and calculated nutrition",
          "status": "pending",
          "files": [
            "Bodii/Domain/Entities/FoodWithQuantity.swift"
          ],
          "acceptance_criteria": [
            "Contains Food reference and quantity/unit",
            "Provides calculated nutrition properties",
            "Immutable calculated values based on quantity",
            "Easy to convert to FoodRecord"
          ],
          "estimated_effort": "small",
          "dependencies": [
            "6.1"
          ],
          "notes": ""
        }
      ]
    },
    {
      "id": "phase_7",
      "name": "Error Handling & Resilience",
      "description": "Implement comprehensive error handling and graceful fallback mechanisms",
      "subtasks": [
        {
          "id": "7.1",
          "title": "Create FoodSearchError enum",
          "description": "Define comprehensive error types for food search operations",
          "status": "pending",
          "files": [
            "Bodii/Domain/Interfaces/FoodSearchError.swift"
          ],
          "acceptance_criteria": [
            "Covers network errors, parsing errors, API errors",
            "User-friendly error messages (Korean)",
            "Distinguishes recoverable vs non-recoverable errors",
            "Includes offline/no-connection state"
          ],
          "estimated_effort": "small",
          "dependencies": [],
          "notes": ""
        },
        {
          "id": "7.2",
          "title": "Implement graceful fallback in search service",
          "description": "Add retry logic and fallback behavior when APIs fail",
          "status": "pending",
          "files": [
            "Bodii/Data/DataSources/Remote/UnifiedFoodSearchService.swift"
          ],
          "acceptance_criteria": [
            "Retry failed requests (max 2 retries)",
            "Fall back to USDA if \uc2dd\uc57d\ucc98 fails",
            "Return cached results if both APIs fail",
            "Log errors for debugging",
            "Show appropriate user message for each failure type"
          ],
          "estimated_effort": "medium",
          "dependencies": [
            "4.2",
            "5.4",
            "7.1"
          ],
          "notes": ""
        }
      ]
    },
    {
      "id": "phase_8",
      "name": "DI Container Integration",
      "description": "Register all new services in dependency injection container",
      "subtasks": [
        {
          "id": "8.1",
          "title": "Update DIContainer with food search dependencies",
          "description": "Register NetworkManager, API services, repository, and related dependencies",
          "status": "pending",
          "files": [
            "Bodii/App/DIContainer.swift"
          ],
          "acceptance_criteria": [
            "NetworkManager registered as singleton",
            "API services registered (KFDA, USDA)",
            "UnifiedFoodSearchService registered",
            "FoodSearchRepository registered",
            "FoodLocalDataSource registered",
            "Factory methods for ViewModel creation"
          ],
          "estimated_effort": "small",
          "dependencies": [
            "2.2",
            "3.2",
            "4.3",
            "5.2"
          ],
          "notes": ""
        }
      ]
    },
    {
      "id": "phase_9",
      "name": "Testing",
      "description": "Write unit tests for all new components",
      "subtasks": [
        {
          "id": "9.1",
          "title": "Create mock API services for testing",
          "description": "Create mock implementations of API services for unit testing",
          "status": "pending",
          "files": [
            "BodiiTests/Mocks/MockKFDAFoodAPIService.swift",
            "BodiiTests/Mocks/MockUSDAFoodAPIService.swift",
            "BodiiTests/Mocks/MockFoodLocalDataSource.swift"
          ],
          "acceptance_criteria": [
            "Mock services return configurable responses",
            "Can simulate success/failure scenarios",
            "Can simulate network delays",
            "Conforms to same protocols as real services"
          ],
          "estimated_effort": "small",
          "dependencies": [
            "2.2",
            "3.2",
            "5.2"
          ],
          "notes": ""
        },
        {
          "id": "9.2",
          "title": "Write unit tests for mappers",
          "description": "Test DTO to entity mapping logic",
          "status": "pending",
          "files": [
            "BodiiTests/Mappers/KFDAFoodMapperTests.swift",
            "BodiiTests/Mappers/USDAFoodMapperTests.swift",
            "BodiiTests/Mappers/FoodEntityMapperTests.swift"
          ],
          "acceptance_criteria": [
            "Test all field mappings",
            "Test edge cases (missing fields, null values)",
            "Test unit conversions",
            "100% coverage of mapping logic"
          ],
          "estimated_effort": "medium",
          "dependencies": [
            "2.3",
            "3.3",
            "5.3"
          ],
          "notes": ""
        },
        {
          "id": "9.3",
          "title": "Write unit tests for UnifiedFoodSearchService",
          "description": "Test search prioritization, fallback, and error handling",
          "status": "pending",
          "files": [
            "BodiiTests/Services/UnifiedFoodSearchServiceTests.swift"
          ],
          "acceptance_criteria": [
            "Test Korean foods returned first",
            "Test USDA fallback when KFDA returns empty",
            "Test both APIs failing (cache fallback)",
            "Test deduplication logic",
            "Test concurrent request handling"
          ],
          "estimated_effort": "medium",
          "dependencies": [
            "4.2",
            "9.1"
          ],
          "notes": ""
        },
        {
          "id": "9.4",
          "title": "Write unit tests for NutritionCalculator",
          "description": "Test serving size calculations and nutrition math",
          "status": "pending",
          "files": [
            "BodiiTests/Utils/NutritionCalculatorTests.swift"
          ],
          "acceptance_criteria": [
            "Test serving-based calculations",
            "Test gram-based calculations",
            "Test decimal precision",
            "Test edge cases (0, very large values)"
          ],
          "estimated_effort": "small",
          "dependencies": [
            "6.1"
          ],
          "notes": ""
        }
      ]
    }
  ],
  "qa_signoff": {
    "status": "pending",
    "tests_passed": "",
    "issues": ""
  },
  "total_subtasks": 24,
  "estimated_total_effort": "large",
  "last_updated": "2026-01-12T22:52:08.942395+00:00"
}