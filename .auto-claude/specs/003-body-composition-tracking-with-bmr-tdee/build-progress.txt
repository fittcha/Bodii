# Body Composition Tracking with BMR/TDEE - Build Progress

## Overview
Feature: Complete body composition logging system with automatic BMR/TDEE calculations
Total Subtasks: 31
Estimated Effort: 3-4 days

## Current Status: Planning Complete

---

## Phase Summary

### Phase 1: Domain Layer - Entities & Business Logic (8 subtasks)
- [x] 1.1 - Create ActivityLevel enum with TDEE multipliers ✅
- [ ] 1.2 - Create Gender enum for BMR calculations
- [ ] 1.3 - Create BodyCompositionEntry domain entity
- [ ] 1.4 - Create MetabolismData domain entity
- [ ] 1.5 - Create UserProfile domain entity
- [ ] 1.6 - Implement CalculateBMRUseCase (Mifflin-St Jeor)
- [ ] 1.7 - Implement CalculateTDEEUseCase
- [ ] 1.8 - Create BodyRepository protocol

### Phase 2: Data Layer - Repository & Data Sources (6 subtasks)
- [ ] 2.1 - Create BodyRecordMapper
- [ ] 2.2 - Create MetabolismSnapshotMapper
- [ ] 2.3 - Implement BodyLocalDataSource
- [ ] 2.4 - Implement BodyRepository
- [ ] 2.5 - Create RecordBodyCompositionUseCase
- [ ] 2.6 - Create FetchBodyTrendsUseCase

### Phase 3: Presentation Layer - ViewModels (3 subtasks)
- [ ] 3.1 - Create BodyCompositionViewModel
- [ ] 3.2 - Create BodyTrendsViewModel
- [ ] 3.3 - Create MetabolismViewModel

### Phase 4: Presentation Layer - UI Components (5 subtasks)
- [ ] 4.1 - Create BodyCompositionInputCard
- [ ] 4.2 - Create MetabolismDisplayCard
- [ ] 4.3 - Create WeightTrendChart (Swift Charts)
- [ ] 4.4 - Create BodyFatTrendChart (Swift Charts)
- [ ] 4.5 - Create TrendPeriodPicker

### Phase 5: Presentation Layer - Feature Views (4 subtasks)
- [ ] 5.1 - Create BodyCompositionView main screen
- [ ] 5.2 - Create BodyTrendsView
- [ ] 5.3 - Create BodyRecordDetailView
- [ ] 5.4 - Update DashboardView with metabolism display

### Phase 6: Integration & Wiring (3 subtasks)
- [ ] 6.1 - Update DIContainer with dependencies
- [ ] 6.2 - Update ContentView navigation
- [ ] 6.3 - Add preview sample data

### Phase 7: Validation & Input Handling (2 subtasks)
- [ ] 7.1 - Create BodyMeasurementValidator
- [ ] 7.2 - Create Decimal+Extensions

### Phase 8: Testing & Performance (3 subtasks)
- [ ] 8.1 - Create BMR/TDEE calculation tests
- [ ] 8.2 - Create repository tests
- [ ] 8.3 - Create performance tests

---

## Progress Log

### 2026-01-12
- Created implementation plan with 8 phases and 31 subtasks
- Plan covers all acceptance criteria from spec
- Dependencies mapped between phases
- Ready to begin Phase 1 implementation
- ✅ **Completed 1.1**: Created ActivityLevel enum with TDEE multipliers
  - Defined 5 activity levels: sedentary, lightlyActive, moderatelyActive, veryActive, extraActive
  - Implemented TDEE multipliers: 1.2, 1.375, 1.55, 1.725, 1.9
  - Added Int16 raw values for Core Data storage compatibility
  - Includes displayName and description properties for UI
  - Conforms to CaseIterable, Codable, and Identifiable protocols

---

## Acceptance Criteria Tracking

| Criteria | Subtasks | Status |
|----------|----------|--------|
| Input height, weight, body fat %, muscle mass with validation | 1.3, 4.1, 5.1, 7.1 | Pending |
| BMR calculated using Mifflin-St Jeor formula | 1.6, 2.5, 8.1 | Pending |
| TDEE calculated based on activity level | 1.1, 1.7, 2.5 | Pending |
| MetabolismSnapshot saved with each body record | 2.3, 2.5 | Pending |
| Swift Charts weight/body fat trends 7/30/90 days | 4.3, 4.4, 5.2 | Pending |
| Dashboard shows BMR/TDEE with intake/expenditure | 3.3, 4.2, 5.4 | Pending |
| Query performance under 0.5 seconds | 2.3, 8.3 | Pending |
