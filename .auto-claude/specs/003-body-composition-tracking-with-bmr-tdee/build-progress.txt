# Build Progress: Body Composition Tracking with BMR/TDEE

## Status: Planning Complete
**Last Updated:** 2026-01-12

---

## Implementation Plan Summary

### 8 Phases with 37 Subtasks

| # | Name | Subtasks | Status |
|---|------|----------|--------|
| 1 | Domain Layer - Models and Business Logic | 7 | Pending |
| 2 | Data Layer - Repository and Core Data Integration | 5 | Pending |
| 3 | Use Cases Layer | 4 | Pending |
| 4 | UI Layer - Body Composition Views | 5 | Pending |
| 5 | UI Layer - Swift Charts Integration | 6 | Pending |
| 6 | Dashboard Integration | 4 | Pending |
| 7 | DI Container and Integration | 4 | Pending |
| 8 | Testing and Performance | 5 | Pending |

---

## Key Technical Decisions

### BMR Formula: Mifflin-St Jeor
- Men: (10 x weight_kg) + (6.25 x height_cm) - (5 x age) + 5
- Women: (10 x weight_kg) + (6.25 x height_cm) - (5 x age) - 161

### TDEE Activity Multipliers
- Sedentary (little/no exercise): 1.2
- Lightly Active (1-3 days/week): 1.375
- Moderately Active (3-5 days/week): 1.55
- Very Active (6-7 days/week): 1.725
- Extra Active (physical job + exercise): 1.9

### Architecture
- Clean Architecture with Domain/Data/Presentation layers
- Repository pattern for data access
- Use Cases for business logic orchestration
- @Observable ViewModels for UI state management

### Core Data Entities (Already Defined)
- User: Profile with height, birthDate, gender, activityLevel
- BodyRecord: weight, bodyFatPercent, bodyFatMass, muscleMass
- MetabolismSnapshot: bmr, tdee, activityLevel (linked to BodyRecord)

---

## Next Steps

1. Start with Domain Layer (subtasks 1.1 - 1.7)
   - Create ActivityLevel enum (1.1)
   - Create Gender enum (1.2)
   - Build BMRCalculator service (1.5)
   - Build TDEECalculator service (1.6)

---

## Session Log

### 2026-01-12
- Created detailed implementation plan with 8 phases and 37 subtasks
- Mapped acceptance criteria to specific subtasks
- Analyzed existing Core Data schema for entity reuse
