{
  "file_path": "Bodii/Presentation/Components/Charts/BodyFatTrendChart.swift",
  "main_branch_history": [],
  "task_views": {
    "003-body-composition-tracking-with-bmr-tdee": {
      "task_id": "003-body-composition-tracking-with-bmr-tdee",
      "branch_point": {
        "commit_hash": "2abdae73fb6199bcbf4f21f6deeb7952225f81e6",
        "content": "",
        "timestamp": "2026-01-13T07:46:22.394743"
      },
      "worktree_state": {
        "content": "//\n//  BodyFatTrendChart.swift\n//  Bodii\n//\n//  Created by Auto-Claude on 2026-01-12.\n//\n\n// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Swift Charts with Color-Coded Zones\n// Swift Charts \ud504\ub808\uc784\uc6cc\ud06c\ub97c \uc0ac\uc6a9\ud55c \uccb4\uc9c0\ubc29\ub960 \ud2b8\ub80c\ub4dc \ub77c\uc778 \ucc28\ud2b8 + \uac74\uac15 \uad6c\uac04 \ud45c\uc2dc\n// \ud83d\udca1 Java \ube44\uad50: Android\uc758 MPAndroidChart, iOS Charts\uc640 \uc720\uc0ac\ud558\uc9c0\ub9cc \uad6c\uac04\ubcc4 \uc0c9\uc0c1 \uad6c\ubd84 \uae30\ub2a5 \ud3ec\ud568\n\nimport SwiftUI\nimport Charts\n\n// MARK: - BodyFatTrendChart\n\n/// \uccb4\uc9c0\ubc29\ub960 \ud2b8\ub80c\ub4dc\ub97c \ud45c\uc2dc\ud558\ub294 \ub77c\uc778 \ucc28\ud2b8 \ucef4\ud3ec\ub10c\ud2b8\n/// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Swift Charts Integration with Health Zones\n/// - Swift Charts\ub97c \uc0ac\uc6a9\ud55c \ub77c\uc778 \uadf8\ub798\ud504\n/// - \uac74\uac15 \uad6c\uac04\ubcc4 \uc0c9\uc0c1 \ud45c\uc2dc (Essential Fat, Athletes, Fitness, Average, Obese)\n/// - \ubaa9\ud45c\uc120 \ud45c\uc2dc \uc9c0\uc6d0\n/// - \uc778\ud130\ub799\ud2f0\ube0c \uc120\ud0dd \uae30\ub2a5\n/// - \ube48 \uc0c1\ud0dc \ucc98\ub9ac\n/// \ud83d\udca1 Java \ube44\uad50: MPAndroidChart LineChart + LimitLines\uc640 \uc720\uc0ac\ud558\uc9c0\ub9cc \ub354 \uc120\uc5b8\uc801\nstruct BodyFatTrendChart: View {\n\n    // MARK: - Types\n\n    /// \uccb4\uc9c0\ubc29\ub960 \uac74\uac15 \uad6c\uac04\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Health Zone Classification\n    /// - \uc131\ubcc4\uc5d0 \ub530\ub77c \uac74\uac15\ud55c \uccb4\uc9c0\ubc29\ub960 \ubc94\uc704\uac00 \ub2e4\ub984\n    /// - \uac01 \uad6c\uac04\ub9c8\ub2e4 \uc0c9\uc0c1 \uc9c0\uc815\uc73c\ub85c \uc2dc\uac01\uc801 \ud53c\ub4dc\ubc31 \uc81c\uacf5\n    /// \ud83d\udca1 \ucc38\uace0: American Council on Exercise (ACE) \uae30\uc900\n    enum BodyFatZone {\n        case essentialFat    // \ud544\uc218 \uc9c0\ubc29 (\ub0a8\uc131: 2-5%, \uc5ec\uc131: 10-13%)\n        case athletes        // \uc6b4\ub3d9\uc120\uc218 (\ub0a8\uc131: 6-13%, \uc5ec\uc131: 14-20%)\n        case fitness         // \ud53c\ud2b8\ub2c8\uc2a4 (\ub0a8\uc131: 14-17%, \uc5ec\uc131: 21-24%)\n        case average         // \ud3c9\uade0 (\ub0a8\uc131: 18-24%, \uc5ec\uc131: 25-31%)\n        case obese          // \ube44\ub9cc (\ub0a8\uc131: 25%+, \uc5ec\uc131: 32%+)\n\n        /// \uad6c\uac04 \uc0c9\uc0c1\n        /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Color Coding for Health Indicators\n        var color: Color {\n            switch self {\n            case .essentialFat:\n                return .blue\n            case .athletes:\n                return .green\n            case .fitness:\n                return .mint\n            case .average:\n                return .yellow\n            case .obese:\n                return .orange\n            }\n        }\n\n        /// \uad6c\uac04 \uc774\ub984\n        var displayName: String {\n            switch self {\n            case .essentialFat:\n                return \"\ud544\uc218 \uc9c0\ubc29\"\n            case .athletes:\n                return \"\uc6b4\ub3d9\uc120\uc218\"\n            case .fitness:\n                return \"\ud53c\ud2b8\ub2c8\uc2a4\"\n            case .average:\n                return \"\ud3c9\uade0\"\n            case .obese:\n                return \"\ube44\ub9cc\"\n            }\n        }\n\n        /// \ub0a8\uc131 \uae30\uc900 \uad6c\uac04 \ud310\ubcc4\n        /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Classification Logic\n        /// - \uccb4\uc9c0\ubc29\ub960\uc5d0 \ub530\ub77c \ud574\ub2f9\ud558\ub294 \uac74\uac15 \uad6c\uac04 \ubc18\ud658\n        ///\n        /// - Parameter bodyFatPercent: \uccb4\uc9c0\ubc29\ub960 (%)\n        /// - Returns: \uac74\uac15 \uad6c\uac04\n        static func forMale(_ bodyFatPercent: Decimal) -> BodyFatZone {\n            let value = NSDecimalNumber(decimal: bodyFatPercent).doubleValue\n            if value < 6 { return .essentialFat }\n            if value < 14 { return .athletes }\n            if value < 18 { return .fitness }\n            if value < 25 { return .average }\n            return .obese\n        }\n\n        /// \uc5ec\uc131 \uae30\uc900 \uad6c\uac04 \ud310\ubcc4\n        static func forFemale(_ bodyFatPercent: Decimal) -> BodyFatZone {\n            let value = NSDecimalNumber(decimal: bodyFatPercent).doubleValue\n            if value < 14 { return .essentialFat }\n            if value < 21 { return .athletes }\n            if value < 25 { return .fitness }\n            if value < 32 { return .average }\n            return .obese\n        }\n    }\n\n    // MARK: - Properties\n\n    /// \ucc28\ud2b8 \ub370\uc774\ud130 \ud3ec\uc778\ud2b8\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Data Input\n    /// - FetchBodyTrendsUseCase.TrendDataPoint \ubc30\uc5f4\n    /// - \ub0a0\uc9dc \uc624\ub984\ucc28\uc21c \uc815\ub82c\ub418\uc5b4 \uc788\uc74c\n    let dataPoints: [FetchBodyTrendsUseCase.TrendDataPoint]\n\n    /// \ubaa9\ud45c \uccb4\uc9c0\ubc29\ub960 (%)\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Optional Goal Line\n    /// - nil\uc774\uba74 \ubaa9\ud45c\uc120 \ud45c\uc2dc \uc548 \ud568\n    /// - \uac12\uc774 \uc788\uc73c\uba74 \uc810\uc120\uc73c\ub85c \ud45c\uc2dc\n    let goalBodyFat: Decimal?\n\n    /// \uc120\ud0dd\ub41c \ud2b8\ub80c\ub4dc \uae30\uac04\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Period Context\n    /// - \ucc28\ud2b8 \uc81c\ubaa9 \ubc0f X\ucd95 \ub808\uc774\ube14 \uacb0\uc815\n    let period: FetchBodyTrendsUseCase.TrendPeriod\n\n    /// \uc778\ud130\ub799\uc158 \ud65c\uc131\ud654 \uc5ec\ubd80\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Interactive Feature Toggle\n    /// - true: \ud0ed\ud558\uc5ec \uc0c1\uc138 \uc815\ubcf4 \ud45c\uc2dc\n    /// - false: \uc815\uc801 \ucc28\ud2b8\n    let isInteractive: Bool\n\n    /// \ucc28\ud2b8 \ub192\uc774\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Customizable Height\n    /// - \ub300\uc2dc\ubcf4\ub4dc\uc5d0\uc11c\ub294 \uc791\uac8c, \uc0c1\uc138 \ud654\uba74\uc5d0\uc11c\ub294 \ud06c\uac8c\n    let height: CGFloat\n\n    /// \uc0ac\uc6a9\uc790 \uc131\ubcc4 (\uac74\uac15 \uad6c\uac04 \ud310\ubcc4\uc6a9)\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Gender-Based Classification\n    /// - \ub0a8\uc131\uacfc \uc5ec\uc131\uc758 \uac74\uac15 \uccb4\uc9c0\ubc29\ub960 \ubc94\uc704\uac00 \ub2e4\ub984\n    /// - nil\uc774\uba74 \uc131\ubcc4 \uad6c\ubd84 \uc5c6\uc774 \uc77c\ubc18\uc801\uc778 \uc0c9\uc0c1 \uc0ac\uc6a9\n    let gender: Gender?\n\n    /// \uac74\uac15 \uad6c\uac04 \ubc30\uacbd \ud45c\uc2dc \uc5ec\ubd80\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Optional Zone Background\n    /// - true: \ucc28\ud2b8 \ubc30\uacbd\uc5d0 \uac74\uac15 \uad6c\uac04\ubcc4 \uc0c9\uc0c1 \ud45c\uc2dc\n    /// - false: \uad6c\uac04 \ud45c\uc2dc \uc5c6\uc774 \ub2e8\uc21c \ub77c\uc778 \ucc28\ud2b8\n    let showHealthZones: Bool\n\n    // MARK: - State\n\n    /// \uc120\ud0dd\ub41c \ub0a0\uc9dc\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Chart Selection State\n    /// - \uc0ac\uc6a9\uc790\uac00 \ud0ed\ud55c \ub370\uc774\ud130 \ud3ec\uc778\ud2b8\uc758 \ub0a0\uc9dc\n    /// - nil\uc774\uba74 \uc120\ud0dd \uc5c6\uc74c\n    /// \ud83d\udca1 Java \ube44\uad50: selectedEntry in MPAndroidChart\n    @State private var selectedDate: Date?\n\n    /// \uc120\ud0dd\ub41c \ub370\uc774\ud130 \ud3ec\uc778\ud2b8\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Computed Property for Selection\n    /// - selectedDate\ub97c \uae30\ubc18\uc73c\ub85c \uc2e4\uc81c \ub370\uc774\ud130 \ud3ec\uc778\ud2b8 \uc870\ud68c\n    private var selectedDataPoint: FetchBodyTrendsUseCase.TrendDataPoint? {\n        guard let date = selectedDate else { return nil }\n        // \ub0a0\uc9dc\uac00 \uac00\uc7a5 \uac00\uae4c\uc6b4 \ub370\uc774\ud130 \ud3ec\uc778\ud2b8 \ucc3e\uae30\n        return dataPoints.min(by: { abs($0.date.timeIntervalSince(date)) < abs($1.date.timeIntervalSince(date)) })\n    }\n\n    // MARK: - Computed Properties\n\n    /// \ub370\uc774\ud130\uac00 \ube44\uc5b4\uc788\ub294\uc9c0 \ud655\uc778\n    private var isEmpty: Bool {\n        dataPoints.isEmpty\n    }\n\n    /// Y\ucd95 \ucd5c\uc18c\uac12\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Chart Scale Calculation\n    /// - \ucd5c\uc18c \uccb4\uc9c0\ubc29\ub960\ubcf4\ub2e4 \uc57d\uac04 \uc791\uc740 \uac12 (\uc5ec\ubc31)\n    /// - \ubaa9\ud45c \uccb4\uc9c0\ubc29\ub960\ub3c4 \uace0\ub824\n    /// - 0% \uc774\ud558\ub85c\ub294 \ub0b4\ub824\uac00\uc9c0 \uc54a\uc74c\n    private var yAxisMinimum: Double {\n        let minBodyFat = dataPoints.map { $0.bodyFatPercent }.min() ?? Decimal(10)\n        let goalBodyFatValue = goalBodyFat ?? minBodyFat\n        let minimum = min(minBodyFat, goalBodyFatValue)\n\n        // 5% \ub2e8\uc704\ub85c \ub0b4\ub9bc, \ucd5c\uc18c 0%\n        let minDouble = NSDecimalNumber(decimal: minimum).doubleValue\n        return max(0, floor(minDouble / 5.0) * 5.0)\n    }\n\n    /// Y\ucd95 \ucd5c\ub300\uac12\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Chart Scale Calculation\n    /// - \ucd5c\ub300 \uccb4\uc9c0\ubc29\ub960\ubcf4\ub2e4 \uc57d\uac04 \ud070 \uac12 (\uc5ec\ubc31)\n    /// - \ubaa9\ud45c \uccb4\uc9c0\ubc29\ub960\ub3c4 \uace0\ub824\n    private var yAxisMaximum: Double {\n        let maxBodyFat = dataPoints.map { $0.bodyFatPercent }.max() ?? Decimal(30)\n        let goalBodyFatValue = goalBodyFat ?? maxBodyFat\n        let maximum = max(maxBodyFat, goalBodyFatValue)\n\n        // 5% \ub2e8\uc704\ub85c \uc62c\ub9bc\n        let maxDouble = NSDecimalNumber(decimal: maximum).doubleValue\n        return ceil(maxDouble / 5.0) * 5.0\n    }\n\n    /// \uccb4\uc9c0\ubc29\ub960 \ubcc0\ud654\ub7c9 (\uccab \uae30\ub85d \ub300\ube44 \ub9c8\uc9c0\ub9c9 \uae30\ub85d)\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Trend Calculation\n    /// - \uc591\uc218: \uccb4\uc9c0\ubc29\ub960 \uc99d\uac00\n    /// - \uc74c\uc218: \uccb4\uc9c0\ubc29\ub960 \uac10\uc18c\n    private var bodyFatChange: Decimal? {\n        guard let first = dataPoints.first?.bodyFatPercent,\n              let last = dataPoints.last?.bodyFatPercent else {\n            return nil\n        }\n        return last - first\n    }\n\n    // MARK: - Initialization\n\n    /// BodyFatTrendChart \ucd08\uae30\ud654\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Flexible Initializer\n    /// - \uae30\ubcf8\uac12\uc744 \uc81c\uacf5\ud558\uc5ec \ud3b8\ub9ac\ud558\uac8c \uc0ac\uc6a9\n    ///\n    /// - Parameters:\n    ///   - dataPoints: \ucc28\ud2b8 \ub370\uc774\ud130 \ud3ec\uc778\ud2b8\n    ///   - goalBodyFat: \ubaa9\ud45c \uccb4\uc9c0\ubc29\ub960 (\uae30\ubcf8\uac12: nil)\n    ///   - period: \uc120\ud0dd\ub41c \uae30\uac04 (\uae30\ubcf8\uac12: .week)\n    ///   - isInteractive: \uc778\ud130\ub799\uc158 \ud65c\uc131\ud654 (\uae30\ubcf8\uac12: true)\n    ///   - height: \ucc28\ud2b8 \ub192\uc774 (\uae30\ubcf8\uac12: 300)\n    ///   - gender: \uc0ac\uc6a9\uc790 \uc131\ubcc4 (\uae30\ubcf8\uac12: nil)\n    ///   - showHealthZones: \uac74\uac15 \uad6c\uac04 \ud45c\uc2dc \uc5ec\ubd80 (\uae30\ubcf8\uac12: true)\n    init(\n        dataPoints: [FetchBodyTrendsUseCase.TrendDataPoint],\n        goalBodyFat: Decimal? = nil,\n        period: FetchBodyTrendsUseCase.TrendPeriod = .week,\n        isInteractive: Bool = true,\n        height: CGFloat = 300,\n        gender: Gender? = nil,\n        showHealthZones: Bool = true\n    ) {\n        self.dataPoints = dataPoints\n        self.goalBodyFat = goalBodyFat\n        self.period = period\n        self.isInteractive = isInteractive\n        self.height = height\n        self.gender = gender\n        self.showHealthZones = showHealthZones\n    }\n\n    // MARK: - Body\n\n    var body: some View {\n        VStack(alignment: .leading, spacing: 12) {\n            // \ucc28\ud2b8 \ud5e4\ub354\n            chartHeader\n\n            if isEmpty {\n                // \ube48 \uc0c1\ud0dc\n                emptyStateView\n            } else {\n                // \ucc28\ud2b8\n                chartView\n\n                // \ubc94\ub840\n                chartLegend\n\n                // \uc120\ud0dd\ub41c \ub370\uc774\ud130 \ud3ec\uc778\ud2b8 \uc0c1\uc138 \uc815\ubcf4\n                if let selected = selectedDataPoint {\n                    selectedDataPointDetail(selected)\n                }\n            }\n        }\n    }\n\n    // MARK: - Subviews\n\n    /// \ucc28\ud2b8 \ud5e4\ub354\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Header with Statistics\n    /// - \uc81c\ubaa9, \uae30\uac04, \ubcc0\ud654\ub7c9 \ud45c\uc2dc\n    private var chartHeader: some View {\n        HStack(alignment: .top) {\n            VStack(alignment: .leading, spacing: 4) {\n                // \uc81c\ubaa9\n                HStack(spacing: 6) {\n                    Image(systemName: \"chart.line.uptrend.xyaxis\")\n                        .font(.title3)\n                        .foregroundStyle(.orange)\n\n                    Text(\"\uccb4\uc9c0\ubc29\ub960 \ud2b8\ub80c\ub4dc\")\n                        .font(.headline)\n                        .fontWeight(.semibold)\n                        .foregroundStyle(.primary)\n                }\n\n                // \uae30\uac04\n                Text(period.displayName)\n                    .font(.caption)\n                    .foregroundStyle(.secondary)\n            }\n\n            Spacer()\n\n            // \ubcc0\ud654\ub7c9 \ud45c\uc2dc\n            if let change = bodyFatChange {\n                bodyFatChangeBadge(change)\n            }\n        }\n    }\n\n    /// \uccb4\uc9c0\ubc29\ub960 \ubcc0\ud654\ub7c9 \ubc43\uc9c0\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Visual Indicator\n    /// - \uc99d\uac00\ub294 \uc8fc\ud669\uc0c9 (\ubd80\uc815\uc801), \uac10\uc18c\ub294 \ud30c\ub791 (\uae0d\uc815\uc801)\n    ///\n    /// - Parameter change: \uccb4\uc9c0\ubc29\ub960 \ubcc0\ud654\ub7c9\n    /// - Returns: \ubc43\uc9c0 \ubdf0\n    private func bodyFatChangeBadge(_ change: Decimal) -> some View {\n        let isIncrease = change > 0\n        let color: Color = isIncrease ? .orange : .blue\n        let icon = isIncrease ? \"arrow.up.right\" : \"arrow.down.right\"\n\n        return HStack(spacing: 4) {\n            Image(systemName: icon)\n                .font(.caption2)\n\n            Text(formatBodyFatChange(change))\n                .font(.caption)\n                .fontWeight(.semibold)\n        }\n        .foregroundStyle(color)\n        .padding(.horizontal, 10)\n        .padding(.vertical, 6)\n        .background(color.opacity(0.15))\n        .cornerRadius(8)\n    }\n\n    /// \ucc28\ud2b8 \ubdf0\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Swift Charts Implementation with Health Zones\n    /// - Chart { } \ube14\ub85d \ub0b4\uc5d0 Mark \uc815\uc758\n    /// - RectangleMark: \uac74\uac15 \uad6c\uac04 \ubc30\uacbd \ud45c\uc2dc\n    /// - LineMark: \ub77c\uc778 \uadf8\ub798\ud504\n    /// - PointMark: \ub370\uc774\ud130 \ud3ec\uc778\ud2b8 \ud45c\uc2dc\n    /// - RuleMark: \ubaa9\ud45c\uc120 \ud45c\uc2dc\n    private var chartView: some View {\n        Chart {\n            // \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Health Zone Backgrounds\n            // \uac74\uac15 \uad6c\uac04\uc744 \ubc30\uacbd\uc5d0 \ud45c\uc2dc (\uc120\ud0dd\uc801)\n            if showHealthZones {\n                healthZoneBackgrounds\n            }\n\n            // \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: ForEach in Chart\n            // \uac01 \ub370\uc774\ud130 \ud3ec\uc778\ud2b8\ub97c LineMark\ub85c \ubcc0\ud658\n            ForEach(dataPoints) { dataPoint in\n                // \ub77c\uc778 \uadf8\ub798\ud504\n                LineMark(\n                    x: .value(\"\ub0a0\uc9dc\", dataPoint.date),\n                    y: .value(\"\uccb4\uc9c0\ubc29\ub960\", NSDecimalNumber(decimal: dataPoint.bodyFatPercent).doubleValue)\n                )\n                .foregroundStyle(lineColor(for: dataPoint.bodyFatPercent))\n                .lineStyle(StrokeStyle(lineWidth: 3, lineCap: .round, lineJoin: .round))\n                .interpolationMethod(.catmullRom) // \ubd80\ub4dc\ub7ec\uc6b4 \uace1\uc120\n\n                // \ub370\uc774\ud130 \ud3ec\uc778\ud2b8 \ud45c\uc2dc\n                PointMark(\n                    x: .value(\"\ub0a0\uc9dc\", dataPoint.date),\n                    y: .value(\"\uccb4\uc9c0\ubc29\ub960\", NSDecimalNumber(decimal: dataPoint.bodyFatPercent).doubleValue)\n                )\n                .foregroundStyle(lineColor(for: dataPoint.bodyFatPercent))\n                .symbolSize(60)\n\n                // \uc601\uc5ed \ucc44\uc6b0\uae30 (\uc120 \uc544\ub798 \ubd80\ubd84)\n                // \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Area Chart with Gradient\n                // AreaMark\ub97c \ucd94\uac00\ud558\uc5ec \ub77c\uc778 \uc544\ub798\ub97c \uadf8\ub77c\ub370\uc774\uc158\uc73c\ub85c \ucc44\uc6c0\n                AreaMark(\n                    x: .value(\"\ub0a0\uc9dc\", dataPoint.date),\n                    y: .value(\"\uccb4\uc9c0\ubc29\ub960\", NSDecimalNumber(decimal: dataPoint.bodyFatPercent).doubleValue)\n                )\n                .foregroundStyle(\n                    LinearGradient(\n                        colors: [lineColor(for: dataPoint.bodyFatPercent).opacity(0.3), lineColor(for: dataPoint.bodyFatPercent).opacity(0.05)],\n                        startPoint: .top,\n                        endPoint: .bottom\n                    )\n                )\n                .interpolationMethod(.catmullRom)\n            }\n\n            // \ubaa9\ud45c\uc120 \ud45c\uc2dc\n            // \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: RuleMark for Goal Line\n            if let goal = goalBodyFat {\n                RuleMark(\n                    y: .value(\"\ubaa9\ud45c\", NSDecimalNumber(decimal: goal).doubleValue)\n                )\n                .foregroundStyle(.green)\n                .lineStyle(StrokeStyle(lineWidth: 2, dash: [5, 5])) // \uc810\uc120\n                .annotation(position: .top, alignment: .trailing) {\n                    Text(\"\ubaa9\ud45c: \\(formatBodyFat(goal))\")\n                        .font(.caption2)\n                        .foregroundStyle(.green)\n                        .padding(.horizontal, 8)\n                        .padding(.vertical, 4)\n                        .background(Color.green.opacity(0.1))\n                        .cornerRadius(6)\n                }\n            }\n\n            // \uc120\ud0dd\ub41c \ub370\uc774\ud130 \ud3ec\uc778\ud2b8 \uac15\uc870\n            // \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Selection Indicator\n            if let selected = selectedDataPoint {\n                RuleMark(\n                    x: .value(\"\ub0a0\uc9dc\", selected.date)\n                )\n                .foregroundStyle(.gray.opacity(0.3))\n                .lineStyle(StrokeStyle(lineWidth: 1, dash: [3, 3]))\n\n                PointMark(\n                    x: .value(\"\ub0a0\uc9dc\", selected.date),\n                    y: .value(\"\uccb4\uc9c0\ubc29\ub960\", NSDecimalNumber(decimal: selected.bodyFatPercent).doubleValue)\n                )\n                .foregroundStyle(.white)\n                .symbolSize(120)\n                .symbol {\n                    Circle()\n                        .fill(lineColor(for: selected.bodyFatPercent))\n                        .strokeBorder(.white, lineWidth: 3)\n                        .shadow(color: lineColor(for: selected.bodyFatPercent).opacity(0.3), radius: 4)\n                }\n            }\n        }\n        .chartXAxis {\n            // \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Custom X Axis\n            // \ub0a0\uc9dc \ub808\uc774\ube14 \ud45c\uc2dc\n            AxisMarks(values: .automatic) { value in\n                AxisGridLine()\n                AxisTick()\n                AxisValueLabel(format: .dateTime.month(.abbreviated).day())\n            }\n        }\n        .chartYAxis {\n            // \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Custom Y Axis\n            // \uccb4\uc9c0\ubc29\ub960 \ub808\uc774\ube14 \ud45c\uc2dc (% \ub2e8\uc704)\n            AxisMarks(position: .leading) { value in\n                AxisGridLine()\n                AxisTick()\n                AxisValueLabel {\n                    if let doubleValue = value.as(Double.self) {\n                        Text(\"\\(Int(doubleValue))%\")\n                            .font(.caption)\n                            .foregroundStyle(.secondary)\n                    }\n                }\n            }\n        }\n        .chartYScale(domain: yAxisMinimum...yAxisMaximum)\n        .chartXSelection(value: $selectedDate)\n        .frame(height: height)\n        .padding(.vertical, 8)\n        .disabled(!isInteractive) // \uc778\ud130\ub799\uc158 \ube44\ud65c\uc131\ud654 \uc2dc \ud0ed \ubd88\uac00\n    }\n\n    /// \uac74\uac15 \uad6c\uac04 \ubc30\uacbd\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Zone Background with RectangleMark\n    /// - \uc131\ubcc4\uc5d0 \ub530\ub978 \uac74\uac15 \uad6c\uac04\uc744 \ubc30\uacbd\uc5d0 \ud45c\uc2dc\n    /// - \ud22c\uba85\ub3c4\ub97c \ub0ae\ucdb0\uc11c \ub77c\uc778\uc774 \uc798 \ubcf4\uc774\ub3c4\ub85d \ud568\n    @ChartContentBuilder\n    private var healthZoneBackgrounds: some ChartContent {\n        // \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Gender-Based Zone Display\n        // \uc131\ubcc4\uc774 \uc9c0\uc815\ub418\uc9c0 \uc54a\uc740 \uacbd\uc6b0 \uc77c\ubc18\uc801\uc778 \uad6c\uac04 \uc0ac\uc6a9 (\ub0a8\uc131 \uae30\uc900)\n        let isMale = gender == .male || gender == nil\n\n        if isMale {\n            // \ub0a8\uc131 \uae30\uc900 \uad6c\uac04\n            // \ud544\uc218 \uc9c0\ubc29: 0-6%\n            RectangleMark(\n                xStart: nil,\n                xEnd: nil,\n                yStart: .value(\"Zone Start\", 0),\n                yEnd: .value(\"Zone End\", 6)\n            )\n            .foregroundStyle(BodyFatZone.essentialFat.color.opacity(0.1))\n\n            // \uc6b4\ub3d9\uc120\uc218: 6-14%\n            RectangleMark(\n                xStart: nil,\n                xEnd: nil,\n                yStart: .value(\"Zone Start\", 6),\n                yEnd: .value(\"Zone End\", 14)\n            )\n            .foregroundStyle(BodyFatZone.athletes.color.opacity(0.1))\n\n            // \ud53c\ud2b8\ub2c8\uc2a4: 14-18%\n            RectangleMark(\n                xStart: nil,\n                xEnd: nil,\n                yStart: .value(\"Zone Start\", 14),\n                yEnd: .value(\"Zone End\", 18)\n            )\n            .foregroundStyle(BodyFatZone.fitness.color.opacity(0.1))\n\n            // \ud3c9\uade0: 18-25%\n            RectangleMark(\n                xStart: nil,\n                xEnd: nil,\n                yStart: .value(\"Zone Start\", 18),\n                yEnd: .value(\"Zone End\", 25)\n            )\n            .foregroundStyle(BodyFatZone.average.color.opacity(0.1))\n\n            // \ube44\ub9cc: 25%+\n            RectangleMark(\n                xStart: nil,\n                xEnd: nil,\n                yStart: .value(\"Zone Start\", 25),\n                yEnd: .value(\"Zone End\", 100)\n            )\n            .foregroundStyle(BodyFatZone.obese.color.opacity(0.1))\n        } else {\n            // \uc5ec\uc131 \uae30\uc900 \uad6c\uac04\n            // \ud544\uc218 \uc9c0\ubc29: 0-14%\n            RectangleMark(\n                xStart: nil,\n                xEnd: nil,\n                yStart: .value(\"Zone Start\", 0),\n                yEnd: .value(\"Zone End\", 14)\n            )\n            .foregroundStyle(BodyFatZone.essentialFat.color.opacity(0.1))\n\n            // \uc6b4\ub3d9\uc120\uc218: 14-21%\n            RectangleMark(\n                xStart: nil,\n                xEnd: nil,\n                yStart: .value(\"Zone Start\", 14),\n                yEnd: .value(\"Zone End\", 21)\n            )\n            .foregroundStyle(BodyFatZone.athletes.color.opacity(0.1))\n\n            // \ud53c\ud2b8\ub2c8\uc2a4: 21-25%\n            RectangleMark(\n                xStart: nil,\n                xEnd: nil,\n                yStart: .value(\"Zone Start\", 21),\n                yEnd: .value(\"Zone End\", 25)\n            )\n            .foregroundStyle(BodyFatZone.fitness.color.opacity(0.1))\n\n            // \ud3c9\uade0: 25-32%\n            RectangleMark(\n                xStart: nil,\n                xEnd: nil,\n                yStart: .value(\"Zone Start\", 25),\n                yEnd: .value(\"Zone End\", 32)\n            )\n            .foregroundStyle(BodyFatZone.average.color.opacity(0.1))\n\n            // \ube44\ub9cc: 32%+\n            RectangleMark(\n                xStart: nil,\n                xEnd: nil,\n                yStart: .value(\"Zone Start\", 32),\n                yEnd: .value(\"Zone End\", 100)\n            )\n            .foregroundStyle(BodyFatZone.obese.color.opacity(0.1))\n        }\n    }\n\n    /// \uccb4\uc9c0\ubc29\ub960\uc5d0 \ub530\ub978 \ub77c\uc778 \uc0c9\uc0c1 \uacb0\uc815\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Dynamic Color Based on Value\n    /// - \uac74\uac15 \uad6c\uac04\uc5d0 \ub530\ub77c \ub2e4\ub978 \uc0c9\uc0c1 \ubc18\ud658\n    ///\n    /// - Parameter bodyFat: \uccb4\uc9c0\ubc29\ub960\n    /// - Returns: \uc0c9\uc0c1\n    private func lineColor(for bodyFat: Decimal) -> Color {\n        guard let gender = gender else {\n            // \uc131\ubcc4 \uc815\ubcf4 \uc5c6\uc73c\uba74 \uae30\ubcf8 \uc0c9\uc0c1 (\uc8fc\ud669\uc0c9)\n            return .orange\n        }\n\n        let zone: BodyFatZone = gender == .male ? .forMale(bodyFat) : .forFemale(bodyFat)\n        return zone.color\n    }\n\n    /// \ubc94\ub840\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Legend Component with Health Zones\n    /// - \ucc28\ud2b8 \uc694\uc18c \uc124\uba85\n    /// - \uac74\uac15 \uad6c\uac04 \ud45c\uc2dc\n    private var chartLegend: some View {\n        VStack(alignment: .leading, spacing: 8) {\n            HStack(spacing: 20) {\n                // \uccb4\uc9c0\ubc29\ub960 \ub77c\uc778\n                HStack(spacing: 6) {\n                    Circle()\n                        .fill(.orange)\n                        .frame(width: 10, height: 10)\n\n                    Text(\"\uccb4\uc9c0\ubc29\ub960\")\n                        .font(.caption)\n                        .foregroundStyle(.secondary)\n                }\n\n                // \ubaa9\ud45c\uc120\n                if goalBodyFat != nil {\n                    HStack(spacing: 6) {\n                        Rectangle()\n                            .fill(.green)\n                            .frame(width: 20, height: 2)\n\n                        Text(\"\ubaa9\ud45c\")\n                            .font(.caption)\n                            .foregroundStyle(.secondary)\n                    }\n                }\n            }\n\n            // \uac74\uac15 \uad6c\uac04 \ubc94\ub840 (\ud65c\uc131\ud654\ub41c \uacbd\uc6b0\uc5d0\ub9cc)\n            if showHealthZones {\n                Divider()\n                    .padding(.vertical, 4)\n\n                Text(\"\uac74\uac15 \uad6c\uac04\" + (gender != nil ? \" (\\(gender == .male ? \"\ub0a8\uc131\" : \"\uc5ec\uc131\") \uae30\uc900)\" : \"\"))\n                    .font(.caption2)\n                    .foregroundStyle(.secondary)\n                    .fontWeight(.semibold)\n\n                LazyVGrid(columns: [\n                    GridItem(.flexible()),\n                    GridItem(.flexible())\n                ], spacing: 8) {\n                    healthZoneLegendItem(.essentialFat)\n                    healthZoneLegendItem(.athletes)\n                    healthZoneLegendItem(.fitness)\n                    healthZoneLegendItem(.average)\n                    healthZoneLegendItem(.obese)\n                }\n            }\n        }\n    }\n\n    /// \uac74\uac15 \uad6c\uac04 \ubc94\ub840 \uc544\uc774\ud15c\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Reusable Legend Item\n    ///\n    /// - Parameter zone: \uac74\uac15 \uad6c\uac04\n    /// - Returns: \ubc94\ub840 \uc544\uc774\ud15c \ubdf0\n    private func healthZoneLegendItem(_ zone: BodyFatZone) -> some View {\n        HStack(spacing: 4) {\n            Rectangle()\n                .fill(zone.color)\n                .frame(width: 12, height: 12)\n                .cornerRadius(2)\n\n            Text(zone.displayName)\n                .font(.caption2)\n                .foregroundStyle(.secondary)\n        }\n        .frame(maxWidth: .infinity, alignment: .leading)\n    }\n\n    /// \uc120\ud0dd\ub41c \ub370\uc774\ud130 \ud3ec\uc778\ud2b8 \uc0c1\uc138 \uc815\ubcf4\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Selection Detail\n    /// - \uc120\ud0dd\ud55c \ud3ec\uc778\ud2b8\uc758 \uc815\ubcf4\ub97c \uce74\ub4dc\ub85c \ud45c\uc2dc\n    ///\n    /// - Parameter dataPoint: \uc120\ud0dd\ub41c \ub370\uc774\ud130 \ud3ec\uc778\ud2b8\n    /// - Returns: \uc0c1\uc138 \uc815\ubcf4 \ubdf0\n    private func selectedDataPointDetail(_ dataPoint: FetchBodyTrendsUseCase.TrendDataPoint) -> some View {\n        VStack(alignment: .leading, spacing: 12) {\n            // \ub0a0\uc9dc\n            HStack {\n                Image(systemName: \"calendar\")\n                    .font(.caption)\n                    .foregroundStyle(.orange)\n\n                Text(formatDate(dataPoint.date))\n                    .font(.subheadline)\n                    .fontWeight(.medium)\n                    .foregroundStyle(.primary)\n\n                Spacer()\n\n                // \uc120\ud0dd \ud574\uc81c \ubc84\ud2bc\n                Button(action: {\n                    selectedDate = nil\n                }) {\n                    Image(systemName: \"xmark.circle.fill\")\n                        .font(.caption)\n                        .foregroundStyle(.gray)\n                }\n            }\n\n            Divider()\n\n            // \uce21\uc815 \uac12\n            HStack(spacing: 24) {\n                // \uccb4\uc9c0\ubc29\ub960\n                measurementItem(\n                    icon: \"percent\",\n                    label: \"\uccb4\uc9c0\ubc29\ub960\",\n                    value: formatBodyFat(dataPoint.bodyFatPercent),\n                    color: lineColor(for: dataPoint.bodyFatPercent)\n                )\n\n                // \uccb4\uc911\n                measurementItem(\n                    icon: \"scalemass\",\n                    label: \"\uccb4\uc911\",\n                    value: formatWeight(dataPoint.weight),\n                    color: .blue\n                )\n\n                // \uadfc\uc721\ub7c9 (\uc788\ub294 \uacbd\uc6b0)\n                if let muscleMass = dataPoint.muscleMass {\n                    measurementItem(\n                        icon: \"figure.strengthtraining.traditional\",\n                        label: \"\uadfc\uc721\ub7c9\",\n                        value: formatWeight(muscleMass),\n                        color: .purple\n                    )\n                }\n            }\n\n            // \uac74\uac15 \uad6c\uac04 \ud45c\uc2dc\n            if let gender = gender {\n                let zone: BodyFatZone = gender == .male ? .forMale(dataPoint.bodyFatPercent) : .forFemale(dataPoint.bodyFatPercent)\n\n                HStack(spacing: 6) {\n                    Image(systemName: \"heart.circle.fill\")\n                        .font(.caption)\n                        .foregroundStyle(zone.color)\n\n                    Text(\"\uac74\uac15 \uad6c\uac04: \\(zone.displayName)\")\n                        .font(.caption)\n                        .foregroundStyle(.secondary)\n                }\n                .padding(.top, 4)\n            }\n\n            // \ub300\uc0ac\uc728 \uc815\ubcf4 (\uc788\ub294 \uacbd\uc6b0)\n            if let bmr = dataPoint.bmr, let tdee = dataPoint.tdee {\n                Divider()\n\n                HStack(spacing: 24) {\n                    measurementItem(\n                        icon: \"flame\",\n                        label: \"BMR\",\n                        value: formatCalories(bmr),\n                        color: .red\n                    )\n\n                    measurementItem(\n                        icon: \"figure.walk\",\n                        label: \"TDEE\",\n                        value: formatCalories(tdee),\n                        color: .green\n                    )\n                }\n            }\n        }\n        .padding(16)\n        .background(\n            RoundedRectangle(cornerRadius: 12)\n                .fill(Color(.secondarySystemBackground))\n        )\n        .transition(.opacity.combined(with: .move(edge: .bottom)))\n        .animation(.easeInOut(duration: 0.2), value: selectedDate)\n    }\n\n    /// \uce21\uc815 \uac12 \uc544\uc774\ud15c\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Reusable Component Function\n    /// - \ubc18\ubcf5\ub418\ub294 \uce21\uc815\uac12 \ud45c\uc2dc \ud328\ud134\uc744 \uc7ac\uc0ac\uc6a9\n    ///\n    /// - Parameters:\n    ///   - icon: SF Symbol \uc544\uc774\ucf58 \uc774\ub984\n    ///   - label: \ub808\uc774\ube14 \ud14d\uc2a4\ud2b8\n    ///   - value: \uce21\uc815 \uac12\n    ///   - color: \uac15\uc870 \uc0c9\uc0c1\n    /// - Returns: \uce21\uc815 \uac12 \ud45c\uc2dc \ubdf0\n    private func measurementItem(\n        icon: String,\n        label: String,\n        value: String,\n        color: Color\n    ) -> some View {\n        VStack(alignment: .leading, spacing: 4) {\n            HStack(spacing: 4) {\n                Image(systemName: icon)\n                    .font(.caption2)\n                    .foregroundStyle(color)\n\n                Text(label)\n                    .font(.caption)\n                    .foregroundStyle(.secondary)\n            }\n\n            Text(value)\n                .font(.subheadline)\n                .fontWeight(.semibold)\n                .foregroundStyle(.primary)\n        }\n        .frame(maxWidth: .infinity, alignment: .leading)\n    }\n\n    /// \ube48 \uc0c1\ud0dc \ubdf0\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Empty State UI\n    /// - \ub370\uc774\ud130\uac00 \uc5c6\uc744 \ub54c \uc0ac\uc6a9\uc790\uc5d0\uac8c \uc548\ub0b4\n    private var emptyStateView: some View {\n        VStack(spacing: 16) {\n            Image(systemName: \"chart.xyaxis.line\")\n                .font(.system(size: 60))\n                .foregroundStyle(.gray.opacity(0.3))\n\n            VStack(spacing: 8) {\n                Text(\"\uccb4\uc9c0\ubc29\ub960 \ub370\uc774\ud130\uac00 \uc5c6\uc2b5\ub2c8\ub2e4\")\n                    .font(.headline)\n                    .foregroundStyle(.primary)\n\n                Text(\"\uc2e0\uccb4 \uad6c\uc131 \ub370\uc774\ud130\ub97c \uc785\ub825\ud558\uba74\\n\uccb4\uc9c0\ubc29\ub960 \ud2b8\ub80c\ub4dc\ub97c \ud655\uc778\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4\")\n                    .font(.subheadline)\n                    .foregroundStyle(.secondary)\n                    .multilineTextAlignment(.center)\n            }\n        }\n        .frame(height: height)\n        .frame(maxWidth: .infinity)\n    }\n\n    // MARK: - Helper Methods\n\n    /// \ub0a0\uc9dc \ud3ec\ub9f7\ud305\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Date Formatting\n    /// - \"2024\ub144 1\uc6d4 15\uc77c (\uc6d4)\" \ud615\uc2dd\n    ///\n    /// - Parameter date: \ub0a0\uc9dc\n    /// - Returns: \ud3ec\ub9f7\ub41c \ubb38\uc790\uc5f4\n    private func formatDate(_ date: Date) -> String {\n        let formatter = DateFormatter()\n        formatter.dateFormat = \"yyyy\ub144 M\uc6d4 d\uc77c (E)\"\n        formatter.locale = Locale(identifier: \"ko_KR\")\n        return formatter.string(from: date)\n    }\n\n    /// \uccb4\uc911 \ud3ec\ub9f7\ud305\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Weight Formatting\n    /// - \uc18c\uc218\uc810 1\uc790\ub9ac + \"kg\" \ub2e8\uc704\n    ///\n    /// - Parameter weight: \uccb4\uc911\n    /// - Returns: \ud3ec\ub9f7\ub41c \ubb38\uc790\uc5f4 (\uc608: \"70.5 kg\")\n    private func formatWeight(_ weight: Decimal) -> String {\n        let formatter = NumberFormatter()\n        formatter.numberStyle = .decimal\n        formatter.maximumFractionDigits = 1\n        formatter.minimumFractionDigits = 1\n\n        let number = NSDecimalNumber(decimal: weight)\n        return (formatter.string(from: number) ?? \"\\(weight)\") + \" kg\"\n    }\n\n    /// \uccb4\uc9c0\ubc29\ub960 \ud3ec\ub9f7\ud305\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Percentage Formatting\n    /// - \uc18c\uc218\uc810 1\uc790\ub9ac + \"%\" \uae30\ud638\n    ///\n    /// - Parameter bodyFat: \uccb4\uc9c0\ubc29\ub960\n    /// - Returns: \ud3ec\ub9f7\ub41c \ubb38\uc790\uc5f4 (\uc608: \"18.5%\")\n    private func formatBodyFat(_ bodyFat: Decimal) -> String {\n        let formatter = NumberFormatter()\n        formatter.numberStyle = .decimal\n        formatter.maximumFractionDigits = 1\n        formatter.minimumFractionDigits = 1\n\n        let number = NSDecimalNumber(decimal: bodyFat)\n        return (formatter.string(from: number) ?? \"\\(bodyFat)\") + \"%\"\n    }\n\n    /// \uccb4\uc9c0\ubc29\ub960 \ubcc0\ud654\ub7c9 \ud3ec\ub9f7\ud305\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Signed Number Formatting\n    /// - \uc591\uc218\ub294 +, \uc74c\uc218\ub294 - \uae30\ud638 \ud3ec\ud568\n    ///\n    /// - Parameter change: \ubcc0\ud654\ub7c9\n    /// - Returns: \ud3ec\ub9f7\ub41c \ubb38\uc790\uc5f4 (\uc608: \"+1.5%\", \"-0.8%\")\n    private func formatBodyFatChange(_ change: Decimal) -> String {\n        let formatter = NumberFormatter()\n        formatter.numberStyle = .decimal\n        formatter.maximumFractionDigits = 1\n        formatter.minimumFractionDigits = 1\n        formatter.positivePrefix = \"+\"\n        formatter.negativePrefix = \"-\"\n\n        let number = NSDecimalNumber(decimal: change)\n        return (formatter.string(from: number) ?? \"\\(change)\") + \"%\"\n    }\n\n    /// \uce7c\ub85c\ub9ac \ud3ec\ub9f7\ud305\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Calorie Formatting\n    /// - \uc815\uc218 + \"kcal\" \ub2e8\uc704\n    ///\n    /// - Parameter calories: \uce7c\ub85c\ub9ac \uac12\n    /// - Returns: \ud3ec\ub9f7\ub41c \ubb38\uc790\uc5f4 (\uc608: \"1,650 kcal\")\n    private func formatCalories(_ calories: Decimal) -> String {\n        let formatter = NumberFormatter()\n        formatter.numberStyle = .decimal\n        formatter.maximumFractionDigits = 0\n\n        let number = NSDecimalNumber(decimal: calories)\n        return (formatter.string(from: number) ?? \"\\(calories)\") + \" kcal\"\n    }\n}\n\n// MARK: - Convenience Initializers\n\nextension BodyFatTrendChart {\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Convenience Initializer with ViewModel\n    /// - BodyTrendsViewModel\uc5d0\uc11c \uc9c1\uc811 \uac12\uc744 \uac00\uc838\uc624\ub294 \ud3b8\uc758 \uc0dd\uc131\uc790\n    /// - View\uc5d0\uc11c \uc27d\uac8c \uc0ac\uc6a9 \uac00\ub2a5\n    ///\n    /// - Parameters:\n    ///   - viewModel: BodyTrendsViewModel \uc778\uc2a4\ud134\uc2a4\n    ///   - goalBodyFat: \ubaa9\ud45c \uccb4\uc9c0\ubc29\ub960 (\uae30\ubcf8\uac12: nil)\n    ///   - isInteractive: \uc778\ud130\ub799\uc158 \ud65c\uc131\ud654 (\uae30\ubcf8\uac12: true)\n    ///   - height: \ucc28\ud2b8 \ub192\uc774 (\uae30\ubcf8\uac12: 300)\n    ///   - gender: \uc0ac\uc6a9\uc790 \uc131\ubcc4 (\uae30\ubcf8\uac12: nil)\n    ///   - showHealthZones: \uac74\uac15 \uad6c\uac04 \ud45c\uc2dc \uc5ec\ubd80 (\uae30\ubcf8\uac12: true)\n    init(\n        viewModel: BodyTrendsViewModel,\n        goalBodyFat: Decimal? = nil,\n        isInteractive: Bool = true,\n        height: CGFloat = 300,\n        gender: Gender? = nil,\n        showHealthZones: Bool = true\n    ) {\n        self.dataPoints = viewModel.dataPoints\n        self.goalBodyFat = goalBodyFat\n        self.period = viewModel.selectedPeriod\n        self.isInteractive = isInteractive\n        self.height = height\n        self.gender = gender\n        self.showHealthZones = showHealthZones\n    }\n}\n\n// MARK: - Preview\n\n#Preview(\"7\uc77c \ub370\uc774\ud130\") {\n    ScrollView {\n        BodyFatTrendChart(\n            dataPoints: FetchBodyTrendsUseCase.sampleOutput().dataPoints,\n            period: .week\n        )\n        .padding()\n    }\n}\n\n#Preview(\"7\uc77c \ub370\uc774\ud130 + \ubaa9\ud45c\uc120\") {\n    ScrollView {\n        BodyFatTrendChart(\n            dataPoints: FetchBodyTrendsUseCase.sampleOutput().dataPoints,\n            goalBodyFat: Decimal(15.0),\n            period: .week\n        )\n        .padding()\n    }\n}\n\n#Preview(\"\uac74\uac15 \uad6c\uac04 \ud45c\uc2dc (\ub0a8\uc131)\") {\n    ScrollView {\n        BodyFatTrendChart(\n            dataPoints: FetchBodyTrendsUseCase.sampleOutput().dataPoints,\n            period: .week,\n            gender: .male,\n            showHealthZones: true\n        )\n        .padding()\n    }\n}\n\n#Preview(\"\uac74\uac15 \uad6c\uac04 \ud45c\uc2dc (\uc5ec\uc131)\") {\n    ScrollView {\n        BodyFatTrendChart(\n            dataPoints: FetchBodyTrendsUseCase.sampleOutput().dataPoints,\n            period: .week,\n            gender: .female,\n            showHealthZones: true\n        )\n        .padding()\n    }\n}\n\n#Preview(\"\uac74\uac15 \uad6c\uac04 \uc228\uae40\") {\n    ScrollView {\n        BodyFatTrendChart(\n            dataPoints: FetchBodyTrendsUseCase.sampleOutput().dataPoints,\n            period: .week,\n            showHealthZones: false\n        )\n        .padding()\n    }\n}\n\n#Preview(\"\ube48 \uc0c1\ud0dc\") {\n    ScrollView {\n        BodyFatTrendChart(\n            dataPoints: [],\n            period: .week\n        )\n        .padding()\n    }\n}\n\n#Preview(\"\uc778\ud130\ub799\uc158 \ube44\ud65c\uc131\ud654\") {\n    ScrollView {\n        BodyFatTrendChart(\n            dataPoints: FetchBodyTrendsUseCase.sampleOutput().dataPoints,\n            period: .week,\n            isInteractive: false,\n            height: 200\n        )\n        .padding()\n    }\n}\n\n#Preview(\"\ub2e4\ud06c \ubaa8\ub4dc\") {\n    ScrollView {\n        BodyFatTrendChart(\n            dataPoints: FetchBodyTrendsUseCase.sampleOutput().dataPoints,\n            goalBodyFat: Decimal(15.0),\n            period: .month,\n            gender: .male,\n            showHealthZones: true\n        )\n        .padding()\n    }\n    .preferredColorScheme(.dark)\n}\n\n#Preview(\"\ub300\uc2dc\ubcf4\ub4dc \ud06c\uae30 (\uc791\uac8c)\") {\n    ScrollView {\n        VStack(spacing: 16) {\n            Text(\"\ub300\uc2dc\ubcf4\ub4dc \uce74\ub4dc \ud06c\uae30 \uc608\uc2dc\")\n                .font(.headline)\n\n            BodyFatTrendChart(\n                dataPoints: FetchBodyTrendsUseCase.sampleOutput().dataPoints,\n                period: .week,\n                isInteractive: false,\n                height: 180,\n                showHealthZones: false\n            )\n            .padding()\n            .background(\n                RoundedRectangle(cornerRadius: 12)\n                    .fill(Color(.systemBackground))\n                    .shadow(color: .black.opacity(0.05), radius: 8)\n            )\n        }\n        .padding()\n    }\n}\n\n#Preview(\"30\uc77c \ub370\uc774\ud130 - \ub2e4\uc591\ud55c \uad6c\uac04\") {\n    ScrollView {\n        let now = Date()\n        let dataPoints = stride(from: -29, through: 0, by: 3).map { dayOffset in\n            // \uccb4\uc9c0\ubc29\ub960\uc744 \uc810\uc9c4\uc801\uc73c\ub85c \ubcc0\ud654\uc2dc\ucf1c \ub2e4\uc591\ud55c \uac74\uac15 \uad6c\uac04 \ud45c\uc2dc\n            let progress = Double(dayOffset + 29) / 29.0\n            let bodyFat = 25.0 - (progress * 10.0) // 25% \u2192 15%\ub85c \uac10\uc18c\n\n            return FetchBodyTrendsUseCase.TrendDataPoint(\n                id: UUID(),\n                date: Calendar.current.date(byAdding: .day, value: dayOffset, to: now)!,\n                weight: Decimal(72.0 + Double(dayOffset) * 0.05),\n                bodyFatPercent: Decimal(bodyFat),\n                muscleMass: Decimal(31.0 - Double(dayOffset) * 0.02),\n                bmr: Decimal(1680),\n                tdee: Decimal(2280)\n            )\n        }\n\n        BodyFatTrendChart(\n            dataPoints: dataPoints,\n            goalBodyFat: Decimal(15.0),\n            period: .month,\n            gender: .male,\n            showHealthZones: true\n        )\n        .padding()\n    }\n}\n\n// MARK: - Documentation\n\n/// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: BodyFatTrendChart \uc0ac\uc6a9\ubc95\n///\n/// ViewModel\uacfc \ud568\uaed8 \uc0ac\uc6a9 (\uad8c\uc7a5):\n/// ```swift\n/// struct BodyTrendsView: View {\n///     @StateObject private var viewModel: BodyTrendsViewModel\n///\n///     var body: some View {\n///         BodyFatTrendChart(\n///             viewModel: viewModel,\n///             goalBodyFat: Decimal(15.0),\n///             gender: .male,\n///             showHealthZones: true\n///         )\n///     }\n/// }\n/// ```\n///\n/// \ub370\uc774\ud130 \uc9c1\uc811 \uc804\ub2ec:\n/// ```swift\n/// struct MyView: View {\n///     let dataPoints: [FetchBodyTrendsUseCase.TrendDataPoint]\n///\n///     var body: some View {\n///         BodyFatTrendChart(\n///             dataPoints: dataPoints,\n///             goalBodyFat: Decimal(15.0),\n///             period: .month,\n///             isInteractive: true,\n///             height: 300,\n///             gender: .male,\n///             showHealthZones: true\n///         )\n///     }\n/// }\n/// ```\n///\n/// \ub300\uc2dc\ubcf4\ub4dc \ud06c\uae30 (\uac74\uac15 \uad6c\uac04 \uc228\uae40):\n/// ```swift\n/// BodyFatTrendChart(\n///     dataPoints: dataPoints,\n///     period: .week,\n///     isInteractive: false,\n///     height: 180,\n///     showHealthZones: false\n/// )\n/// ```\n///\n/// \uc8fc\uc694 \uae30\ub2a5:\n/// - Swift Charts \uae30\ubc18 \ub77c\uc778 \ucc28\ud2b8\n/// - \ubd80\ub4dc\ub7ec\uc6b4 \uace1\uc120 (Catmull-Rom interpolation)\n/// - \uadf8\ub77c\ub370\uc774\uc158 \uc601\uc5ed \ucc44\uc6b0\uae30\n/// - \uac74\uac15 \uad6c\uac04\ubcc4 \ubc30\uacbd \uc0c9\uc0c1 \ud45c\uc2dc (\ub0a8\uc131/\uc5ec\uc131 \uae30\uc900 \ub2e4\ub984)\n/// - \uac74\uac15 \uad6c\uac04\uc5d0 \ub530\ub978 \ub3d9\uc801 \ub77c\uc778 \uc0c9\uc0c1\n/// - \ubaa9\ud45c\uc120 \ud45c\uc2dc (\uc810\uc120)\n/// - \uc778\ud130\ub799\ud2f0\ube0c \uc120\ud0dd (\ud0ed\ud558\uc5ec \uc0c1\uc138 \uc815\ubcf4 \ud45c\uc2dc)\n/// - \uccb4\uc9c0\ubc29\ub960 \ubcc0\ud654\ub7c9 \ubc43\uc9c0\n/// - \ube48 \uc0c1\ud0dc \ucc98\ub9ac\n/// - \ub77c\uc774\ud2b8/\ub2e4\ud06c \ubaa8\ub4dc \uc790\ub3d9 \ub300\uc751\n/// - \ucee4\uc2a4\ud130\ub9c8\uc774\uc988 \uac00\ub2a5\ud55c \ub192\uc774\n///\n/// \ucc28\ud2b8 \uad6c\uc131 \uc694\uc18c:\n/// - RectangleMark: \uac74\uac15 \uad6c\uac04 \ubc30\uacbd\n/// - LineMark: \uccb4\uc9c0\ubc29\ub960 \ud2b8\ub80c\ub4dc \ub77c\uc778\n/// - PointMark: \ub370\uc774\ud130 \ud3ec\uc778\ud2b8 \ud45c\uc2dc\n/// - AreaMark: \ub77c\uc778 \uc544\ub798 \uc601\uc5ed \ucc44\uc6b0\uae30\n/// - RuleMark: \ubaa9\ud45c\uc120 \ubc0f \uc120\ud0dd \uc778\ub514\ucf00\uc774\ud130\n///\n/// \uac74\uac15 \uad6c\uac04 (\ub0a8\uc131):\n/// - \ud544\uc218 \uc9c0\ubc29: 0-6% (\ud30c\ub791)\n/// - \uc6b4\ub3d9\uc120\uc218: 6-14% (\ucd08\ub85d)\n/// - \ud53c\ud2b8\ub2c8\uc2a4: 14-18% (\ubbfc\ud2b8)\n/// - \ud3c9\uade0: 18-25% (\ub178\ub791)\n/// - \ube44\ub9cc: 25%+ (\uc8fc\ud669)\n///\n/// \uac74\uac15 \uad6c\uac04 (\uc5ec\uc131):\n/// - \ud544\uc218 \uc9c0\ubc29: 0-14% (\ud30c\ub791)\n/// - \uc6b4\ub3d9\uc120\uc218: 14-21% (\ucd08\ub85d)\n/// - \ud53c\ud2b8\ub2c8\uc2a4: 21-25% (\ubbfc\ud2b8)\n/// - \ud3c9\uade0: 25-32% (\ub178\ub791)\n/// - \ube44\ub9cc: 32%+ (\uc8fc\ud669)\n///\n/// \uc778\ud130\ub799\uc158 \uae30\ub2a5:\n/// - \ub370\uc774\ud130 \ud3ec\uc778\ud2b8 \ud0ed\ud558\uc5ec \uc120\ud0dd\n/// - \uc120\ud0dd\ud55c \ud3ec\uc778\ud2b8\uc758 \uc0c1\uc138 \uc815\ubcf4 \ud45c\uc2dc (\uccb4\uc9c0\ubc29\ub960, \uccb4\uc911, \uadfc\uc721\ub7c9, \uac74\uac15 \uad6c\uac04, BMR, TDEE)\n/// - \uc120\ud0dd \ud574\uc81c \ubc84\ud2bc\n///\n/// \ud83d\udca1 Android \ube44\uad50:\n/// - Android: MPAndroidChart LineChart + LimitLines\n/// - SwiftUI: Swift Charts LineMark + RectangleMark\n/// - Android: LineDataSet + custom colors\n/// - SwiftUI: ForEach + dynamic colors (\uc120\uc5b8\uc801)\n/// - Android: setOnChartValueSelectedListener\n/// - SwiftUI: @State + chartXSelection\n///\n/// \uc131\ub2a5 \ucd5c\uc801\ud654:\n/// - \ucd5c\ub300 90\uc77c \ub370\uc774\ud130 \uad8c\uc7a5 (TrendPeriod.quarter)\n/// - \uac74\uac15 \uad6c\uac04 \ud45c\uc2dc\ub294 \uc120\ud0dd\uc801 (showHealthZones)\n/// - \uc778\ud130\ub799\uc158 \ube44\ud65c\uc131\ud654 \uc2dc \ub354 \uac00\ubccd\uac8c \ub80c\ub354\ub9c1\n/// - \ub0a0\uc9dc\uc21c \uc815\ub82c\ub41c \ub370\uc774\ud130 \uc0ac\uc6a9 (Use Case\uc5d0\uc11c \ucc98\ub9ac)\n///\n",
        "last_modified": "2026-01-13T19:18:50.335261"
      },
      "task_intent": {
        "title": "Body Composition Tracking with BMR/TDEE",
        "description": "Complete body composition logging system including height, weight, body fat percentage, muscle mass, with automatic BMR (Mifflin-St Jeor) and TDEE calculations. Visualize changes over time with Swift Charts graphs showing trends and goal progress.",
        "from_plan": true
      },
      "commits_behind_main": 1,
      "status": "active",
      "merged_at": null
    }
  },
  "created_at": "2026-01-13T07:43:04.650090",
  "last_updated": "2026-01-13T07:46:22.896700"
}