{
  "file_path": "BodiiTests/Mocks/MockUSDAFoodAPIService.swift",
  "main_branch_history": [],
  "task_views": {
    "005-korean-food-database-integration": {
      "task_id": "005-korean-food-database-integration",
      "branch_point": {
        "commit_hash": "c44bfbcd7c1699b176a8bb155e8c35f43ebd4ad9",
        "content": "",
        "timestamp": "2026-01-13T07:46:23.878686"
      },
      "worktree_state": {
        "content": "//\n//  MockUSDAFoodAPIService.swift\n//  BodiiTests\n//\n//  Created by Auto-Claude on 2026-01-13.\n//\n\n// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Mock Objects for Unit Testing\n// \ud14c\uc2a4\ud2b8\uc5d0\uc11c \uc2e4\uc81c API \ud638\ucd9c \uc5c6\uc774 \ub3d9\uc791\uc744 \uac80\uc99d\ud560 \uc218 \uc788\ub294 Mock \uac1d\uccb4\n// \ud83d\udca1 Java \ube44\uad50: Mockito\uc758 @Mock \uc5b4\ub178\ud14c\uc774\uc158\uacfc \uc720\uc0ac\ud55c \uc5ed\ud560\n\nimport Foundation\n@testable import Bodii\n\n/// \ud14c\uc2a4\ud2b8\uc6a9 Mock USDA API \uc11c\ube44\uc2a4\n///\n/// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Configurable Mock Service\n/// \uc2e4\uc81c \ub124\ud2b8\uc6cc\ud06c \ud638\ucd9c \uc5c6\uc774 \ub2e4\uc591\ud55c \uc2dc\ub098\ub9ac\uc624\ub97c \ud14c\uc2a4\ud2b8\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4\n/// - Success/Failure \uc2dc\ub098\ub9ac\uc624\n/// - Network delay \uc2dc\ubbac\ub808\uc774\uc158\n/// - \ub2e4\uc591\ud55c \uc751\ub2f5 \ub370\uc774\ud130 \uc124\uc815\n/// \ud83d\udca1 Java \ube44\uad50: Mockito.when().thenReturn() \ud328\ud134\n///\n/// **\uc8fc\uc694 \uae30\ub2a5:**\n/// - \uc124\uc815 \uac00\ub2a5\ud55c Mock \uc751\ub2f5\n/// - \uc5d0\ub7ec \uc2dc\ub098\ub9ac\uc624 \uc2dc\ubbac\ub808\uc774\uc158\n/// - \ub124\ud2b8\uc6cc\ud06c \uc9c0\uc5f0 \uc2dc\ubbac\ub808\uc774\uc158\n/// - \ud638\ucd9c \ud69f\uc218 \ucd94\uc801\n///\n/// **\uc0ac\uc6a9 \uc608\uc2dc:**\n/// ```swift\n/// let mockService = MockUSDAFoodAPIService()\n///\n/// // Success \uc2dc\ub098\ub9ac\uc624\n/// mockService.mockSearchResponse = USDASearchResponseDTO(...)\n/// let result = try await mockService.searchFoods(query: \"apple\")\n///\n/// // Failure \uc2dc\ub098\ub9ac\uc624\n/// mockService.shouldThrowError = NetworkError.timeout\n/// do {\n///     _ = try await mockService.searchFoods(query: \"apple\")\n/// } catch {\n///     // \uc5d0\ub7ec \ucc98\ub9ac \ud14c\uc2a4\ud2b8\n/// }\n///\n/// // Network delay \uc2dc\ubbac\ub808\uc774\uc158\n/// mockService.simulatedDelay = 2.0  // 2\ucd08 \uc9c0\uc5f0\n/// let result = try await mockService.searchFoods(query: \"apple\")\n/// ```\nfinal class MockUSDAFoodAPIService {\n\n    // MARK: - Mock Configuration\n\n    /// Mock \uac80\uc0c9 \uc751\ub2f5 \ub370\uc774\ud130\n    ///\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Configurable Response\n    /// \ud14c\uc2a4\ud2b8\ub9c8\ub2e4 \ub2e4\ub978 \uc751\ub2f5 \ub370\uc774\ud130\ub97c \uc124\uc815\ud560 \uc218 \uc788\uc74c\n    var mockSearchResponse: USDASearchResponseDTO?\n\n    /// Mock \uc0c1\uc138 \uc815\ubcf4\n    ///\n    /// getFoodDetail() \ud638\ucd9c \uc2dc \ubc18\ud658\ud560 \ub370\uc774\ud130\n    var mockFoodDetail: USDAFoodDTO?\n\n    /// Mock \uc77c\uad04 \uc870\ud68c \uc751\ub2f5\n    ///\n    /// getFoods() \ud638\ucd9c \uc2dc \ubc18\ud658\ud560 \ub370\uc774\ud130\n    var mockFoods: [USDAFoodDTO]?\n\n    /// \uc5d0\ub7ec \uc2dc\ubbac\ub808\uc774\uc158\n    ///\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Error Simulation\n    /// nil\uc774 \uc544\ub2cc \uacbd\uc6b0 \ud56d\uc0c1 \ud574\ub2f9 \uc5d0\ub7ec\ub97c throw\n    /// \ud83d\udca1 Java \ube44\uad50: Mockito.when().thenThrow()\n    var shouldThrowError: Error?\n\n    /// \ub124\ud2b8\uc6cc\ud06c \uc9c0\uc5f0 \uc2dc\ubbac\ub808\uc774\uc158 (\ucd08)\n    ///\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Network Delay Simulation\n    /// \uc2e4\uc81c \ub124\ud2b8\uc6cc\ud06c \uc9c0\uc5f0\uc744 \uc2dc\ubbac\ub808\uc774\uc158\ud558\uc5ec timeout, race condition \ub4f1 \ud14c\uc2a4\ud2b8\n    /// \ud83d\udca1 0.0 = \uc9c0\uc5f0 \uc5c6\uc74c, 1.0 = 1\ucd08 \uc9c0\uc5f0\n    var simulatedDelay: TimeInterval = 0.0\n\n    // MARK: - Call Tracking\n\n    /// \ud638\ucd9c \ud69f\uc218 \ucd94\uc801: searchFoods()\n    ///\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Call Tracking\n    /// \uba54\uc11c\ub4dc\uac00 \uba87 \ubc88 \ud638\ucd9c\ub418\uc5c8\ub294\uc9c0 \ucd94\uc801\ud558\uc5ec \ud14c\uc2a4\ud2b8 \uac80\uc99d\n    /// \ud83d\udca1 Java \ube44\uad50: Mockito.verify(mock, times(n))\n    var searchFoodsCallCount = 0\n\n    /// \ud638\ucd9c \ud69f\uc218 \ucd94\uc801: getFoodDetail()\n    var getFoodDetailCallCount = 0\n\n    /// \ud638\ucd9c \ud69f\uc218 \ucd94\uc801: getFoods()\n    var getFoodsCallCount = 0\n\n    /// \ub9c8\uc9c0\ub9c9 \uac80\uc0c9 \ucffc\ub9ac\n    ///\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Argument Capture\n    /// \uba54\uc11c\ub4dc \ud638\ucd9c \uc2dc \uc804\ub2ec\ub41c \uc778\uc790\ub97c \ucea1\ucc98\ud558\uc5ec \uac80\uc99d\n    /// \ud83d\udca1 Java \ube44\uad50: ArgumentCaptor\n    var lastSearchQuery: String?\n\n    /// \ub9c8\uc9c0\ub9c9 \uac80\uc0c9 \ud398\uc774\uc9c0 \uc815\ubcf4\n    var lastPageSize: Int?\n    var lastPageNumber: Int?\n    var lastDataType: [String]?\n\n    /// \ub9c8\uc9c0\ub9c9 \uc870\ud68c\ud55c FDC ID\n    var lastFdcId: String?\n\n    /// \ub9c8\uc9c0\ub9c9 \uc77c\uad04 \uc870\ud68c\ud55c FDC ID \ubaa9\ub85d\n    var lastFdcIds: [String]?\n\n    // MARK: - Mock Methods\n\n    /// \uc2dd\ud488\uba85\uc73c\ub85c \uac80\uc0c9 (Mock)\n    ///\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Mock Implementation\n    /// \uc2e4\uc81c API \ud638\ucd9c \ub300\uc2e0 \ubbf8\ub9ac \uc124\uc815\ub41c \uc751\ub2f5 \ubc18\ud658\n    ///\n    /// - Parameters:\n    ///   - query: \uac80\uc0c9\uc5b4\n    ///   - pageSize: \ud398\uc774\uc9c0 \ud06c\uae30\n    ///   - pageNumber: \ud398\uc774\uc9c0 \ubc88\ud638\n    ///   - dataType: \ub370\uc774\ud130 \ud0c0\uc785 \ud544\ud130\n    ///\n    /// - Returns: Mock \uac80\uc0c9 \uc751\ub2f5\n    ///\n    /// - Throws:\n    ///   - shouldThrowError\uac00 \uc124\uc815\ub41c \uacbd\uc6b0 \ud574\ub2f9 \uc5d0\ub7ec\n    ///   - mockSearchResponse\uac00 nil\uc778 \uacbd\uc6b0 USDAAPIError.noData\n    func searchFoods(\n        query: String,\n        pageSize: Int = Constants.API.USDA.defaultPageSize,\n        pageNumber: Int = 1,\n        dataType: [String]? = nil\n    ) async throws -> USDASearchResponseDTO {\n\n        // \ud638\ucd9c \ucd94\uc801\n        searchFoodsCallCount += 1\n        lastSearchQuery = query\n        lastPageSize = pageSize\n        lastPageNumber = pageNumber\n        lastDataType = dataType\n\n        // \ub124\ud2b8\uc6cc\ud06c \uc9c0\uc5f0 \uc2dc\ubbac\ub808\uc774\uc158\n        if simulatedDelay > 0 {\n            try await Task.sleep(nanoseconds: UInt64(simulatedDelay * 1_000_000_000))\n        }\n\n        // \uc5d0\ub7ec \uc2dc\ubbac\ub808\uc774\uc158\n        if let error = shouldThrowError {\n            throw error\n        }\n\n        // Mock \uc751\ub2f5 \ubc18\ud658\n        guard let response = mockSearchResponse else {\n            throw USDAAPIError.noData\n        }\n\n        return response\n    }\n\n    /// \uc2dd\ud488 \uc0c1\uc138 \uc870\ud68c (Mock)\n    ///\n    /// - Parameter fdcId: FDC ID\n    ///\n    /// - Returns: Mock \uc2dd\ud488 \uc0c1\uc138 \uc815\ubcf4\n    ///\n    /// - Throws:\n    ///   - shouldThrowError\uac00 \uc124\uc815\ub41c \uacbd\uc6b0 \ud574\ub2f9 \uc5d0\ub7ec\n    ///   - mockFoodDetail\uc774 nil\uc778 \uacbd\uc6b0 USDAAPIError.notFound\n    func getFoodDetail(fdcId: String) async throws -> USDAFoodDTO {\n\n        // \ud638\ucd9c \ucd94\uc801\n        getFoodDetailCallCount += 1\n        lastFdcId = fdcId\n\n        // \ub124\ud2b8\uc6cc\ud06c \uc9c0\uc5f0 \uc2dc\ubbac\ub808\uc774\uc158\n        if simulatedDelay > 0 {\n            try await Task.sleep(nanoseconds: UInt64(simulatedDelay * 1_000_000_000))\n        }\n\n        // \uc5d0\ub7ec \uc2dc\ubbac\ub808\uc774\uc158\n        if let error = shouldThrowError {\n            throw error\n        }\n\n        // Mock \ub370\uc774\ud130 \ubc18\ud658\n        guard let detail = mockFoodDetail else {\n            throw USDAAPIError.notFound\n        }\n\n        return detail\n    }\n\n    /// \uc2dd\ud488 \uc77c\uad04 \uc870\ud68c (Mock)\n    ///\n    /// - Parameter fdcIds: FDC ID \ubaa9\ub85d\n    ///\n    /// - Returns: Mock \uc2dd\ud488 \ubaa9\ub85d\n    ///\n    /// - Throws:\n    ///   - shouldThrowError\uac00 \uc124\uc815\ub41c \uacbd\uc6b0 \ud574\ub2f9 \uc5d0\ub7ec\n    ///   - mockFoods\uac00 nil\uc778 \uacbd\uc6b0 USDAAPIError.noData\n    func getFoods(fdcIds: [String]) async throws -> [USDAFoodDTO] {\n\n        // \ud638\ucd9c \ucd94\uc801\n        getFoodsCallCount += 1\n        lastFdcIds = fdcIds\n\n        // \ub124\ud2b8\uc6cc\ud06c \uc9c0\uc5f0 \uc2dc\ubbac\ub808\uc774\uc158\n        if simulatedDelay > 0 {\n            try await Task.sleep(nanoseconds: UInt64(simulatedDelay * 1_000_000_000))\n        }\n\n        // \uc5d0\ub7ec \uc2dc\ubbac\ub808\uc774\uc158\n        if let error = shouldThrowError {\n            throw error\n        }\n\n        // Mock \ub370\uc774\ud130 \ubc18\ud658\n        guard let foods = mockFoods else {\n            throw USDAAPIError.noData\n        }\n\n        return foods\n    }\n\n    // MARK: - Test Helpers\n\n    /// Mock \uc0c1\ud0dc \ucd08\uae30\ud654\n    ///\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Test Setup/Teardown\n    /// \uac01 \ud14c\uc2a4\ud2b8 \uc804\ud6c4\uc5d0 \ud638\ucd9c\ud558\uc5ec Mock \uc0c1\ud0dc\ub97c \uae68\ub057\ud558\uac8c \uc720\uc9c0\n    /// \ud83d\udca1 Java \ube44\uad50: @Before, @After \uc5b4\ub178\ud14c\uc774\uc158\n    ///\n    /// **\uc0ac\uc6a9 \uc608\uc2dc:**\n    /// ```swift\n    /// class MyTests: XCTestCase {\n    ///     var mockService: MockUSDAFoodAPIService!\n    ///\n    ///     override func setUp() {\n    ///         super.setUp()\n    ///         mockService = MockUSDAFoodAPIService()\n    ///     }\n    ///\n    ///     override func tearDown() {\n    ///         mockService.reset()\n    ///         super.tearDown()\n    ///     }\n    /// }\n    /// ```\n    func reset() {\n        mockSearchResponse = nil\n        mockFoodDetail = nil\n        mockFoods = nil\n        shouldThrowError = nil\n        simulatedDelay = 0.0\n        searchFoodsCallCount = 0\n        getFoodDetailCallCount = 0\n        getFoodsCallCount = 0\n        lastSearchQuery = nil\n        lastPageSize = nil\n        lastPageNumber = nil\n        lastDataType = nil\n        lastFdcId = nil\n        lastFdcIds = nil\n    }\n\n    /// Sample \uac80\uc0c9 \uc751\ub2f5 \uc0dd\uc131 (\ud14c\uc2a4\ud2b8 \ud5ec\ud37c)\n    ///\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Test Data Builder\n    /// \ud14c\uc2a4\ud2b8\uc6a9 \uc0d8\ud50c \ub370\uc774\ud130\ub97c \uc27d\uac8c \uc0dd\uc131\n    /// \ud83d\udca1 Java \ube44\uad50: Builder \ud328\ud134 \ub610\ub294 ObjectMother \ud328\ud134\n    ///\n    /// - Parameters:\n    ///   - foods: \uc2dd\ud488 \ubaa9\ub85d\n    ///   - totalHits: \uc804\uccb4 \uac1c\uc218\n    ///\n    /// - Returns: \uc0d8\ud50c USDASearchResponseDTO\n    static func createSampleSearchResponse(\n        foods: [USDAFoodDTO],\n        totalHits: Int? = nil\n    ) -> USDASearchResponseDTO {\n        let total = totalHits ?? foods.count\n\n        return USDASearchResponseDTO(\n            totalHits: total,\n            currentPage: 1,\n            totalPages: (total + 19) / 20,\n            foods: foods\n        )\n    }\n\n    /// Sample \uc2dd\ud488 DTO \uc0dd\uc131 (\ud14c\uc2a4\ud2b8 \ud5ec\ud37c)\n    ///\n    /// - Parameters:\n    ///   - fdcId: FDC ID\n    ///   - description: \uc2dd\ud488\uba85\n    ///   - calories: \uce7c\ub85c\ub9ac\n    ///\n    /// - Returns: \uc0d8\ud50c USDAFoodDTO\n    static func createSampleFood(\n        fdcId: Int = 123456,\n        description: String = \"Apple, raw\",\n        calories: Double = 52.0\n    ) -> USDAFoodDTO {\n        let nutrients: [USDANutrientDTO] = [\n            // \uce7c\ub85c\ub9ac (Energy)\n            USDANutrientDTO(\n                nutrientId: USDANutrientID.energy,\n                nutrientName: \"Energy\",\n                nutrientNumber: \"208\",\n                unitName: \"kcal\",\n                value: calories\n            ),\n            // \ub2e8\ubc31\uc9c8 (Protein)\n            USDANutrientDTO(\n                nutrientId: USDANutrientID.protein,\n                nutrientName: \"Protein\",\n                nutrientNumber: \"203\",\n                unitName: \"g\",\n                value: 0.3\n            ),\n            // \uc9c0\ubc29 (Fat)\n            USDANutrientDTO(\n                nutrientId: USDANutrientID.fat,\n                nutrientName: \"Total lipid (fat)\",\n                nutrientNumber: \"204\",\n                unitName: \"g\",\n                value: 0.2\n            ),\n            // \ud0c4\uc218\ud654\ubb3c (Carbohydrate)\n            USDANutrientDTO(\n                nutrientId: USDANutrientID.carbohydrate,\n                nutrientName: \"Carbohydrate, by difference\",\n                nutrientNumber: \"205\",\n                unitName: \"g\",\n                value: 13.8\n            ),\n            // \ub098\ud2b8\ub968 (Sodium)\n            USDANutrientDTO(\n                nutrientId: USDANutrientID.sodium,\n                nutrientName: \"Sodium, Na\",\n                nutrientNumber: \"307\",\n                unitName: \"mg\",\n                value: 1.0\n            )\n        ]\n\n        return USDAFoodDTO(\n            fdcId: fdcId,\n            description: description,\n            dataType: \"Foundation\",\n            foodNutrients: nutrients,\n            servingSize: 100.0,\n            servingSizeUnit: \"g\"\n        )\n    }\n}\n",
        "last_modified": "2026-01-14T22:55:39.270454"
      },
      "task_intent": {
        "title": "005-korean-food-database-integration",
        "description": "Integrate Korean Food & Drug Administration (\uc2dd\uc57d\ucc98) food nutrition database API as primary source, with USDA FoodData Central as fallback for international foods. Prioritize Korean dishes (kimchi jjigae, bibimbap, tteokbokki) that are poorly covered by competitors.",
        "from_plan": true
      },
      "commits_behind_main": 0,
      "status": "active",
      "merged_at": null
    }
  },
  "created_at": "2026-01-13T07:43:31.821568",
  "last_updated": "2026-01-13T07:46:24.036212"
}