{
  "file_path": "Bodii/Presentation/Features/Sleep/SleepTabView.swift",
  "main_branch_history": [],
  "task_views": {
    "009-sleep-tracking-with-5-status-system": {
      "task_id": "009-sleep-tracking-with-5-status-system",
      "branch_point": {
        "commit_hash": "4e56d606f7b0d4cb74120dd392544f3fe2d4f5b4",
        "content": "",
        "timestamp": "2026-01-14T21:03:40.462795"
      },
      "worktree_state": {
        "content": "//\n//  SleepTabView.swift\n//  Bodii\n//\n//  Created by Auto-Claude on 2026-01-14.\n//\n\n// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Container View with Segmented Control\n// \uc218\uba74 \uae30\ub2a5 \ucee8\ud14c\uc774\ub108 \ubdf0 - History\uc640 Trends \uc804\ud658\n// \ud83d\udca1 Java \ube44\uad50: Android\uc758 ViewPager + TabLayout\uacfc \uc720\uc0ac\n\nimport SwiftUI\n\n// MARK: - SleepTabView\n\n/// \uc218\uba74 \uae30\ub2a5 \uba54\uc778 \ucee8\ud14c\uc774\ub108 \ubdf0\n/// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Container View Pattern\n/// - Segmented control\ub85c History/Trends \uc804\ud658\n/// - \uac01 \ud0ed\uc5d0 \ud574\ub2f9\ud558\ub294 View \ud45c\uc2dc\n/// - \uc218\uba74 \uae30\ub85d \ucd94\uac00 \uae30\ub2a5\n/// \ud83d\udca1 Java \ube44\uad50: Android\uc758 Fragment Container + TabLayout\uacfc \uc720\uc0ac\nstruct SleepTabView: View {\n\n    // MARK: - Tab Selection\n\n    /// \ud0ed \uc120\ud0dd \uc0c1\ud0dc\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Enum for Tab State\n    /// - \ud0c0\uc785 \uc548\uc804\ud55c \ud0ed \uad6c\ubd84\n    enum Tab: String, CaseIterable {\n        case history = \"\uae30\ub85d\"\n        case trends = \"\ud2b8\ub80c\ub4dc\"\n    }\n\n    // MARK: - Properties\n\n    /// DIContainer for dependency injection\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Dependency Injection\n    /// - ViewModel \uc0dd\uc131\uc744 \uc704\ud55c \ud329\ud1a0\ub9ac\n    /// \ud83d\udca1 Java \ube44\uad50: Dagger/Hilt\uc758 Component\uc640 \uc720\uc0ac\n    let container: DIContainer\n\n    /// \ud604\uc7ac \uc120\ud0dd\ub41c \ud0ed\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: @State for Tab Selection\n    /// - \ud0ed \uc804\ud658 \uc0c1\ud0dc \uad00\ub9ac\n    @State private var selectedTab: Tab = .history\n\n    /// \uc218\uba74 \uc785\ub825 \uc2dc\ud2b8 \ud45c\uc2dc \uc5ec\ubd80\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Sheet Presentation State\n    /// - true\uc77c \ub54c SleepInputSheet \ud45c\uc2dc\n    @State private var showInputSheet = false\n\n    // Lazy ViewModels for each tab\n    // \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Lazy Initialization\n    // - \uac01 \ud0ed\uc758 ViewModel\uc744 \ud544\uc694\ud560 \ub54c\ub9cc \uc0dd\uc131\n    @State private var historyViewModel: SleepHistoryViewModel?\n    @State private var trendsViewModel: SleepTrendsViewModel?\n\n    // MARK: - Initialization\n\n    /// SleepTabView \ucd08\uae30\ud654\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Default Parameter\n    /// - DIContainer \uae30\ubcf8\uac12 \uc81c\uacf5\uc73c\ub85c \ud3b8\ub9ac\ud55c \uc0ac\uc6a9\n    /// \ud83d\udca1 Java \ube44\uad50: \uc624\ubc84\ub85c\ub529\ub41c \uc0dd\uc131\uc790\uc640 \uc720\uc0ac\n    ///\n    /// - Parameter container: DIContainer (\uae30\ubcf8\uac12: .shared)\n    init(container: DIContainer = .shared) {\n        self.container = container\n    }\n\n    // MARK: - Body\n\n    var body: some View {\n        // \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: NavigationStack\n        // iOS 16+\uc758 \uc0c8\ub85c\uc6b4 \ub124\ube44\uac8c\uc774\uc158 \uc2dc\uc2a4\ud15c\n        // \ud83d\udca1 Java \ube44\uad50: Navigation Component\uc640 \uc720\uc0ac\n        NavigationStack {\n            VStack(spacing: 0) {\n                // \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Segmented Picker\n                // iOS \uc2a4\ud0c0\uc77c \uc138\uadf8\uba3c\ud2b8 \ucee8\ud2b8\ub864\ub85c \ud0ed \uc804\ud658\n                Picker(\"\ubcf4\uae30 \ubaa8\ub4dc\", selection: $selectedTab) {\n                    ForEach(Tab.allCases, id: \\.self) { tab in\n                        Text(tab.rawValue).tag(tab)\n                    }\n                }\n                .pickerStyle(.segmented)\n                .padding(.horizontal, 16)\n                .padding(.top, 8)\n                .padding(.bottom, 12)\n\n                // \uad6c\ubd84\uc120\n                Divider()\n\n                // \uc120\ud0dd\ub41c \ud0ed\uc758 \ucf58\ud150\uce20 \ud45c\uc2dc\n                // \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Dynamic Content Switching\n                // selectedTab\uc5d0 \ub530\ub77c \ub2e4\ub978 \ubdf0 \ud45c\uc2dc\n                selectedView\n                    .frame(maxWidth: .infinity, maxHeight: .infinity)\n            }\n            .navigationTitle(\"\uc218\uba74\")\n            .navigationBarTitleDisplayMode(.large)\n            .toolbar {\n                ToolbarItem(placement: .navigationBarTrailing) {\n                    addButton\n                }\n            }\n            // \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Sheet for Input\n            // \uc218\uba74 \uae30\ub85d \ucd94\uac00 \uc2dc\ud2b8\n            .sheet(isPresented: $showInputSheet) {\n                SleepInputSheet(\n                    viewModel: container.makeSleepInputViewModel(),\n                    canSkip: true,\n                    onSkip: nil\n                )\n            }\n            .onAppear {\n                // \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Lazy ViewModel Initialization\n                // \uccab \ub4f1\uc7a5 \uc2dc ViewModel \uc0dd\uc131\n                initializeViewModelsIfNeeded()\n            }\n        }\n    }\n\n    // MARK: - Subviews\n\n    /// \uc120\ud0dd\ub41c \ud0ed\uc5d0 \ub530\ub77c \ud45c\uc2dc\ud560 \ubdf0\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: @ViewBuilder\n    /// - \uc870\uac74\uc5d0 \ub530\ub77c \ub2e4\ub978 View \ubc18\ud658\n    /// - switch/if \ubb38 \uc0ac\uc6a9 \uac00\ub2a5\n    /// \ud83d\udca1 Java \ube44\uad50: Factory pattern\uacfc \uc720\uc0ac\n    @ViewBuilder\n    private var selectedView: some View {\n        switch selectedTab {\n        case .history:\n            // \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: History Content View\n            // SleepHistoryView\uc758 \ucf58\ud150\uce20\ub97c \uc784\ubca0\ub4dc\n            // NavigationStack \uc911\ubcf5\uc744 \ud53c\ud558\uae30 \uc704\ud574 \uc9c1\uc811 \uad6c\uc131\n            if let historyViewModel = historyViewModel {\n                SleepHistoryContentView(\n                    viewModel: historyViewModel,\n                    container: container\n                )\n            } else {\n                // \ub85c\ub529 \ud50c\ub808\uc774\uc2a4\ud640\ub354\n                ProgressView()\n                    .frame(maxWidth: .infinity, maxHeight: .infinity)\n            }\n\n        case .trends:\n            // \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Trends Content View\n            // SleepTrendsView\uc758 \ucf58\ud150\uce20\ub97c \uc784\ubca0\ub4dc\n            if let trendsViewModel = trendsViewModel {\n                SleepTrendsContentView(\n                    viewModel: trendsViewModel\n                )\n            } else {\n                // \ub85c\ub529 \ud50c\ub808\uc774\uc2a4\ud640\ub354\n                ProgressView()\n                    .frame(maxWidth: .infinity, maxHeight: .infinity)\n            }\n        }\n    }\n\n    /// \ucd94\uac00 \ubc84\ud2bc\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Toolbar Button\n    /// - \uc218\uba74 \uae30\ub85d \ucd94\uac00 \uc2dc\ud2b8 \uc5f4\uae30\n    private var addButton: some View {\n        Button(action: {\n            showInputSheet = true\n        }) {\n            Image(systemName: \"plus.circle.fill\")\n                .font(.title3)\n                .foregroundStyle(.blue)\n        }\n    }\n\n    // MARK: - Helper Methods\n\n    /// ViewModel \ucd08\uae30\ud654 (\ud544\uc694\ud55c \uacbd\uc6b0\uc5d0\ub9cc)\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Lazy Initialization Pattern\n    /// - \ucc98\uc74c \uc811\uadfc \uc2dc\uc5d0\ub9cc ViewModel \uc0dd\uc131\n    /// - \uba54\ubaa8\ub9ac \ud6a8\uc728\uc131 \ud5a5\uc0c1\n    private func initializeViewModelsIfNeeded() {\n        if historyViewModel == nil {\n            historyViewModel = container.makeSleepHistoryViewModel()\n        }\n        if trendsViewModel == nil {\n            trendsViewModel = container.makeSleepTrendsViewModel()\n        }\n    }\n}\n\n// MARK: - SleepHistoryContentView\n\n/// SleepHistoryView\uc758 \ucf58\ud150\uce20 (NavigationStack \uc81c\uc678)\n/// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Content Extraction Pattern\n/// - \uae30\uc874 View\uc5d0\uc11c \ucf58\ud150\uce20\ub9cc \ucd94\ucd9c\ud558\uc5ec \uc7ac\uc0ac\uc6a9\n/// - NavigationStack \uc911\ubcf5 \ubc29\uc9c0\nfileprivate struct SleepHistoryContentView: View {\n\n    @ObservedObject var viewModel: SleepHistoryViewModel\n    let container: DIContainer\n\n    @State private var showAddSheet: Bool = false\n\n    var body: some View {\n        ZStack {\n            // \uba54\uc778 \ucf58\ud150\uce20\n            if viewModel.isLoading && viewModel.isEmpty {\n                loadingView\n            } else if viewModel.isEmpty {\n                emptyStateView\n            } else {\n                listView\n            }\n        }\n        // \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: refreshable modifier\n        // Pull-to-refresh \uad6c\ud604\n        .refreshable {\n            await viewModel.refresh()\n        }\n        // \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Sheet for Editing Record\n        // \ub808\ucf54\ub4dc \ud3b8\uc9d1 \uc2dc\ud2b8\n        .sheet(item: $viewModel.recordToEdit) { record in\n            SleepInputSheet(\n                viewModel: container.makeSleepInputViewModel(\n                    defaultHours: Int(record.duration / 60),\n                    defaultMinutes: Int(record.duration % 60)\n                ),\n                canSkip: true,\n                onSkip: nil\n            )\n        }\n        // \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Confirmation Dialog\n        // \uc0ad\uc81c \ud655\uc778 \ub300\ud654\uc0c1\uc790\n        .confirmationDialog(\n            \"\uc218\uba74 \uae30\ub85d\uc744 \uc0ad\uc81c\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?\",\n            isPresented: $viewModel.showDeleteConfirmation,\n            titleVisibility: .visible\n        ) {\n            Button(\"\uc0ad\uc81c\", role: .destructive) {\n                Task {\n                    await viewModel.deleteRecord()\n                }\n            }\n            Button(\"\ucde8\uc18c\", role: .cancel) {\n                viewModel.cancelDelete()\n            }\n        } message: {\n            Text(\"\uc0ad\uc81c\ub41c \ub370\uc774\ud130\ub294 \ubcf5\uad6c\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.\")\n        }\n        // \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Alert for Errors\n        // \uc5d0\ub7ec \ubc1c\uc0dd \uc2dc \uc54c\ub9bc \ud45c\uc2dc\n        .alert(\"\uc624\ub958\", isPresented: .constant(viewModel.errorMessage != nil)) {\n            Button(\"\ud655\uc778\") {\n                viewModel.clearError()\n            }\n        } message: {\n            if let errorMessage = viewModel.errorMessage {\n                Text(errorMessage)\n            }\n        }\n        // \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Toast for Success\n        // \uc131\uacf5 \uba54\uc2dc\uc9c0 \ud45c\uc2dc\n        .overlay(alignment: .top) {\n            if let successMessage = viewModel.successMessage {\n                successToast(message: successMessage)\n                    .padding(.top, 60)\n            }\n        }\n    }\n\n    /// \ub9ac\uc2a4\ud2b8 \ubdf0\n    private var listView: some View {\n        List {\n            // \ud1b5\uacc4 \uc139\uc158\n            statisticsSection\n\n            // \ub808\ucf54\ub4dc \ub9ac\uc2a4\ud2b8 \uc139\uc158\n            recordsSection\n        }\n        .listStyle(.insetGrouped)\n    }\n\n    /// \ud1b5\uacc4 \uc139\uc158\n    private var statisticsSection: some View {\n        Section {\n            VStack(spacing: 12) {\n                // \ud3c9\uade0 \uc218\uba74 \uc2dc\uac04\n                statisticRow(\n                    icon: \"clock.fill\",\n                    title: \"\ud3c9\uade0 \uc218\uba74 \uc2dc\uac04\",\n                    value: viewModel.averageDurationString,\n                    color: .blue\n                )\n\n                Divider()\n\n                // \uac00\uc7a5 \ub9ce\uc740 \uc0c1\ud0dc\n                statisticRow(\n                    icon: \"moon.stars.fill\",\n                    title: \"\uac00\uc7a5 \ub9ce\uc740 \uc0c1\ud0dc\",\n                    value: viewModel.mostCommonStatusString,\n                    color: .orange\n                )\n\n                Divider()\n\n                // \ucd1d \uae30\ub85d \uc218\n                statisticRow(\n                    icon: \"list.bullet\",\n                    title: \"\ucd1d \uae30\ub85d \uc218\",\n                    value: \"\\(viewModel.recordCount)\uac1c\",\n                    color: .green\n                )\n            }\n            .padding(.vertical, 8)\n        } header: {\n            HStack {\n                Text(\"\ud1b5\uacc4 \uc694\uc57d\")\n                Spacer()\n                queryModeMenu\n            }\n        }\n    }\n\n    /// \uac1c\ubcc4 \ud1b5\uacc4 Row\n    private func statisticRow(\n        icon: String,\n        title: String,\n        value: String,\n        color: Color\n    ) -> some View {\n        HStack(spacing: 12) {\n            Image(systemName: icon)\n                .font(.title3)\n                .foregroundStyle(color)\n                .frame(width: 32)\n\n            Text(title)\n                .font(.subheadline)\n                .foregroundStyle(.secondary)\n\n            Spacer()\n\n            Text(value)\n                .font(.body)\n                .fontWeight(.semibold)\n                .foregroundStyle(.primary)\n        }\n    }\n\n    /// \ub808\ucf54\ub4dc \ub9ac\uc2a4\ud2b8 \uc139\uc158\n    private var recordsSection: some View {\n        Section {\n            ForEach(viewModel.records) { record in\n                SleepRecordRow(record: record)\n                    .contentShape(Rectangle())\n                    .onTapGesture {\n                        viewModel.editRecord(record)\n                    }\n                    .swipeActions(edge: .leading) {\n                        Button {\n                            viewModel.editRecord(record)\n                        } label: {\n                            Label(\"\ud3b8\uc9d1\", systemImage: \"pencil\")\n                        }\n                        .tint(.blue)\n                    }\n                    .swipeActions(edge: .trailing) {\n                        Button(role: .destructive) {\n                            viewModel.confirmDelete(record: record)\n                        } label: {\n                            Label(\"\uc0ad\uc81c\", systemImage: \"trash\")\n                        }\n                    }\n            }\n        } header: {\n            HStack {\n                Text(\"\uc218\uba74 \uae30\ub85d\")\n                Spacer()\n                Text(queryModeDescription)\n                    .font(.caption)\n                    .foregroundStyle(.secondary)\n            }\n        } footer: {\n            if !viewModel.isEmpty {\n                Text(\"\ub808\ucf54\ub4dc\ub97c \ud0ed\ud558\uba74 \ud3b8\uc9d1\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4.\\n\uc2a4\uc640\uc774\ud504\ud558\uc5ec \ud3b8\uc9d1 \ub610\ub294 \uc0ad\uc81c\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4.\")\n                    .font(.caption)\n            }\n        }\n    }\n\n    /// \uc870\ud68c \ubaa8\ub4dc \uc124\uba85\n    private var queryModeDescription: String {\n        switch viewModel.selectedMode {\n        case .all:\n            return \"\uc804\uccb4\"\n        case .recent(let days):\n            return \"\ucd5c\uadfc \\(days)\uc77c\"\n        case .dateRange(let start, let end):\n            let formatter = DateFormatter()\n            formatter.dateStyle = .short\n            formatter.locale = Locale(identifier: \"ko_KR\")\n            return \"\\(formatter.string(from: start)) ~ \\(formatter.string(from: end))\"\n        }\n    }\n\n    /// \uc870\ud68c \ubaa8\ub4dc \uc120\ud0dd \uba54\ub274\n    private var queryModeMenu: some View {\n        Menu {\n            Button {\n                viewModel.changeMode(to: .all)\n            } label: {\n                Label(\"\uc804\uccb4 \uae30\ub85d\", systemImage: \"calendar\")\n            }\n\n            Divider()\n\n            Button {\n                viewModel.changeMode(to: .recent(days: 7))\n            } label: {\n                Label(\"\ucd5c\uadfc 7\uc77c\", systemImage: \"7.circle\")\n            }\n\n            Button {\n                viewModel.changeMode(to: .recent(days: 30))\n            } label: {\n                Label(\"\ucd5c\uadfc 30\uc77c\", systemImage: \"30.circle\")\n            }\n\n            Button {\n                viewModel.changeMode(to: .recent(days: 90))\n            } label: {\n                Label(\"\ucd5c\uadfc 90\uc77c\", systemImage: \"90.circle\")\n            }\n        } label: {\n            Image(systemName: \"line.3.horizontal.decrease.circle\")\n                .font(.caption)\n                .foregroundStyle(.blue)\n        }\n    }\n\n    /// \ube48 \uc0c1\ud0dc \ubdf0\n    private var emptyStateView: some View {\n        VStack(spacing: 24) {\n            Image(systemName: \"moon.zzz\")\n                .font(.system(size: 80))\n                .foregroundStyle(.gray.opacity(0.3))\n\n            VStack(spacing: 12) {\n                Text(\"\uc218\uba74 \uae30\ub85d\uc774 \uc5c6\uc2b5\ub2c8\ub2e4\")\n                    .font(.title2)\n                    .fontWeight(.bold)\n                    .foregroundStyle(.primary)\n\n                Text(\"\uc218\uba74 \uc2dc\uac04\uc744 \uae30\ub85d\ud558\uba74\\n\uc5ec\uae30\uc5d0 \ud45c\uc2dc\ub429\ub2c8\ub2e4.\")\n                    .font(.body)\n                    .foregroundStyle(.secondary)\n                    .multilineTextAlignment(.center)\n            }\n        }\n        .frame(maxWidth: .infinity, maxHeight: .infinity)\n        .padding(.horizontal, 40)\n    }\n\n    /// \ub85c\ub529 \ubdf0\n    private var loadingView: some View {\n        VStack(spacing: 16) {\n            ProgressView()\n                .scaleEffect(1.5)\n\n            Text(\"\uc218\uba74 \uae30\ub85d\uc744 \ubd88\ub7ec\uc624\ub294 \uc911...\")\n                .font(.subheadline)\n                .foregroundStyle(.secondary)\n        }\n        .frame(maxWidth: .infinity, maxHeight: .infinity)\n    }\n\n    /// \uc131\uacf5 \ud1a0\uc2a4\ud2b8\n    private func successToast(message: String) -> some View {\n        HStack(spacing: 12) {\n            Image(systemName: \"checkmark.circle.fill\")\n                .font(.body)\n                .foregroundStyle(.white)\n\n            Text(message)\n                .font(.subheadline)\n                .fontWeight(.medium)\n                .foregroundStyle(.white)\n        }\n        .padding(.horizontal, 20)\n        .padding(.vertical, 12)\n        .background(\n            Capsule()\n                .fill(Color.green)\n                .shadow(color: Color.black.opacity(0.2), radius: 8, x: 0, y: 4)\n        )\n        .transition(.move(edge: .top).combined(with: .opacity))\n        .animation(.spring(), value: viewModel.successMessage != nil)\n        .onAppear {\n            DispatchQueue.main.asyncAfter(deadline: .now() + 2) {\n                viewModel.clearSuccess()\n            }\n        }\n    }\n}\n\n// MARK: - SleepTrendsContentView\n\n/// SleepTrendsView\uc758 \ucf58\ud150\uce20 (NavigationStack \uc81c\uc678)\n/// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Content Extraction Pattern\n/// - \uae30\uc874 View\uc5d0\uc11c \ucf58\ud150\uce20\ub9cc \ucd94\ucd9c\ud558\uc5ec \uc7ac\uc0ac\uc6a9\n/// - NavigationStack \uc911\ubcf5 \ubc29\uc9c0\nfileprivate struct SleepTrendsContentView: View {\n\n    @ObservedObject var viewModel: SleepTrendsViewModel\n\n    var body: some View {\n        ScrollView {\n            VStack(spacing: 20) {\n                // \uae30\uac04 \uc120\ud0dd\uae30\n                periodSelectorSection\n\n                // \ucc28\ud2b8 \uc139\uc158\n                if viewModel.isLoading {\n                    loadingView\n                } else if viewModel.isEmpty {\n                    emptyStateView\n                } else {\n                    // \ud1b5\uacc4 \uc694\uc57d\n                    statisticsSection\n\n                    // \uc218\uba74 \ud2b8\ub80c\ub4dc \ucc28\ud2b8\n                    sleepChartSection\n\n                    // \uc0c1\ud0dc \ubd84\ud3ec\n                    statusDistributionSection\n                }\n            }\n            .padding(.horizontal, 16)\n            .padding(.vertical, 20)\n        }\n        .refreshable {\n            await viewModel.refresh()\n        }\n        .alert(\"\uc624\ub958\", isPresented: .constant(viewModel.errorMessage != nil)) {\n            Button(\"\ud655\uc778\") {\n                viewModel.clearError()\n            }\n        } message: {\n            if let errorMessage = viewModel.errorMessage {\n                Text(errorMessage)\n            }\n        }\n    }\n\n    /// \uae30\uac04 \uc120\ud0dd\uae30 \uc139\uc158\n    private var periodSelectorSection: some View {\n        VStack(spacing: 12) {\n            HStack {\n                Image(systemName: \"calendar\")\n                    .font(.subheadline)\n                    .foregroundStyle(.purple)\n\n                Text(\"\ubd84\uc11d \uae30\uac04\")\n                    .font(.headline)\n                    .fontWeight(.semibold)\n                    .foregroundStyle(.primary)\n\n                Spacer()\n            }\n\n            Picker(\"\uae30\uac04\", selection: $viewModel.selectedPeriod) {\n                Text(\"7\uc77c\").tag(FetchSleepStatsUseCase.StatsPeriod.week)\n                Text(\"30\uc77c\").tag(FetchSleepStatsUseCase.StatsPeriod.month)\n                Text(\"90\uc77c\").tag(FetchSleepStatsUseCase.StatsPeriod.quarter)\n            }\n            .pickerStyle(.segmented)\n        }\n        .padding(16)\n        .background(cardBackground)\n        .cornerRadius(12)\n        .shadow(color: Color.black.opacity(0.05), radius: 8, x: 0, y: 2)\n    }\n\n    /// \ud1b5\uacc4 \uc694\uc57d \uc139\uc158\n    private var statisticsSection: some View {\n        VStack(alignment: .leading, spacing: 12) {\n            sectionHeader(\n                title: \"\ud1b5\uacc4 \uc694\uc57d\",\n                icon: \"chart.bar.fill\"\n            )\n\n            if let output = viewModel.statsOutput {\n                statisticsCard(output: output)\n            }\n        }\n    }\n\n    /// \ud1b5\uacc4 \uce74\ub4dc\n    private func statisticsCard(output: FetchSleepStatsUseCase.Output) -> some View {\n        VStack(spacing: 16) {\n            // \ub370\uc774\ud130 \uae30\uac04\n            HStack {\n                Image(systemName: \"calendar\")\n                    .font(.caption)\n                    .foregroundStyle(.secondary)\n\n                Text(\"\uae30\uac04: \\(formatDate(output.startDate, style: .short)) - \\(formatDate(output.endDate, style: .short))\")\n                    .font(.caption)\n                    .foregroundStyle(.secondary)\n\n                Spacer()\n\n                Text(\"\\(output.count)\uac1c \uae30\ub85d\")\n                    .font(.caption)\n                    .fontWeight(.medium)\n                    .foregroundStyle(.purple)\n            }\n\n            Divider()\n\n            // \ud1b5\uacc4 \uadf8\ub9ac\ub4dc\n            LazyVGrid(columns: [\n                GridItem(.flexible()),\n                GridItem(.flexible())\n            ], spacing: 16) {\n                statisticItem(\n                    title: \"\ud3c9\uade0 \uc218\uba74\",\n                    value: viewModel.averageDurationString,\n                    icon: \"moon.fill\",\n                    color: .purple\n                )\n\n                statisticItem(\n                    title: \"\uac00\uc7a5 \ub9ce\uc740 \uc0c1\ud0dc\",\n                    value: viewModel.mostCommonStatusString,\n                    icon: output.mostCommonStatus?.iconName ?? \"moon.stars\",\n                    color: output.mostCommonStatus?.color ?? .blue\n                )\n\n                statisticItem(\n                    title: \"\uc88b\uc740 \uc218\uba74 \ube44\uc728\",\n                    value: viewModel.goodSleepPercentageString,\n                    icon: \"checkmark.circle.fill\",\n                    color: .green\n                )\n\n                statisticItem(\n                    title: \"\uc77c\uad00\uc131 \uc810\uc218\",\n                    value: viewModel.consistencyScoreString,\n                    icon: \"chart.line.uptrend.xyaxis\",\n                    color: .blue\n                )\n            }\n\n            // \ucd94\uc138 \uc815\ubcf4\n            if let trend = viewModel.trendInfo {\n                Divider()\n\n                HStack(spacing: 8) {\n                    Image(systemName: trend.change >= 0 ? \"arrow.up.circle.fill\" : \"arrow.down.circle.fill\")\n                        .font(.subheadline)\n                        .foregroundStyle(trend.change >= 0 ? .green : .orange)\n\n                    Text(\"\ucd5c\uadfc \ucd94\uc138: \\(viewModel.trendString)\")\n                        .font(.subheadline)\n                        .foregroundStyle(.secondary)\n\n                    Spacer()\n                }\n            }\n        }\n        .padding(16)\n        .background(cardBackground)\n        .cornerRadius(12)\n        .shadow(color: Color.black.opacity(0.05), radius: 8, x: 0, y: 2)\n    }\n\n    /// \uac1c\ubcc4 \ud1b5\uacc4 \uc544\uc774\ud15c\n    private func statisticItem(\n        title: String,\n        value: String,\n        icon: String,\n        color: Color\n    ) -> some View {\n        VStack(alignment: .leading, spacing: 8) {\n            HStack(spacing: 4) {\n                Image(systemName: icon)\n                    .font(.caption2)\n                    .foregroundStyle(color)\n\n                Text(title)\n                    .font(.caption)\n                    .foregroundStyle(.secondary)\n            }\n\n            Text(value)\n                .font(.title3)\n                .fontWeight(.semibold)\n                .foregroundStyle(.primary)\n        }\n        .frame(maxWidth: .infinity, alignment: .leading)\n        .padding(12)\n        .background(\n            RoundedRectangle(cornerRadius: 8)\n                .fill(Color(.secondarySystemBackground))\n        )\n    }\n\n    /// \uc218\uba74 \ucc28\ud2b8 \uc139\uc158\n    private var sleepChartSection: some View {\n        VStack(spacing: 0) {\n            SleepBarChart(\n                viewModel: viewModel,\n                isInteractive: true,\n                height: 300,\n                showStatusLegend: true\n            )\n            .padding(16)\n        }\n        .background(cardBackground)\n        .cornerRadius(12)\n        .shadow(color: Color.black.opacity(0.05), radius: 8, x: 0, y: 2)\n    }\n\n    /// \uc0c1\ud0dc \ubd84\ud3ec \uc139\uc158\n    private var statusDistributionSection: some View {\n        VStack(alignment: .leading, spacing: 12) {\n            sectionHeader(\n                title: \"\uc218\uba74 \uc0c1\ud0dc \ubd84\ud3ec\",\n                icon: \"chart.pie.fill\"\n            )\n\n            if let output = viewModel.statsOutput {\n                statusDistributionCard(statusStats: output.statusStats)\n            }\n        }\n    }\n\n    /// \uc0c1\ud0dc \ubd84\ud3ec \uce74\ub4dc\n    private func statusDistributionCard(statusStats: [FetchSleepStatsUseCase.StatusStats]) -> some View {\n        VStack(spacing: 12) {\n            ForEach(statusStats) { stat in\n                statusDistributionRow(stat: stat)\n            }\n\n            if statusStats.isEmpty {\n                Text(\"\uc0c1\ud0dc\ubcc4 \ub370\uc774\ud130\uac00 \uc5c6\uc2b5\ub2c8\ub2e4\")\n                    .font(.subheadline)\n                    .foregroundStyle(.secondary)\n                    .frame(maxWidth: .infinity)\n                    .padding(.vertical, 20)\n            }\n        }\n        .padding(16)\n        .background(cardBackground)\n        .cornerRadius(12)\n        .shadow(color: Color.black.opacity(0.05), radius: 8, x: 0, y: 2)\n    }\n\n    /// \uc0c1\ud0dc \ubd84\ud3ec \ud589\n    private func statusDistributionRow(stat: FetchSleepStatsUseCase.StatusStats) -> some View {\n        VStack(spacing: 8) {\n            HStack {\n                HStack(spacing: 8) {\n                    Image(systemName: stat.status.iconName)\n                        .font(.body)\n                        .foregroundStyle(stat.status.color)\n                        .frame(width: 24)\n\n                    Text(stat.status.displayName)\n                        .font(.subheadline)\n                        .fontWeight(.medium)\n                        .foregroundStyle(.primary)\n                }\n\n                Spacer()\n\n                HStack(spacing: 12) {\n                    Text(\"\\(stat.count)\ud68c\")\n                        .font(.subheadline)\n                        .foregroundStyle(.secondary)\n\n                    Text(String(format: \"%.0f%%\", stat.percentage * 100))\n                        .font(.subheadline)\n                        .fontWeight(.semibold)\n                        .foregroundStyle(stat.status.color)\n                }\n            }\n\n            GeometryReader { geometry in\n                ZStack(alignment: .leading) {\n                    RoundedRectangle(cornerRadius: 4)\n                        .fill(Color(.systemGray5))\n                        .frame(height: 8)\n\n                    RoundedRectangle(cornerRadius: 4)\n                        .fill(stat.status.color)\n                        .frame(width: geometry.size.width * CGFloat(stat.percentage), height: 8)\n                }\n            }\n            .frame(height: 8)\n        }\n    }\n\n    /// \ub85c\ub529 \ubdf0\n    private var loadingView: some View {\n        VStack(spacing: 16) {\n            ProgressView()\n                .scaleEffect(1.5)\n\n            Text(\"\uc218\uba74 \ud2b8\ub80c\ub4dc \ub370\uc774\ud130\ub97c \ubd88\ub7ec\uc624\ub294 \uc911...\")\n                .font(.subheadline)\n                .foregroundStyle(.secondary)\n        }\n        .frame(maxWidth: .infinity)\n        .frame(height: 300)\n        .background(cardBackground)\n        .cornerRadius(12)\n        .shadow(color: Color.black.opacity(0.05), radius: 8, x: 0, y: 2)\n    }\n\n    /// \ube48 \uc0c1\ud0dc \ubdf0\n    private var emptyStateView: some View {\n        VStack(spacing: 20) {\n            Image(systemName: \"moon.zzz\")\n                .font(.system(size: 70))\n                .foregroundStyle(.purple.opacity(0.3))\n\n            VStack(spacing: 8) {\n                Text(\"\uc218\uba74 \ud2b8\ub80c\ub4dc \ub370\uc774\ud130\uac00 \uc5c6\uc2b5\ub2c8\ub2e4\")\n                    .font(.headline)\n                    .fontWeight(.semibold)\n                    .foregroundStyle(.primary)\n\n                Text(\"\uc120\ud0dd\ud55c \uae30\uac04 \ub3d9\uc548\uc758 \uc218\uba74 \uae30\ub85d\uc774 \uc5c6\uc2b5\ub2c8\ub2e4.\\n\uc218\uba74 \uae30\ub85d\uc744 \uc785\ub825\ud558\uba74\\n\ud2b8\ub80c\ub4dc\ub97c \ud655\uc778\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4.\")\n                    .font(.subheadline)\n                    .foregroundStyle(.secondary)\n                    .multilineTextAlignment(.center)\n            }\n\n            VStack(spacing: 12) {\n                Text(\"\ub2e4\ub978 \uae30\uac04\uc744 \uc120\ud0dd\ud574\ubcf4\uc138\uc694:\")\n                    .font(.caption)\n                    .fontWeight(.medium)\n                    .foregroundStyle(.secondary)\n\n                Picker(\"\uae30\uac04\", selection: $viewModel.selectedPeriod) {\n                    Text(\"7\uc77c\").tag(FetchSleepStatsUseCase.StatsPeriod.week)\n                    Text(\"30\uc77c\").tag(FetchSleepStatsUseCase.StatsPeriod.month)\n                    Text(\"90\uc77c\").tag(FetchSleepStatsUseCase.StatsPeriod.quarter)\n                }\n                .pickerStyle(.segmented)\n                .frame(maxWidth: 250)\n            }\n            .padding(.top, 8)\n        }\n        .frame(maxWidth: .infinity)\n        .frame(height: 400)\n        .padding(.horizontal, 32)\n        .background(cardBackground)\n        .cornerRadius(12)\n        .shadow(color: Color.black.opacity(0.05), radius: 8, x: 0, y: 2)\n    }\n\n    /// \uc139\uc158 \ud5e4\ub354\n    private func sectionHeader(title: String, icon: String) -> some View {\n        HStack(spacing: 8) {\n            Image(systemName: icon)\n                .font(.subheadline)\n                .foregroundStyle(.purple)\n\n            Text(title)\n                .font(.headline)\n                .fontWeight(.semibold)\n                .foregroundStyle(.primary)\n        }\n    }\n\n    /// \uce74\ub4dc \ubc30\uacbd\n    private var cardBackground: some View {\n        RoundedRectangle(cornerRadius: 12)\n            .fill(Color(.systemBackground))\n            .overlay(\n                RoundedRectangle(cornerRadius: 12)\n                    .stroke(Color(.systemGray5), lineWidth: 1)\n            )\n    }\n\n    /// \ub0a0\uc9dc \ud3ec\ub9f7\ud305\n    private func formatDate(_ date: Date, style: DateFormatter.Style = .medium) -> String {\n        let formatter = DateFormatter()\n        formatter.dateStyle = style\n        formatter.timeStyle = .none\n        formatter.locale = Locale(identifier: \"ko_KR\")\n        return formatter.string(from: date)\n    }\n}\n\n// MARK: - Preview\n\n#Preview(\"History Tab\") {\n    SleepTabView()\n}\n\n#Preview(\"Dark Mode\") {\n    SleepTabView()\n        .preferredColorScheme(.dark)\n}\n\n// MARK: - Documentation\n\n/// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: SleepTabView \uc0ac\uc6a9\ubc95\n///\n/// \uae30\ubcf8 \uc0ac\uc6a9:\n/// ```swift\n/// struct ContentView: View {\n///     var body: some View {\n///         SleepTabView()\n///     }\n/// }\n/// ```\n///\n/// DIContainer \uba85\uc2dc\uc801 \uc8fc\uc785:\n/// ```swift\n/// SleepTabView(container: .shared)\n/// ```\n///\n/// TabView \ub0b4\uc5d0\uc11c \uc0ac\uc6a9 (\uba54\uc778 \uc571):\n/// ```swift\n/// TabView {\n///     SleepTabView()\n///         .tabItem {\n///             Label(\"\uc218\uba74\", systemImage: \"moon.zzz.fill\")\n///         }\n/// }\n/// ```\n///\n/// \uc8fc\uc694 \uae30\ub2a5:\n/// - Segmented control\ub85c History/Trends \uc804\ud658\n/// - History: \uc218\uba74 \uae30\ub85d \ub9ac\uc2a4\ud2b8 \ubc0f \ud3b8\uc9d1/\uc0ad\uc81c\n/// - Trends: \uc218\uba74 \ud2b8\ub80c\ub4dc \ucc28\ud2b8 \ubc0f \ud1b5\uacc4\n/// - \ud234\ubc14\uc758 \ucd94\uac00 \ubc84\ud2bc\uc73c\ub85c \uc218\uba74 \uae30\ub85d \uc785\ub825\n///\n/// \ud654\uba74 \uad6c\uc131:\n/// 1. Navigation Bar: \uc81c\ubaa9 \"\uc218\uba74\", \ucd94\uac00 \ubc84\ud2bc\n/// 2. Segmented Control: \"\uae30\ub85d\" / \"\ud2b8\ub80c\ub4dc\" \uc120\ud0dd\n/// 3. Content Area: \uc120\ud0dd\ub41c \ud0ed\uc758 View \ud45c\uc2dc\n///\n/// \uc0ac\uc6a9\uc790 \uc778\ud130\ub799\uc158:\n/// - Segmented control \ud0ed: \ud0ed \uc804\ud658\n/// - \ucd94\uac00 \ubc84\ud2bc \ud0ed: SleepInputSheet \ud45c\uc2dc\n/// - History \ud0ed: \ub9ac\uc2a4\ud2b8 \uc870\ud68c, \ud3b8\uc9d1, \uc0ad\uc81c\n/// - Trends \ud0ed: \ucc28\ud2b8 \uc870\ud68c, \uae30\uac04 \uc120\ud0dd\n///\n/// \ud0ed \uad6c\uc870:\n/// - .history: \uc218\uba74 \uae30\ub85d \ub9ac\uc2a4\ud2b8 (SleepHistoryContentView)\n/// - .trends: \uc218\uba74 \ud2b8\ub80c\ub4dc \ubd84\uc11d (SleepTrendsContentView)\n///\n/// \uc0c1\ud0dc \uad00\ub9ac:\n/// - selectedTab: \ud604\uc7ac \uc120\ud0dd\ub41c \ud0ed\n/// - showInputSheet: \uc785\ub825 \uc2dc\ud2b8 \ud45c\uc2dc \uc5ec\ubd80\n/// - historyViewModel: History \ud0ed ViewModel (lazy)\n/// - trendsViewModel: Trends \ud0ed ViewModel (lazy)\n///\n/// ViewModel Lazy Initialization:\n/// - \ucc98\uc74c \ud654\uba74\uc774 \ub098\ud0c0\ub0a0 \ub54c ViewModel \uc0dd\uc131\n/// - \uba54\ubaa8\ub9ac \ud6a8\uc728\uc131 \ud5a5\uc0c1\n/// - initializeViewModelsIfNeeded() \uba54\uc11c\ub4dc\uc5d0\uc11c \ucc98\ub9ac\n///\n/// NavigationStack \uad6c\uc870:\n/// - SleepTabView: NavigationStack \uc81c\uacf5 (\ucd5c\uc0c1\uc704)\n/// - SleepHistoryContentView: \ucf58\ud150\uce20\ub9cc (NavigationStack \uc5c6\uc74c)\n/// - SleepTrendsContentView: \ucf58\ud150\uce20\ub9cc (NavigationStack \uc5c6\uc74c)\n/// - \uc774\ub807\uac8c \ud558\uc5ec NavigationStack \uc911\ubcf5 \ubc29\uc9c0\n///\n/// \uc758\uc874\uc131:\n/// - SleepHistoryViewModel: \uae30\ub85d \ub9ac\uc2a4\ud2b8 \uad00\ub9ac\n/// - SleepTrendsViewModel: \ud2b8\ub80c\ub4dc \ubd84\uc11d \uad00\ub9ac\n/// - SleepInputSheet: \uc218\uba74 \uae30\ub85d \uc785\ub825\n/// - SleepRecordRow: \uac1c\ubcc4 \ub808\ucf54\ub4dc \ud45c\uc2dc\n/// - SleepBarChart: \ud2b8\ub80c\ub4dc \ucc28\ud2b8 \ud45c\uc2dc\n/// - DIContainer: ViewModel \uc0dd\uc131\n///\n/// \ud83d\udca1 Android \ube44\uad50:\n/// - Android: ViewPager + TabLayout + Fragment\n/// - SwiftUI: Picker + @State + View\n/// - Android: FragmentManager for switching\n/// - SwiftUI: @ViewBuilder + switch statement\n/// - Android: Toolbar with menu items\n/// - SwiftUI: NavigationStack + .toolbar\n///\n/// \uc811\uadfc\uc131:\n/// - VoiceOver \uc9c0\uc6d0\n/// - Dynamic Type \uc9c0\uc6d0\n/// - \ucda9\ubd84\ud55c \ud130\uce58 \uc601\uc5ed\n/// - \uba85\ud655\ud55c \ub808\uc774\ube14\uacfc \ud78c\ud2b8\n///\n/// \uc131\ub2a5 \ucd5c\uc801\ud654:\n/// - ViewModel lazy initialization\n/// - \uac01 \ud0ed\uc740 \ub3c5\ub9bd\uc801\uc73c\ub85c \ub370\uc774\ud130 \ub85c\ub4dc\n/// - Pull-to-refresh\ub85c \uc218\ub3d9 \uc0c8\ub85c\uace0\uce68\n///\n/// \uc2e4\ubb34 \ud301:\n/// - Segmented control\uc740 2-3\uac1c \ud0ed\uc5d0 \uc801\ud569\n/// - \uac01 \ud0ed\uc740 \ub3c5\ub9bd\uc801\uc778 ViewModel \ubcf4\uc720\n/// - \ucd94\uac00 \ubc84\ud2bc\uc740 \ubaa8\ub4e0 \ud0ed\uc5d0\uc11c \uc811\uadfc \uac00\ub2a5\n/// - NavigationStack\uc740 \ucd5c\uc0c1\uc704\uc5d0\uc11c\ub9cc \ud55c \ubc88 \uc0ac\uc6a9\n/// - \ucf58\ud150\uce20 \ucd94\ucd9c \ud328\ud134\uc73c\ub85c \uc7ac\uc0ac\uc6a9\uc131 \ud5a5\uc0c1\n///\n",
        "last_modified": "2026-01-14T22:52:08.913963"
      },
      "task_intent": {
        "title": "009-sleep-tracking-with-5-status-system",
        "description": "Sleep logging with 5-status tracking (bad, soso, good, excellent, oversleep), duration input, wake time prompts, and correlation with other health metrics. Automatic morning prompt to log previous night's sleep.",
        "from_plan": true
      },
      "commits_behind_main": 0,
      "status": "active",
      "merged_at": null
    }
  },
  "created_at": "2026-01-14T18:01:05.045328",
  "last_updated": "2026-01-14T21:03:40.788335"
}