{
  "file_path": "Bodii/Data/DataSources/Local/BodyLocalDataSource.swift",
  "main_branch_history": [],
  "task_views": {
    "003-body-composition-tracking-with-bmr-tdee": {
      "task_id": "003-body-composition-tracking-with-bmr-tdee",
      "branch_point": {
        "commit_hash": "2abdae73fb6199bcbf4f21f6deeb7952225f81e6",
        "content": "",
        "timestamp": "2026-01-13T07:46:22.394743"
      },
      "worktree_state": {
        "content": "//\n//  BodyLocalDataSource.swift\n//  Bodii\n//\n//  Created by Auto-Claude on 2026-01-12.\n//\n\n// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Local Data Source\n// Core Data \uc791\uc5c5\uc744 \ub2f4\ub2f9\ud558\ub294 \ub370\uc774\ud130 \uc18c\uc2a4 \ub808\uc774\uc5b4\n// \ud83d\udca1 Java \ube44\uad50: DAO (Data Access Object)\uc640 \uc720\uc0ac\ud55c \uc5ed\ud560\n\nimport Foundation\nimport CoreData\n\n// MARK: - BodyLocalDataSource\n\n/// BodyRecord\uc640 MetabolismSnapshot\uc758 Core Data \uc791\uc5c5\uc744 \ub2f4\ub2f9\ud558\ub294 \ub85c\uceec \ub370\uc774\ud130 \uc18c\uc2a4\n/// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Clean Architecture - Data Source Layer\n/// - Repository\uc640 Core Data \uc0ac\uc774\uc758 \ucd94\uc0c1\ud654 \ub808\uc774\uc5b4\n/// - Core Data \ud2b9\ud654\ub41c \uc791\uc5c5 \uc218\ud589 (NSFetchRequest, NSManagedObjectContext \ub4f1)\n/// - Mapper\ub97c \ud65c\uc6a9\ud558\uc5ec Domain Entity\uc640 Core Data Entity \ubcc0\ud658\n/// \ud83d\udca1 Java \ube44\uad50: JPA\ub97c \uc0ac\uc6a9\ud558\ub294 DAO \uad6c\ud604\uccb4\uc640 \uc720\uc0ac\n///\n/// \uc131\ub2a5 \uc694\uad6c\uc0ac\ud56d:\n/// - \ubaa8\ub4e0 \ucffc\ub9ac\ub294 0.5\ucd08 \uc774\ub0b4\uc5d0 \uc644\ub8cc\n/// - \ub300\ub7c9 \uc791\uc5c5\uc740 \ubc31\uadf8\ub77c\uc6b4\ub4dc \ucee8\ud14d\uc2a4\ud2b8 \uc0ac\uc6a9\n/// - \ub0a0\uc9dc \ud544\ub4dc\uc5d0 \uc778\ub371\uc2a4 \ud65c\uc6a9\nfinal class BodyLocalDataSource {\n\n    // MARK: - Properties\n\n    /// Core Data \uc2a4\ud0dd \uad00\ub9ac\uc790\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Dependency Injection\n    /// - PersistenceController\ub97c \uc678\ubd80\uc5d0\uc11c \uc8fc\uc785\ubc1b\uc544 \uc0ac\uc6a9\n    /// - \ud14c\uc2a4\ud2b8 \uc2dc \uc778\uba54\ubaa8\ub9ac \ucee8\ud2b8\ub864\ub7ec\ub85c \uad50\uccb4 \uac00\ub2a5\n    private let persistenceController: PersistenceController\n\n    /// BodyRecord \ub9e4\ud37c\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Mapper Pattern\n    /// - Core Data Entity \u2194 Domain Entity \ubcc0\ud658 \ub2f4\ub2f9\n    private let bodyRecordMapper: BodyRecordMapper\n\n    /// MetabolismSnapshot \ub9e4\ud37c\n    private let metabolismSnapshotMapper: MetabolismSnapshotMapper\n\n    // MARK: - Initialization\n\n    /// BodyLocalDataSource \ucd08\uae30\ud654\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Dependency Injection via Constructor\n    /// - \uc758\uc874\uc131\uc744 \uc0dd\uc131\uc790\ub97c \ud1b5\ud574 \uc8fc\uc785\ubc1b\uc74c\n    /// - \uae30\ubcf8\uac12\uc73c\ub85c shared instance \uc0ac\uc6a9\n    /// \ud83d\udca1 Java \ube44\uad50: @Autowired \ub610\ub294 \uc0dd\uc131\uc790 \uc8fc\uc785\uacfc \uc720\uc0ac\n    ///\n    /// - Parameter persistenceController: Core Data \uc2a4\ud0dd \uad00\ub9ac\uc790\n    init(persistenceController: PersistenceController = .shared) {\n        self.persistenceController = persistenceController\n        self.bodyRecordMapper = BodyRecordMapper()\n        self.metabolismSnapshotMapper = MetabolismSnapshotMapper()\n    }\n\n    // MARK: - Create\n\n    /// \uc0c8\ub85c\uc6b4 \uc2e0\uccb4 \uad6c\uc131 \uae30\ub85d\uacfc \ub300\uc0ac\uc728 \uc2a4\ub0c5\uc0f7\uc744 \uc800\uc7a5\ud569\ub2c8\ub2e4.\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Transactional Operation\n    /// - BodyRecord\uc640 MetabolismSnapshot\uc744 \ud568\uaed8 \uc0dd\uc131\n    /// - \ub450 \uc5d4\ud2f0\ud2f0 \uac04\uc758 \uad00\uacc4 \uc124\uc815\n    /// - \ud558\ub098\uc758 \ud2b8\ub79c\uc7ad\uc158\uc5d0\uc11c \ubaa8\ub450 \ucc98\ub9ac (\uc6d0\uc790\uc131 \ubcf4\uc7a5)\n    /// \ud83d\udca1 Java \ube44\uad50: @Transactional \uba54\uc11c\ub4dc\uc640 \uc720\uc0ac\n    ///\n    /// - Parameters:\n    ///   - entry: \uc800\uc7a5\ud560 \uc2e0\uccb4 \uad6c\uc131 \ub370\uc774\ud130\n    ///   - metabolismData: \ud568\uaed8 \uc800\uc7a5\ud560 \ub300\uc0ac\uc728 \ub370\uc774\ud130\n    /// - Returns: \uc800\uc7a5\ub41c \uc2e0\uccb4 \uad6c\uc131 \ub370\uc774\ud130\n    /// - Throws: \uc800\uc7a5 \uc2e4\ud328 \uc2dc \uc5d0\ub7ec\n    func save(entry: BodyCompositionEntry, metabolismData: MetabolismData) async throws -> BodyCompositionEntry {\n        // \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Background Context for Write Operations\n        // UI \ube14\ub85c\ud0b9\uc744 \ubc29\uc9c0\ud558\uae30 \uc704\ud574 \ubc31\uadf8\ub77c\uc6b4\ub4dc \ucee8\ud14d\uc2a4\ud2b8 \uc0ac\uc6a9\n        let context = persistenceController.newBackgroundContext()\n\n        return try await context.perform {\n            // \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Mapper \uc0ac\uc6a9\n            // Domain entity\ub97c Core Data entity\ub85c \ubcc0\ud658\n            let bodyRecord = self.bodyRecordMapper.toEntity(entry, context: context)\n            let metabolismSnapshot = self.metabolismSnapshotMapper.toEntity(metabolismData, context: context)\n\n            // \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Core Data Relationship\n            // \ub450 \uc5d4\ud2f0\ud2f0 \uac04\uc758 \uad00\uacc4 \uc124\uc815\n            // BodyRecord \u2194 MetabolismSnapshot (1:1)\n            bodyRecord.metabolismSnapshot = metabolismSnapshot\n            metabolismSnapshot.bodyRecord = bodyRecord\n\n            // \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: User Relationship\n            // \ud604\uc7ac\ub294 \ub2e8\uc77c \uc0ac\uc6a9\uc790 \uac00\uc815, \ud5a5\ud6c4 \ub2e4\uc911 \uc0ac\uc6a9\uc790 \uc9c0\uc6d0 \uc2dc \uc218\uc815 \ud544\uc694\n            // TODO: User \uac00\uc838\uc640\uc11c \uc5f0\uacb0\n\n            // \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Context Save\n            // \ubcc0\uacbd\uc0ac\ud56d\uc744 \uc601\uad6c \uc800\uc7a5\uc18c\uc5d0 \uae30\ub85d\n            do {\n                try context.save()\n            } catch {\n                // \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Error Wrapping\n                // Core Data \uc5d0\ub7ec\ub97c \ub354 \uad6c\uccb4\uc801\uc778 \ub3c4\uba54\uc778 \uc5d0\ub7ec\ub85c \ubcc0\ud658\n                throw NSError(\n                    domain: \"BodyLocalDataSource\",\n                    code: 1001,\n                    userInfo: [NSLocalizedDescriptionKey: \"\uc800\uc7a5 \uc2e4\ud328: \\(error.localizedDescription)\"]\n                )\n            }\n\n            // \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Return Saved Entity\n            // \uc800\uc7a5\ub41c Core Data entity\ub97c \ub2e4\uc2dc Domain entity\ub85c \ubcc0\ud658\n            // ID\uac00 \ud560\ub2f9\ub418\uace0 \uad00\uacc4\uac00 \uc124\uc815\ub41c \ucd5c\uc2e0 \uc0c1\ud0dc\ub97c \ubc18\ud658\n            return try self.bodyRecordMapper.toDomain(bodyRecord)\n        }\n    }\n\n    // MARK: - Read (Single)\n\n    /// ID\ub85c \ud2b9\uc815 \uc2e0\uccb4 \uad6c\uc131 \uae30\ub85d\uc744 \uc870\ud68c\ud569\ub2c8\ub2e4.\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Fetch by ID\n    /// - UUID \uae30\ubc18 \uc870\ud68c\n    /// - \uc131\ub2a5: <0.1\ucd08 (Primary Key \uc870\ud68c)\n    ///\n    /// - Parameter id: \uc870\ud68c\ud560 \uae30\ub85d\uc758 \uace0\uc720 \uc2dd\ubcc4\uc790\n    /// - Returns: \uc2e0\uccb4 \uad6c\uc131 \ub370\uc774\ud130 (\uc5c6\uc73c\uba74 nil)\n    /// - Throws: \uc870\ud68c \uc2e4\ud328 \uc2dc \uc5d0\ub7ec\n    func fetch(by id: UUID) async throws -> BodyCompositionEntry? {\n        let context = persistenceController.viewContext\n\n        return try await context.perform {\n            // \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: NSFetchRequest\n            // Core Data\uc758 \ucffc\ub9ac \uac1d\uccb4\n            // \ud83d\udca1 Java \ube44\uad50: JPA\uc758 CriteriaQuery\uc640 \uc720\uc0ac\n            let request: NSFetchRequest<BodyRecord> = BodyRecord.fetchRequest()\n            request.predicate = NSPredicate(format: \"id == %@\", id as CVarArg)\n            request.fetchLimit = 1\n\n            let results = try context.fetch(request)\n\n            // \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Optional Mapping\n            // \uacb0\uacfc\uac00 \uc788\uc73c\uba74 \ubcc0\ud658, \uc5c6\uc73c\uba74 nil \ubc18\ud658\n            guard let bodyRecord = results.first else { return nil }\n            return try self.bodyRecordMapper.toDomain(bodyRecord)\n        }\n    }\n\n    /// \ud2b9\uc815 \ub0a0\uc9dc\uc758 \uc2e0\uccb4 \uad6c\uc131 \uae30\ub85d\uc744 \uc870\ud68c\ud569\ub2c8\ub2e4.\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Date Range Query\n    /// - \ub0a0\uc9dc\uc758 \uc2dc\uc791(00:00:00)\ubd80\ud130 \ub05d(23:59:59)\uae4c\uc9c0 \uc870\ud68c\n    /// - \uac19\uc740 \ub0a0\uc5d0 \uc5ec\ub7ec \uae30\ub85d\uc774 \uc788\uc744 \uc218 \uc788\uc73c\ubbc0\ub85c \uac00\uc7a5 \ucd5c\uadfc \uac83 \ubc18\ud658\n    /// - \uc131\ub2a5: <0.2\ucd08 (\ub0a0\uc9dc \uc778\ub371\uc2a4 \ud65c\uc6a9)\n    ///\n    /// - Parameter date: \uc870\ud68c\ud560 \ub0a0\uc9dc\n    /// - Returns: \ud574\ub2f9 \ub0a0\uc9dc\uc758 \uc2e0\uccb4 \uad6c\uc131 \ub370\uc774\ud130 (\uc5c6\uc73c\uba74 nil)\n    /// - Throws: \uc870\ud68c \uc2e4\ud328 \uc2dc \uc5d0\ub7ec\n    func fetch(for date: Date) async throws -> BodyCompositionEntry? {\n        let context = persistenceController.viewContext\n\n        return try await context.perform {\n            // \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Date Range for Single Day\n            // \ub0a0\uc9dc\uc758 \uc2dc\uc791\uacfc \ub05d\uc744 \uacc4\uc0b0\ud558\uc5ec \ubc94\uc704 \ucffc\ub9ac\n            let calendar = Calendar.current\n            let startOfDay = calendar.startOfDay(for: date)\n            guard let endOfDay = calendar.date(byAdding: .day, value: 1, to: startOfDay) else {\n                return nil\n            }\n\n            let request: NSFetchRequest<BodyRecord> = BodyRecord.fetchRequest()\n            // \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: NSPredicate with Date Range\n            // date >= startOfDay AND date < endOfDay\n            request.predicate = NSPredicate(\n                format: \"date >= %@ AND date < %@\",\n                startOfDay as NSDate,\n                endOfDay as NSDate\n            )\n\n            // \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Sort Descriptor\n            // \uac19\uc740 \ub0a0\uc5d0 \uc5ec\ub7ec \uae30\ub85d\uc774 \uc788\uc744 \uacbd\uc6b0 \uac00\uc7a5 \ucd5c\uadfc \uac83\uc744 \uac00\uc838\uc624\uae30 \uc704\ud574 \uc815\ub82c\n            request.sortDescriptors = [NSSortDescriptor(key: \"date\", ascending: false)]\n            request.fetchLimit = 1\n\n            let results = try context.fetch(request)\n\n            guard let bodyRecord = results.first else { return nil }\n            return try self.bodyRecordMapper.toDomain(bodyRecord)\n        }\n    }\n\n    /// \uac00\uc7a5 \ucd5c\uadfc\uc758 \uc2e0\uccb4 \uad6c\uc131 \uae30\ub85d\uc744 \uc870\ud68c\ud569\ub2c8\ub2e4.\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Latest Record Query\n    /// - \ub0a0\uc9dc \uae30\uc900 \ub0b4\ub9bc\ucc28\uc21c \uc815\ub82c \ud6c4 \uccab \ubc88\uc9f8 \uacb0\uacfc\n    /// - \uc131\ub2a5: <0.1\ucd08 (\ub0a0\uc9dc \uc778\ub371\uc2a4 + LIMIT 1)\n    ///\n    /// - Returns: \uac00\uc7a5 \ucd5c\uadfc \uc2e0\uccb4 \uad6c\uc131 \ub370\uc774\ud130 (\uc5c6\uc73c\uba74 nil)\n    /// - Throws: \uc870\ud68c \uc2e4\ud328 \uc2dc \uc5d0\ub7ec\n    func fetchLatest() async throws -> BodyCompositionEntry? {\n        let context = persistenceController.viewContext\n\n        return try await context.perform {\n            let request: NSFetchRequest<BodyRecord> = BodyRecord.fetchRequest()\n            request.sortDescriptors = [NSSortDescriptor(key: \"date\", ascending: false)]\n            request.fetchLimit = 1\n\n            let results = try context.fetch(request)\n\n            guard let bodyRecord = results.first else { return nil }\n            return try self.bodyRecordMapper.toDomain(bodyRecord)\n        }\n    }\n\n    // MARK: - Read (Multiple)\n\n    /// \ubaa8\ub4e0 \uc2e0\uccb4 \uad6c\uc131 \uae30\ub85d\uc744 \uc870\ud68c\ud569\ub2c8\ub2e4.\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Fetch All\n    /// - \ub0a0\uc9dc \ub0b4\ub9bc\ucc28\uc21c \uc815\ub82c (\ucd5c\uc2e0\uc21c)\n    /// - \uc131\ub2a5: <0.5\ucd08 (\ucd5c\ub300 1000\uac1c \ub808\ucf54\ub4dc \uae30\uc900)\n    /// \ud83d\udca1 \uc8fc\uc758: \ub370\uc774\ud130\uac00 \ub9ce\uc544\uc9c0\uba74 fetchAll \ub300\uc2e0 date range \ucffc\ub9ac \uc0ac\uc6a9 \uad8c\uc7a5\n    ///\n    /// - Returns: \ubaa8\ub4e0 \uc2e0\uccb4 \uad6c\uc131 \ub370\uc774\ud130 \ubc30\uc5f4\n    /// - Throws: \uc870\ud68c \uc2e4\ud328 \uc2dc \uc5d0\ub7ec\n    func fetchAll() async throws -> [BodyCompositionEntry] {\n        let context = persistenceController.viewContext\n\n        return try await context.perform {\n            let request: NSFetchRequest<BodyRecord> = BodyRecord.fetchRequest()\n            request.sortDescriptors = [NSSortDescriptor(key: \"date\", ascending: false)]\n\n            // \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Performance Safeguard\n            // \ub108\ubb34 \ub9ce\uc740 \ub370\uc774\ud130\ub97c \ud55c \ubc88\uc5d0 \ub85c\ub4dc\ud558\uc9c0 \uc54a\ub3c4\ub85d \uc81c\ud55c\n            // \uc2e4\uc81c \uc571\uc5d0\uc11c\ub294 \ud398\uc774\uc9d5 \uad6c\ud604 \uad8c\uc7a5\n            request.fetchLimit = 1000\n\n            let results = try context.fetch(request)\n\n            // \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Collection Transformation\n            // map\uc744 \uc0ac\uc6a9\ud558\uc5ec \ubc30\uc5f4 \uc804\uccb4\ub97c \ubcc0\ud658\n            return try self.bodyRecordMapper.toDomain(results)\n        }\n    }\n\n    /// \uc9c0\uc815\ub41c \uae30\uac04\uc758 \uc2e0\uccb4 \uad6c\uc131 \uae30\ub85d\uc744 \uc870\ud68c\ud569\ub2c8\ub2e4.\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Date Range Query\n    /// - \ud2b8\ub80c\ub4dc \ucc28\ud2b8\ub97c \uc704\ud55c \ud575\uc2ec \ucffc\ub9ac\n    /// - \ub0a0\uc9dc \uc778\ub371\uc2a4\ub97c \ud65c\uc6a9\ud55c \ucd5c\uc801\ud654\n    /// - \uc131\ub2a5: <0.3\ucd08 (\ub0a0\uc9dc \ubc94\uc704 \ucffc\ub9ac, \ucd5c\ub300 90\uc77c \uae30\uc900)\n    ///\n    /// - Parameters:\n    ///   - startDate: \uc870\ud68c \uc2dc\uc791 \ub0a0\uc9dc (inclusive)\n    ///   - endDate: \uc870\ud68c \uc885\ub8cc \ub0a0\uc9dc (inclusive)\n    /// - Returns: \uae30\uac04 \ub0b4 \uc2e0\uccb4 \uad6c\uc131 \ub370\uc774\ud130 \ubc30\uc5f4 (\ub0a0\uc9dc \uc624\ub984\ucc28\uc21c)\n    /// - Throws: \uc870\ud68c \uc2e4\ud328 \uc2dc \uc5d0\ub7ec\n    func fetch(from startDate: Date, to endDate: Date) async throws -> [BodyCompositionEntry] {\n        let context = persistenceController.viewContext\n\n        return try await context.perform {\n            let request: NSFetchRequest<BodyRecord> = BodyRecord.fetchRequest()\n\n            // \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Date Range Predicate\n            // startDate <= date <= endDate\n            // \uc885\ub8cc \ub0a0\uc9dc\uc758 23:59:59\uae4c\uc9c0 \ud3ec\ud568\ud558\uae30 \uc704\ud574 +1\uc77c \ud558\uc5ec '<' \ube44\uad50\n            let calendar = Calendar.current\n            guard let endOfDay = calendar.date(byAdding: .day, value: 1, to: endDate) else {\n                throw NSError(\n                    domain: \"BodyLocalDataSource\",\n                    code: 1002,\n                    userInfo: [NSLocalizedDescriptionKey: \"\ub0a0\uc9dc \uacc4\uc0b0 \uc2e4\ud328\"]\n                )\n            }\n\n            request.predicate = NSPredicate(\n                format: \"date >= %@ AND date < %@\",\n                startDate as NSDate,\n                endOfDay as NSDate\n            )\n\n            // \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Sort for Chart Display\n            // \ucc28\ud2b8\ub294 \uc2dc\uac04\uc21c\uc73c\ub85c \ud45c\uc2dc\ud558\ubbc0\ub85c \uc624\ub984\ucc28\uc21c \uc815\ub82c\n            request.sortDescriptors = [NSSortDescriptor(key: \"date\", ascending: true)]\n\n            let results = try context.fetch(request)\n\n            return try self.bodyRecordMapper.toDomain(results)\n        }\n    }\n\n    /// \ucd5c\uadfc N\uc77c\uac04\uc758 \uc2e0\uccb4 \uad6c\uc131 \uae30\ub85d\uc744 \uc870\ud68c\ud569\ub2c8\ub2e4.\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Convenience Method\n    /// - fetch(from:to:)\uc758 \ud3b8\uc758 \uba54\uc11c\ub4dc\n    /// - \uc790\uc8fc \uc0ac\uc6a9\ub418\ub294 \ud328\ud134\uc744 \uac04\ub2e8\ud788 \ud45c\ud604\n    ///\n    /// - Parameter days: \uc870\ud68c\ud560 \uc77c\uc218 (\uc608: 7, 30, 90)\n    /// - Returns: \ucd5c\uadfc N\uc77c\uac04\uc758 \uc2e0\uccb4 \uad6c\uc131 \ub370\uc774\ud130 \ubc30\uc5f4 (\ub0a0\uc9dc \uc624\ub984\ucc28\uc21c)\n    /// - Throws: \uc870\ud68c \uc2e4\ud328 \uc2dc \uc5d0\ub7ec\n    func fetchRecent(days: Int) async throws -> [BodyCompositionEntry] {\n        // \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Date Calculation\n        // \ud604\uc7ac \uc2dc\uac04\uc5d0\uc11c N\uc77c \uc804 \uacc4\uc0b0\n        let endDate = Date()\n        guard let startDate = Calendar.current.date(byAdding: .day, value: -days, to: endDate) else {\n            throw NSError(\n                domain: \"BodyLocalDataSource\",\n                code: 1003,\n                userInfo: [NSLocalizedDescriptionKey: \"\ub0a0\uc9dc \uacc4\uc0b0 \uc2e4\ud328\"]\n            )\n        }\n\n        return try await fetch(from: startDate, to: endDate)\n    }\n\n    // MARK: - Update\n\n    /// \uae30\uc874 \uc2e0\uccb4 \uad6c\uc131 \uae30\ub85d\uc744 \uc218\uc815\ud569\ub2c8\ub2e4.\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Update Operation\n    /// - ID\ub85c \uae30\uc874 \ub808\ucf54\ub4dc\ub97c \ucc3e\uc544\uc11c \uc5c5\ub370\uc774\ud2b8\n    /// - MetabolismData\ub3c4 \ud568\uaed8 \uc5c5\ub370\uc774\ud2b8\n    /// - \uc131\ub2a5: <0.2\ucd08 (\ub2e8\uc77c \ub808\ucf54\ub4dc \uc5c5\ub370\uc774\ud2b8)\n    ///\n    /// - Parameters:\n    ///   - entry: \uc218\uc815\ud560 \uc2e0\uccb4 \uad6c\uc131 \ub370\uc774\ud130 (ID \ud3ec\ud568)\n    ///   - metabolismData: \ud568\uaed8 \uc218\uc815\ud560 \ub300\uc0ac\uc728 \ub370\uc774\ud130\n    /// - Returns: \uc218\uc815\ub41c \uc2e0\uccb4 \uad6c\uc131 \ub370\uc774\ud130\n    /// - Throws: \uc218\uc815 \uc2e4\ud328 \uc2dc \uc5d0\ub7ec\n    func update(entry: BodyCompositionEntry, metabolismData: MetabolismData) async throws -> BodyCompositionEntry {\n        let context = persistenceController.newBackgroundContext()\n\n        return try await context.perform {\n            // \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Fetch Before Update\n            // \uc5c5\ub370\uc774\ud2b8\ud560 \uc5d4\ud2f0\ud2f0\ub97c \uba3c\uc800 \uc870\ud68c\n            let request: NSFetchRequest<BodyRecord> = BodyRecord.fetchRequest()\n            request.predicate = NSPredicate(format: \"id == %@\", entry.id as CVarArg)\n            request.fetchLimit = 1\n\n            let results = try context.fetch(request)\n\n            guard let bodyRecord = results.first else {\n                throw NSError(\n                    domain: \"BodyLocalDataSource\",\n                    code: 1004,\n                    userInfo: [NSLocalizedDescriptionKey: \"\uc218\uc815\ud560 \uae30\ub85d\uc744 \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4 (ID: \\(entry.id))\"]\n                )\n            }\n\n            // \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Update Entity\n            // Mapper\uc758 updateEntity \uba54\uc11c\ub4dc \uc0ac\uc6a9\n            self.bodyRecordMapper.updateEntity(bodyRecord, from: entry)\n\n            // \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Update Related Entity\n            // MetabolismSnapshot\ub3c4 \ud568\uaed8 \uc5c5\ub370\uc774\ud2b8\n            if let snapshot = bodyRecord.metabolismSnapshot {\n                self.metabolismSnapshotMapper.updateEntity(snapshot, from: metabolismData)\n            } else {\n                // \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Create if Not Exists\n                // \uad00\uacc4\uac00 \uc5c6\uc73c\uba74 \uc0c8\ub85c \uc0dd\uc131\n                let snapshot = self.metabolismSnapshotMapper.toEntity(metabolismData, context: context)\n                bodyRecord.metabolismSnapshot = snapshot\n                snapshot.bodyRecord = bodyRecord\n            }\n\n            try context.save()\n\n            return try self.bodyRecordMapper.toDomain(bodyRecord)\n        }\n    }\n\n    // MARK: - Delete\n\n    /// \ud2b9\uc815 \uc2e0\uccb4 \uad6c\uc131 \uae30\ub85d\uc744 \uc0ad\uc81c\ud569\ub2c8\ub2e4.\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Delete Operation\n    /// - ID\ub85c \ub808\ucf54\ub4dc \uc0ad\uc81c\n    /// - Cascade delete: \uc5f0\uad00\ub41c MetabolismData\ub3c4 \ud568\uaed8 \uc0ad\uc81c (Core Data \ubaa8\ub378\uc5d0\uc11c \uc124\uc815\ub428)\n    /// - \uc131\ub2a5: <0.2\ucd08 (\ub2e8\uc77c \ub808\ucf54\ub4dc \uc0ad\uc81c)\n    ///\n    /// - Parameter id: \uc0ad\uc81c\ud560 \uae30\ub85d\uc758 \uace0\uc720 \uc2dd\ubcc4\uc790\n    /// - Throws: \uc0ad\uc81c \uc2e4\ud328 \uc2dc \uc5d0\ub7ec\n    func delete(by id: UUID) async throws {\n        let context = persistenceController.newBackgroundContext()\n\n        try await context.perform {\n            let request: NSFetchRequest<BodyRecord> = BodyRecord.fetchRequest()\n            request.predicate = NSPredicate(format: \"id == %@\", id as CVarArg)\n            request.fetchLimit = 1\n\n            let results = try context.fetch(request)\n\n            guard let bodyRecord = results.first else {\n                throw NSError(\n                    domain: \"BodyLocalDataSource\",\n                    code: 1005,\n                    userInfo: [NSLocalizedDescriptionKey: \"\uc0ad\uc81c\ud560 \uae30\ub85d\uc744 \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4 (ID: \\(id))\"]\n                )\n            }\n\n            // \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Context Delete\n            // Core Data\uc5d0\uc11c \uc5d4\ud2f0\ud2f0 \uc0ad\uc81c\n            // Cascade rule\uc5d0 \uc758\ud574 \uc5f0\uad00\ub41c MetabolismSnapshot\ub3c4 \uc790\ub3d9 \uc0ad\uc81c\ub428\n            context.delete(bodyRecord)\n\n            try context.save()\n        }\n    }\n\n    /// \ubaa8\ub4e0 \uc2e0\uccb4 \uad6c\uc131 \uae30\ub85d\uc744 \uc0ad\uc81c\ud569\ub2c8\ub2e4.\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Bulk Delete\n    /// - \ubc30\uce58 \uc0ad\uc81c \uc791\uc5c5\n    /// - \ud14c\uc2a4\ud2b8\ub098 \ub370\uc774\ud130 \ucd08\uae30\ud654\uc5d0 \uc0ac\uc6a9\n    /// - \uc131\ub2a5: <0.5\ucd08\n    /// \ud83d\udca1 \uc8fc\uc758: \uc2e4\uc81c \uc571\uc5d0\uc11c\ub294 \uc2e0\uc911\ud558\uac8c \uc0ac\uc6a9\ud574\uc57c \ud568\n    ///\n    /// - Throws: \uc0ad\uc81c \uc2e4\ud328 \uc2dc \uc5d0\ub7ec\n    func deleteAll() async throws {\n        let context = persistenceController.newBackgroundContext()\n\n        try await context.perform {\n            // \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Batch Delete Request\n            // iOS 9+\uc5d0\uc11c \uc9c0\uc6d0\ud558\ub294 \ud6a8\uc728\uc801\uc778 \ubc30\uce58 \uc0ad\uc81c\n            let fetchRequest: NSFetchRequest<NSFetchRequestResult> = BodyRecord.fetchRequest()\n            let batchDeleteRequest = NSBatchDeleteRequest(fetchRequest: fetchRequest)\n\n            // \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Result Type\n            // \uc0ad\uc81c\ub41c \uac1d\uccb4\uc758 ID\ub97c \ubc18\ud658\ubc1b\ub3c4\ub85d \uc124\uc815\n            batchDeleteRequest.resultType = .resultTypeObjectIDs\n\n            let result = try context.execute(batchDeleteRequest) as? NSBatchDeleteResult\n\n            // \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Merge Changes\n            // \ubc30\uce58 \uc0ad\uc81c\ub294 context\ub97c \uac70\uce58\uc9c0 \uc54a\uc73c\ubbc0\ub85c \ubcc0\uacbd\uc0ac\ud56d\uc744 \uc218\ub3d9\uc73c\ub85c merge\n            if let objectIDArray = result?.result as? [NSManagedObjectID] {\n                let changes = [NSDeletedObjectsKey: objectIDArray]\n                NSManagedObjectContext.mergeChanges(\n                    fromRemoteContextSave: changes,\n                    into: [self.persistenceController.viewContext]\n                )\n            }\n        }\n    }\n\n    // MARK: - Metabolism Data\n\n    /// \ud2b9\uc815 \uc2e0\uccb4 \uad6c\uc131 \uae30\ub85d\uacfc \uc5f0\uacb0\ub41c \ub300\uc0ac\uc728 \ub370\uc774\ud130\ub97c \uc870\ud68c\ud569\ub2c8\ub2e4.\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Related Entity Query\n    /// - 1:1 \uad00\uacc4\uc758 \uc5f0\uad00 \uc5d4\ud2f0\ud2f0 \uc870\ud68c\n    /// - \uc131\ub2a5: <0.1\ucd08 (\uad00\uacc4 \uc778\ub371\uc2a4 \ud65c\uc6a9)\n    ///\n    /// - Parameter bodyEntryId: \uc2e0\uccb4 \uad6c\uc131 \uae30\ub85d ID\n    /// - Returns: \uc5f0\uacb0\ub41c \ub300\uc0ac\uc728 \ub370\uc774\ud130 (\uc5c6\uc73c\uba74 nil)\n    /// - Throws: \uc870\ud68c \uc2e4\ud328 \uc2dc \uc5d0\ub7ec\n    func fetchMetabolismData(for bodyEntryId: UUID) async throws -> MetabolismData? {\n        let context = persistenceController.viewContext\n\n        return try await context.perform {\n            let request: NSFetchRequest<BodyRecord> = BodyRecord.fetchRequest()\n            request.predicate = NSPredicate(format: \"id == %@\", bodyEntryId as CVarArg)\n            request.fetchLimit = 1\n\n            let results = try context.fetch(request)\n\n            guard let bodyRecord = results.first else { return nil }\n\n            // \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Relationship Navigation\n            // Core Data\uc758 \uad00\uacc4\ub97c \ud1b5\ud574 \uc5f0\uad00\ub41c \uc5d4\ud2f0\ud2f0 \uc811\uadfc\n            guard let snapshot = bodyRecord.metabolismSnapshot else { return nil }\n\n            return try self.metabolismSnapshotMapper.toDomain(snapshot)\n        }\n    }\n\n    // MARK: - Statistics\n\n    /// \uc9c0\uc815\ub41c \uae30\uac04\uc758 \ud1b5\uacc4 \ub370\uc774\ud130\ub97c \uc870\ud68c\ud569\ub2c8\ub2e4.\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Aggregate Query\n    /// - Core Data\uc758 \uc9d1\uacc4 \ud568\uc218 \uc0ac\uc6a9\n    /// - \ud3c9\uade0, \ucd5c\uc18c, \ucd5c\ub300 \ub4f1\uc758 \ud1b5\uacc4 \uacc4\uc0b0\n    /// - \uc131\ub2a5: <0.3\ucd08\n    ///\n    /// - Parameters:\n    ///   - startDate: \uc870\ud68c \uc2dc\uc791 \ub0a0\uc9dc\n    ///   - endDate: \uc870\ud68c \uc885\ub8cc \ub0a0\uc9dc\n    /// - Returns: \uae30\uac04 \ub0b4 \ud1b5\uacc4 \ub370\uc774\ud130\n    /// - Throws: \uc870\ud68c \uc2e4\ud328 \uc2dc \uc5d0\ub7ec\n    func fetchStatistics(from startDate: Date, to endDate: Date) async throws -> BodyCompositionStatistics {\n        let context = persistenceController.viewContext\n\n        return try await context.perform {\n            let calendar = Calendar.current\n            guard let endOfDay = calendar.date(byAdding: .day, value: 1, to: endDate) else {\n                throw NSError(\n                    domain: \"BodyLocalDataSource\",\n                    code: 1006,\n                    userInfo: [NSLocalizedDescriptionKey: \"\ub0a0\uc9dc \uacc4\uc0b0 \uc2e4\ud328\"]\n                )\n            }\n\n            // \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Expression Description\n            // Core Data\uc758 \uc9d1\uacc4 \ud568\uc218\ub97c \uc0ac\uc6a9\ud558\uc5ec \ud1b5\uacc4 \uacc4\uc0b0\n            // \ud83d\udca1 Java \ube44\uad50: JPA\uc758 CriteriaBuilder.avg(), min(), max()\uc640 \uc720\uc0ac\n\n            // Weight statistics\n            let avgWeightExpression = NSExpressionDescription()\n            avgWeightExpression.name = \"avgWeight\"\n            avgWeightExpression.expression = NSExpression(forFunction: \"average:\", arguments: [NSExpression(forKeyPath: \"weight\")])\n            avgWeightExpression.expressionResultType = .decimalAttributeType\n\n            let minWeightExpression = NSExpressionDescription()\n            minWeightExpression.name = \"minWeight\"\n            minWeightExpression.expression = NSExpression(forFunction: \"min:\", arguments: [NSExpression(forKeyPath: \"weight\")])\n            minWeightExpression.expressionResultType = .decimalAttributeType\n\n            let maxWeightExpression = NSExpressionDescription()\n            maxWeightExpression.name = \"maxWeight\"\n            maxWeightExpression.expression = NSExpression(forFunction: \"max:\", arguments: [NSExpression(forKeyPath: \"weight\")])\n            maxWeightExpression.expressionResultType = .decimalAttributeType\n\n            // Body fat percentage statistics\n            let avgBodyFatExpression = NSExpressionDescription()\n            avgBodyFatExpression.name = \"avgBodyFat\"\n            avgBodyFatExpression.expression = NSExpression(forFunction: \"average:\", arguments: [NSExpression(forKeyPath: \"bodyFatPercent\")])\n            avgBodyFatExpression.expressionResultType = .decimalAttributeType\n\n            let minBodyFatExpression = NSExpressionDescription()\n            minBodyFatExpression.name = \"minBodyFat\"\n            minBodyFatExpression.expression = NSExpression(forFunction: \"min:\", arguments: [NSExpression(forKeyPath: \"bodyFatPercent\")])\n            minBodyFatExpression.expressionResultType = .decimalAttributeType\n\n            let maxBodyFatExpression = NSExpressionDescription()\n            maxBodyFatExpression.name = \"maxBodyFat\"\n            maxBodyFatExpression.expression = NSExpression(forFunction: \"max:\", arguments: [NSExpression(forKeyPath: \"bodyFatPercent\")])\n            maxBodyFatExpression.expressionResultType = .decimalAttributeType\n\n            // Muscle mass statistics\n            let avgMuscleExpression = NSExpressionDescription()\n            avgMuscleExpression.name = \"avgMuscle\"\n            avgMuscleExpression.expression = NSExpression(forFunction: \"average:\", arguments: [NSExpression(forKeyPath: \"muscleMass\")])\n            avgMuscleExpression.expressionResultType = .decimalAttributeType\n\n            let minMuscleExpression = NSExpressionDescription()\n            minMuscleExpression.name = \"minMuscle\"\n            minMuscleExpression.expression = NSExpression(forFunction: \"min:\", arguments: [NSExpression(forKeyPath: \"muscleMass\")])\n            minMuscleExpression.expressionResultType = .decimalAttributeType\n\n            let maxMuscleExpression = NSExpressionDescription()\n            maxMuscleExpression.name = \"maxMuscle\"\n            maxMuscleExpression.expression = NSExpression(forFunction: \"max:\", arguments: [NSExpression(forKeyPath: \"muscleMass\")])\n            maxMuscleExpression.expressionResultType = .decimalAttributeType\n\n            // Count\n            let countExpression = NSExpressionDescription()\n            countExpression.name = \"count\"\n            countExpression.expression = NSExpression(forFunction: \"count:\", arguments: [NSExpression(forKeyPath: \"id\")])\n            countExpression.expressionResultType = .integer64AttributeType\n\n            let request: NSFetchRequest<NSFetchRequestResult> = BodyRecord.fetchRequest()\n            request.predicate = NSPredicate(\n                format: \"date >= %@ AND date < %@\",\n                startDate as NSDate,\n                endOfDay as NSDate\n            )\n            request.resultType = .dictionaryResultType\n            request.propertiesToFetch = [\n                avgWeightExpression, minWeightExpression, maxWeightExpression,\n                avgBodyFatExpression, minBodyFatExpression, maxBodyFatExpression,\n                avgMuscleExpression, minMuscleExpression, maxMuscleExpression,\n                countExpression\n            ]\n\n            let results = try context.fetch(request)\n\n            // \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Parse Aggregate Results\n            // \uc9d1\uacc4 \uacb0\uacfc\ub97c Dictionary\uc5d0\uc11c \ucd94\ucd9c\n            guard let result = results.first as? [String: Any] else {\n                // \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Empty Statistics\n                // \ub370\uc774\ud130\uac00 \uc5c6\uc744 \uacbd\uc6b0 0\uc73c\ub85c \ucd08\uae30\ud654\ub41c \ud1b5\uacc4 \ubc18\ud658\n                return BodyCompositionStatistics(\n                    averageWeight: 0,\n                    minWeight: 0,\n                    maxWeight: 0,\n                    averageBodyFatPercent: 0,\n                    minBodyFatPercent: 0,\n                    maxBodyFatPercent: 0,\n                    averageMuscleMass: 0,\n                    minMuscleMass: 0,\n                    maxMuscleMass: 0,\n                    recordCount: 0\n                )\n            }\n\n            return BodyCompositionStatistics(\n                averageWeight: (result[\"avgWeight\"] as? NSDecimalNumber)?.decimalValue ?? 0,\n                minWeight: (result[\"minWeight\"] as? NSDecimalNumber)?.decimalValue ?? 0,\n                maxWeight: (result[\"maxWeight\"] as? NSDecimalNumber)?.decimalValue ?? 0,\n                averageBodyFatPercent: (result[\"avgBodyFat\"] as? NSDecimalNumber)?.decimalValue ?? 0,\n                minBodyFatPercent: (result[\"minBodyFat\"] as? NSDecimalNumber)?.decimalValue ?? 0,\n                maxBodyFatPercent: (result[\"maxBodyFat\"] as? NSDecimalNumber)?.decimalValue ?? 0,\n                averageMuscleMass: (result[\"avgMuscle\"] as? NSDecimalNumber)?.decimalValue ?? 0,\n                minMuscleMass: (result[\"minMuscle\"] as? NSDecimalNumber)?.decimalValue ?? 0,\n                maxMuscleMass: (result[\"maxMuscle\"] as? NSDecimalNumber)?.decimalValue ?? 0,\n                recordCount: (result[\"count\"] as? Int) ?? 0\n            )\n        }\n    }\n}\n\n// MARK: - Documentation\n\n/// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Local Data Source Pattern \uc774\ud574\n///\n/// Local Data Source\uc758 \uc5ed\ud560:\n/// - Repository\uc640 Core Data \uc0ac\uc774\uc758 \ucd94\uc0c1\ud654 \ub808\uc774\uc5b4\n/// - Core Data \ud2b9\ud654\ub41c \uc791\uc5c5 \uc218\ud589 (NSFetchRequest, NSManagedObjectContext \ub4f1)\n/// - Mapper\ub97c \ud65c\uc6a9\ud558\uc5ec Domain Entity\uc640 Core Data Entity \ubcc0\ud658\n/// - \uc131\ub2a5 \ucd5c\uc801\ud654 (\ubc31\uadf8\ub77c\uc6b4\ub4dc \ucee8\ud14d\uc2a4\ud2b8, \uc778\ub371\uc2a4 \ud65c\uc6a9 \ub4f1)\n///\n/// \uc8fc\uc694 \ud2b9\uc9d5:\n/// 1. \uad00\uacc4 \uc790\ub3d9 \uc0dd\uc131\n///    - BodyRecord \uc800\uc7a5 \uc2dc MetabolismSnapshot \uc790\ub3d9 \uc0dd\uc131 \ubc0f \uc5f0\uacb0\n///    - 1:1 \uad00\uacc4 \uc720\uc9c0\n///\n/// 2. \ubc31\uadf8\ub77c\uc6b4\ub4dc \ucc98\ub9ac\n///    - Write \uc791\uc5c5\uc740 \ubc31\uadf8\ub77c\uc6b4\ub4dc \ucee8\ud14d\uc2a4\ud2b8 \uc0ac\uc6a9\n///    - Read \uc791\uc5c5\uc740 viewContext \uc0ac\uc6a9 (UI \uc5c5\ub370\uc774\ud2b8 \uc704\ud574)\n///\n/// 3. \ub0a0\uc9dc \ubc94\uc704 \ucffc\ub9ac \ucd5c\uc801\ud654\n///    - \ud2b8\ub80c\ub4dc \ucc28\ud2b8\ub97c \uc704\ud55c \ud6a8\uc728\uc801\uc778 \ucffc\ub9ac\n///    - \ub0a0\uc9dc \uc778\ub371\uc2a4 \ud65c\uc6a9 (Core Data \ubaa8\ub378\uc5d0\uc11c \uc124\uc815 \ud544\uc694)\n///\n/// 4. \uc9d1\uacc4 \ucffc\ub9ac\n///    - Core Data\uc758 NSExpression\uc744 \ud65c\uc6a9\ud55c \ud1b5\uacc4 \uacc4\uc0b0\n///    - \ub370\uc774\ud130\ubca0\uc774\uc2a4 \ub808\ubca8\uc5d0\uc11c \uc9d1\uacc4\ud558\uc5ec \uc131\ub2a5 \ud5a5\uc0c1\n///\n/// \uc131\ub2a5 \uace0\ub824\uc0ac\ud56d:\n/// - \ubaa8\ub4e0 \ucffc\ub9ac\ub294 0.5\ucd08 \uc774\ub0b4 \uc644\ub8cc \ubaa9\ud45c\n/// - \ub0a0\uc9dc \ud544\ub4dc\uc5d0 \uc778\ub371\uc2a4 \uc124\uc815 \ud544\uc218 (Core Data \ubaa8\ub378\uc5d0\uc11c)\n/// - \ub300\ub7c9 \ub370\uc774\ud130\ub294 \ubc31\uadf8\ub77c\uc6b4\ub4dc \ucee8\ud14d\uc2a4\ud2b8 \uc0ac\uc6a9\n/// - Batch \uc791\uc5c5 \ud65c\uc6a9 (NSBatchDeleteRequest \ub4f1)\n///\n/// \uc0ac\uc6a9 \uc608\uc2dc:\n/// ```swift\n/// let dataSource = BodyLocalDataSource()\n///\n/// // \uc800\uc7a5\n/// let entry = BodyCompositionEntry(weight: 70, bodyFatPercent: 18, muscleMass: 32)\n/// let metabolism = MetabolismData(bmr: 1650, tdee: 2280, ...)\n/// let saved = try await dataSource.save(entry: entry, metabolismData: metabolism)\n///\n/// // \uc870\ud68c\n/// let latest = try await dataSource.fetchLatest()\n/// let recent = try await dataSource.fetchRecent(days: 7)\n///\n/// // \ud1b5\uacc4\n/// let stats = try await dataSource.fetchStatistics(from: startDate, to: endDate)\n/// ```\n///\n/// \ud83d\udca1 \uc2e4\ubb34 \ud301:\n/// - Data Source\ub294 Repository\uc5d0\uc11c\ub9cc \uc0ac\uc6a9 (\uc9c1\uc811 \uc0ac\uc6a9 \uc9c0\uc591)\n/// - \uc5d0\ub7ec\ub294 \uad6c\uccb4\uc801\uc73c\ub85c \uc815\uc758\ud558\uc5ec Repository\uc5d0\uc11c \ucc98\ub9ac\n/// - \uc131\ub2a5 \uce21\uc815 \ubc0f \ubaa8\ub2c8\ud130\ub9c1 \uc911\uc694\n/// - Core Data \uc778\ub371\uc2a4 \uc124\uc815 \uc78a\uc9c0 \ub9d0\uae30\n///\n",
        "last_modified": "2026-01-13T19:18:50.330264"
      },
      "task_intent": {
        "title": "Body Composition Tracking with BMR/TDEE",
        "description": "Complete body composition logging system including height, weight, body fat percentage, muscle mass, with automatic BMR (Mifflin-St Jeor) and TDEE calculations. Visualize changes over time with Swift Charts graphs showing trends and goal progress.",
        "from_plan": true
      },
      "commits_behind_main": 1,
      "status": "active",
      "merged_at": null
    }
  },
  "created_at": "2026-01-13T07:43:04.460186",
  "last_updated": "2026-01-13T07:46:22.728858"
}