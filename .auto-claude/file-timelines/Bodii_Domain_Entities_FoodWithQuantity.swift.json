{
  "file_path": "Bodii/Domain/Entities/FoodWithQuantity.swift",
  "main_branch_history": [],
  "task_views": {
    "005-korean-food-database-integration": {
      "task_id": "005-korean-food-database-integration",
      "branch_point": {
        "commit_hash": "c44bfbcd7c1699b176a8bb155e8c35f43ebd4ad9",
        "content": "",
        "timestamp": "2026-01-13T07:46:23.878686"
      },
      "worktree_state": {
        "content": "//\n//  FoodWithQuantity.swift\n//  Bodii\n//\n//  Created by Auto-Claude on 2026-01-13.\n//\n\nimport Foundation\n\n/// \uc12d\ucde8\ub7c9\uc774 \uc9c0\uc815\ub41c \uc74c\uc2dd \ubaa8\ub378\n///\n/// Food \uc5d4\ud2f0\ud2f0\uc5d0 \uc0ac\uc6a9\uc790\uac00 \uc120\ud0dd\ud55c \uc12d\ucde8\ub7c9 \uc815\ubcf4\ub97c \uacb0\ud569\ud55c \ubaa8\ub378\uc785\ub2c8\ub2e4.\n/// \uc12d\ucde8\ub7c9\uc5d0 \ub530\ub77c \uc790\ub3d9\uc73c\ub85c \uacc4\uc0b0\ub41c \uc601\uc591 \uc815\ubcf4\ub97c \uc81c\uacf5\ud569\ub2c8\ub2e4.\n///\n/// **\uc8fc\uc694 \uc6a9\ub3c4:**\n/// - \uc74c\uc2dd \uac80\uc0c9 \uacb0\uacfc\uc5d0\uc11c \uc0ac\uc6a9\uc790\uac00 \uc12d\ucde8\ub7c9\uc744 \uc870\uc815\ud560 \ub54c\n/// - FoodRecord \uc0dd\uc131 \uc804 \ubbf8\ub9ac\ubcf4\uae30 (preview)\n/// - \uc2dd\ub2e8 \uacc4\ud68d \ubc0f \uc601\uc591\uc18c \uc2dc\ubbac\ub808\uc774\uc158\n///\n/// **\uacc4\uc0b0 \ub85c\uc9c1:**\n/// - NutritionCalculator\ub97c \uc0ac\uc6a9\ud558\uc5ec \uc12d\ucde8\ub7c9\uc5d0 \ube44\ub840\ud55c \uc601\uc591\uc18c \uacc4\uc0b0\n/// - \ubaa8\ub4e0 \uacc4\uc0b0\uc740 computed property\ub85c \uad6c\ud604\ub418\uc5b4 \ud56d\uc0c1 \ucd5c\uc2e0 \uc0c1\ud0dc \uc720\uc9c0\n///\n/// **Example:**\n/// ```swift\n/// let food = Food(\n///     id: UUID(),\n///     name: \"\ud604\ubbf8\ubc25\",\n///     calories: 330,\n///     carbohydrates: 73.4,\n///     protein: 6.8,\n///     fat: 2.5,\n///     servingSize: 210.0,\n///     servingUnit: \"1\uacf5\uae30\",\n///     source: .governmentAPI,\n///     createdAt: Date()\n/// )\n///\n/// // 1.5\uc778\ubd84 \uc12d\ucde8\n/// let foodWithQuantity = FoodWithQuantity(\n///     food: food,\n///     quantity: 1.5,\n///     unit: .serving\n/// )\n///\n/// print(foodWithQuantity.calculatedCalories)  // 495 (330 * 1.5)\n/// print(foodWithQuantity.calculatedProtein)   // 10.2 (6.8 * 1.5)\n///\n/// // FoodRecord\ub85c \ubcc0\ud658\n/// let record = foodWithQuantity.toFoodRecord(\n///     userId: currentUser.id,\n///     date: Date(),\n///     mealType: .breakfast\n/// )\n/// ```\n///\n/// - Note: Java\uc758 DTO/VO \ud328\ud134\uacfc \uc720\uc0ac\ud558\uc9c0\ub9cc, Swift\uc5d0\uc11c\ub294 struct\ub85c \uad6c\ud604\ud558\uc5ec \ubd88\ubcc0\uc131\uacfc \uac12 \ud0c0\uc785 \ud2b9\uc131 \ud65c\uc6a9\nstruct FoodWithQuantity {\n    // MARK: - Food Information\n\n    /// \uc74c\uc2dd \uc815\ubcf4\n    ///\n    /// \uc601\uc591 \uc815\ubcf4\uc758 \uae30\uc900\uc774 \ub418\ub294 Food \uc5d4\ud2f0\ud2f0\uc785\ub2c8\ub2e4.\n    let food: Food\n\n    // MARK: - Quantity Information\n\n    /// \uc12d\ucde8\ub7c9\n    ///\n    /// unit\uc5d0 \ub530\ub77c \uc778\ubd84 \ub610\ub294 \uadf8\ub7a8 \ub2e8\uc704\uc785\ub2c8\ub2e4.\n    let quantity: Decimal\n\n    /// \uc12d\ucde8\ub7c9 \ub2e8\uc704\n    ///\n    /// - `.serving`: Food\uc758 servingSize \uae30\uc900 \uc778\ubd84\n    /// - `.grams`: \uadf8\ub7a8 \ub2e8\uc704 \uc9c1\uc811 \uc785\ub825\n    let unit: QuantityUnit\n\n    // MARK: - Calculated Nutrition (Computed Properties)\n\n    /// \uacc4\uc0b0\ub41c \uc601\uc591 \uc815\ubcf4\n    ///\n    /// NutritionCalculator\ub97c \uc0ac\uc6a9\ud558\uc5ec \uacc4\uc0b0\ub41c \uc601\uc591\uc18c \uc815\ubcf4\ub97c \ubc18\ud658\ud569\ub2c8\ub2e4.\n    /// \uc774 \uacc4\uc0b0\uc740 \uce90\uc2f1\ub418\uc9c0 \uc54a\uc73c\ubbc0\ub85c, \uc790\uc8fc \uc811\uadfc\ud558\ub294 \uacbd\uc6b0 \uacb0\uacfc\ub97c \ubcc0\uc218\uc5d0 \uc800\uc7a5\ud558\ub294 \uac83\uc774 \uc88b\uc2b5\ub2c8\ub2e4.\n    ///\n    /// - Note: Lazy \uc5f0\uc0b0 - \uc811\uadfc\ud560 \ub54c\ub9c8\ub2e4 \uacc4\uc0b0\ub428\n    ///\n    /// Example:\n    /// ```swift\n    /// let nutrition = foodWithQuantity.calculatedNutrition\n    /// print(nutrition.calories)\n    /// print(nutrition.protein)\n    /// ```\n    var calculatedNutrition: CalculatedNutrition {\n        NutritionCalculator.calculate(\n            from: food,\n            quantity: quantity,\n            unit: unit\n        )\n    }\n\n    /// \uacc4\uc0b0\ub41c \uce7c\ub85c\ub9ac (kcal)\n    ///\n    /// \uc12d\ucde8\ub7c9\uc5d0 \ube44\ub840\ud558\uc5ec \uacc4\uc0b0\ub41c \uce7c\ub85c\ub9ac\uc785\ub2c8\ub2e4.\n    var calculatedCalories: Int32 {\n        calculatedNutrition.calories\n    }\n\n    /// \uacc4\uc0b0\ub41c \ud0c4\uc218\ud654\ubb3c (g)\n    ///\n    /// \uc12d\ucde8\ub7c9\uc5d0 \ube44\ub840\ud558\uc5ec \uacc4\uc0b0\ub41c \ud0c4\uc218\ud654\ubb3c\uc785\ub2c8\ub2e4.\n    var calculatedCarbohydrates: Decimal {\n        calculatedNutrition.carbohydrates\n    }\n\n    /// \uacc4\uc0b0\ub41c \ub2e8\ubc31\uc9c8 (g)\n    ///\n    /// \uc12d\ucde8\ub7c9\uc5d0 \ube44\ub840\ud558\uc5ec \uacc4\uc0b0\ub41c \ub2e8\ubc31\uc9c8\uc785\ub2c8\ub2e4.\n    var calculatedProtein: Decimal {\n        calculatedNutrition.protein\n    }\n\n    /// \uacc4\uc0b0\ub41c \uc9c0\ubc29 (g)\n    ///\n    /// \uc12d\ucde8\ub7c9\uc5d0 \ube44\ub840\ud558\uc5ec \uacc4\uc0b0\ub41c \uc9c0\ubc29\uc785\ub2c8\ub2e4.\n    var calculatedFat: Decimal {\n        calculatedNutrition.fat\n    }\n\n    /// \uacc4\uc0b0\ub41c \ub098\ud2b8\ub968 (mg)\n    ///\n    /// \uc12d\ucde8\ub7c9\uc5d0 \ube44\ub840\ud558\uc5ec \uacc4\uc0b0\ub41c \ub098\ud2b8\ub968\uc785\ub2c8\ub2e4. (optional)\n    var calculatedSodium: Decimal? {\n        calculatedNutrition.sodium\n    }\n\n    /// \uacc4\uc0b0\ub41c \uc2dd\uc774\uc12c\uc720 (g)\n    ///\n    /// \uc12d\ucde8\ub7c9\uc5d0 \ube44\ub840\ud558\uc5ec \uacc4\uc0b0\ub41c \uc2dd\uc774\uc12c\uc720\uc785\ub2c8\ub2e4. (optional)\n    var calculatedFiber: Decimal? {\n        calculatedNutrition.fiber\n    }\n\n    /// \uacc4\uc0b0\ub41c \ub2f9\ub958 (g)\n    ///\n    /// \uc12d\ucde8\ub7c9\uc5d0 \ube44\ub840\ud558\uc5ec \uacc4\uc0b0\ub41c \ub2f9\ub958\uc785\ub2c8\ub2e4. (optional)\n    var calculatedSugar: Decimal? {\n        calculatedNutrition.sugar\n    }\n\n    // MARK: - Macro Ratios\n\n    /// \ud0c4\uc218\ud654\ubb3c \ube44\uc728 (%)\n    ///\n    /// \uce7c\ub85c\ub9ac \uae30\uc900 \ud0c4\uc218\ud654\ubb3c \ube44\uc728\uc785\ub2c8\ub2e4.\n    var carbsPercentage: Decimal {\n        calculatedNutrition.carbsPercentage\n    }\n\n    /// \ub2e8\ubc31\uc9c8 \ube44\uc728 (%)\n    ///\n    /// \uce7c\ub85c\ub9ac \uae30\uc900 \ub2e8\ubc31\uc9c8 \ube44\uc728\uc785\ub2c8\ub2e4.\n    var proteinPercentage: Decimal {\n        calculatedNutrition.proteinPercentage\n    }\n\n    /// \uc9c0\ubc29 \ube44\uc728 (%)\n    ///\n    /// \uce7c\ub85c\ub9ac \uae30\uc900 \uc9c0\ubc29 \ube44\uc728\uc785\ub2c8\ub2e4.\n    var fatPercentage: Decimal {\n        calculatedNutrition.fatPercentage\n    }\n}\n\n// MARK: - Convenience Initializers\n\nextension FoodWithQuantity {\n    /// \uc778\ubd84 \ub2e8\uc704\ub85c FoodWithQuantity\ub97c \uc0dd\uc131\ud569\ub2c8\ub2e4\n    ///\n    /// - Parameters:\n    ///   - food: \uc74c\uc2dd \uc815\ubcf4\n    ///   - servings: \uc778\ubd84 \uc218\n    /// - Returns: \uc0dd\uc131\ub41c FoodWithQuantity\n    ///\n    /// Example:\n    /// ```swift\n    /// let foodWithQuantity = FoodWithQuantity.withServings(food: food, servings: 1.5)\n    /// // 1.5\uc778\ubd84\uc73c\ub85c \uc0dd\uc131\n    /// ```\n    static func withServings(food: Food, servings: Decimal) -> FoodWithQuantity {\n        FoodWithQuantity(\n            food: food,\n            quantity: servings,\n            unit: .serving\n        )\n    }\n\n    /// \uadf8\ub7a8 \ub2e8\uc704\ub85c FoodWithQuantity\ub97c \uc0dd\uc131\ud569\ub2c8\ub2e4\n    ///\n    /// - Parameters:\n    ///   - food: \uc74c\uc2dd \uc815\ubcf4\n    ///   - grams: \uadf8\ub7a8 \uc218\n    /// - Returns: \uc0dd\uc131\ub41c FoodWithQuantity\n    ///\n    /// Example:\n    /// ```swift\n    /// let foodWithQuantity = FoodWithQuantity.withGrams(food: food, grams: 300)\n    /// // 300g\uc73c\ub85c \uc0dd\uc131\n    /// ```\n    static func withGrams(food: Food, grams: Decimal) -> FoodWithQuantity {\n        FoodWithQuantity(\n            food: food,\n            quantity: grams,\n            unit: .grams\n        )\n    }\n}\n\n// MARK: - FoodRecord Conversion\n\nextension FoodWithQuantity {\n    /// FoodRecord\ub85c \ubcc0\ud658\ud569\ub2c8\ub2e4\n    ///\n    /// \uc0ac\uc6a9\uc790\uac00 \uc12d\ucde8\ub7c9\uc744 \ud655\uc815\ud558\uace0 \uc2dd\ub2e8\uc5d0 \uae30\ub85d\ud560 \ub54c \uc0ac\uc6a9\ud569\ub2c8\ub2e4.\n    ///\n    /// - Parameters:\n    ///   - userId: \uc0ac\uc6a9\uc790 ID\n    ///   - date: \uc12d\ucde8 \uc77c\uc790\n    ///   - mealType: \ub07c\ub2c8 \uc885\ub958\n    /// - Returns: \uc0dd\uc131\ub41c FoodRecord\n    ///\n    /// Example:\n    /// ```swift\n    /// let record = foodWithQuantity.toFoodRecord(\n    ///     userId: currentUser.id,\n    ///     date: Date(),\n    ///     mealType: .breakfast\n    /// )\n    /// // \uc544\uce68 \uc2dd\uc0ac\ub85c \uae30\ub85d\n    /// ```\n    func toFoodRecord(\n        userId: UUID,\n        date: Date,\n        mealType: MealType\n    ) -> FoodRecord {\n        let nutrition = calculatedNutrition\n\n        return FoodRecord(\n            id: UUID(),\n            userId: userId,\n            foodId: food.id,\n            date: date,\n            mealType: mealType,\n            quantity: quantity,\n            quantityUnit: unit,\n            calculatedCalories: nutrition.calories,\n            calculatedCarbs: nutrition.carbohydrates,\n            calculatedProtein: nutrition.protein,\n            calculatedFat: nutrition.fat,\n            createdAt: Date()\n        )\n    }\n\n    /// CalculatedNutrition\uc744 \uc0ac\uc6a9\ud558\uc5ec FoodRecord\ub85c \ubcc0\ud658\ud569\ub2c8\ub2e4 (\ub300\uc548 \ubc29\ubc95)\n    ///\n    /// calculatedNutrition\uc758 toFoodRecord() \uba54\uc11c\ub4dc\ub97c \ud65c\uc6a9\ud569\ub2c8\ub2e4.\n    ///\n    /// - Parameters:\n    ///   - userId: \uc0ac\uc6a9\uc790 ID\n    ///   - date: \uc12d\ucde8 \uc77c\uc790\n    ///   - mealType: \ub07c\ub2c8 \uc885\ub958\n    /// - Returns: \uc0dd\uc131\ub41c FoodRecord\n    ///\n    /// Example:\n    /// ```swift\n    /// let record = foodWithQuantity.toFoodRecordUsingCalculation(\n    ///     userId: currentUser.id,\n    ///     date: Date(),\n    ///     mealType: .lunch\n    /// )\n    /// ```\n    func toFoodRecordUsingCalculation(\n        userId: UUID,\n        date: Date,\n        mealType: MealType\n    ) -> FoodRecord {\n        calculatedNutrition.toFoodRecord(\n            foodId: food.id,\n            userId: userId,\n            date: date,\n            mealType: mealType\n        )\n    }\n}\n\n// MARK: - Identifiable\n\nextension FoodWithQuantity: Identifiable {\n    /// \uace0\uc720 \uc2dd\ubcc4\uc790\n    ///\n    /// Food\uc758 ID\ub97c \uc0ac\uc6a9\ud569\ub2c8\ub2e4.\n    /// - Note: \uac19\uc740 Food\ub77c\ub3c4 quantity\uac00 \ub2e4\ub974\uba74 \ub2e4\ub978 \uc778\uc2a4\ud134\uc2a4\uc774\uc9c0\ub9cc, ID\ub294 \ub3d9\uc77c\ud569\ub2c8\ub2e4.\n    var id: UUID {\n        food.id\n    }\n}\n\n// MARK: - Equatable\n\nextension FoodWithQuantity: Equatable {\n    /// \ub450 FoodWithQuantity\uac00 \uac19\uc740\uc9c0 \ube44\uad50\ud569\ub2c8\ub2e4\n    ///\n    /// Food, quantity, unit\uc774 \ubaa8\ub450 \uac19\uc544\uc57c \uac19\ub2e4\uace0 \ud310\ub2e8\ud569\ub2c8\ub2e4.\n    static func == (lhs: FoodWithQuantity, rhs: FoodWithQuantity) -> Bool {\n        lhs.food == rhs.food &&\n        lhs.quantity == rhs.quantity &&\n        lhs.unit == rhs.unit\n    }\n}\n\n// MARK: - Hashable\n\nextension FoodWithQuantity: Hashable {\n    /// Hash \uac12\uc744 \uacc4\uc0b0\ud569\ub2c8\ub2e4\n    ///\n    /// Food, quantity, unit\uc744 \ubaa8\ub450 hash\uc5d0 \ud3ec\ud568\ud569\ub2c8\ub2e4.\n    func hash(into hasher: inout Hasher) {\n        hasher.combine(food)\n        hasher.combine(quantity)\n        hasher.combine(unit)\n    }\n}\n\n// MARK: - Quantity Adjustment\n\nextension FoodWithQuantity {\n    /// \uc12d\ucde8\ub7c9\uc744 \ubcc0\uacbd\ud55c \uc0c8\ub85c\uc6b4 FoodWithQuantity\ub97c \ubc18\ud658\ud569\ub2c8\ub2e4\n    ///\n    /// \ubd88\ubcc0(immutable) \uad6c\uc870\uccb4\uc774\ubbc0\ub85c \uc0c8 \uc778\uc2a4\ud134\uc2a4\ub97c \uc0dd\uc131\ud558\uc5ec \ubc18\ud658\ud569\ub2c8\ub2e4.\n    ///\n    /// - Parameter newQuantity: \uc0c8\ub85c\uc6b4 \uc12d\ucde8\ub7c9\n    /// - Returns: \uc12d\ucde8\ub7c9\uc774 \ubcc0\uacbd\ub41c \uc0c8 FoodWithQuantity\n    ///\n    /// Example:\n    /// ```swift\n    /// let original = FoodWithQuantity(food: food, quantity: 1.0, unit: .serving)\n    /// let updated = original.withQuantity(1.5)\n    /// // 1.0\uc778\ubd84 \u2192 1.5\uc778\ubd84\uc73c\ub85c \ubcc0\uacbd\n    /// ```\n    func withQuantity(_ newQuantity: Decimal) -> FoodWithQuantity {\n        FoodWithQuantity(\n            food: food,\n            quantity: newQuantity,\n            unit: unit\n        )\n    }\n\n    /// \uc12d\ucde8\ub7c9 \ub2e8\uc704\ub97c \ubcc0\uacbd\ud55c \uc0c8\ub85c\uc6b4 FoodWithQuantity\ub97c \ubc18\ud658\ud569\ub2c8\ub2e4\n    ///\n    /// \ubd88\ubcc0(immutable) \uad6c\uc870\uccb4\uc774\ubbc0\ub85c \uc0c8 \uc778\uc2a4\ud134\uc2a4\ub97c \uc0dd\uc131\ud558\uc5ec \ubc18\ud658\ud569\ub2c8\ub2e4.\n    ///\n    /// - Parameters:\n    ///   - newQuantity: \uc0c8\ub85c\uc6b4 \uc12d\ucde8\ub7c9\n    ///   - newUnit: \uc0c8\ub85c\uc6b4 \ub2e8\uc704\n    /// - Returns: \uc12d\ucde8\ub7c9\uacfc \ub2e8\uc704\uac00 \ubcc0\uacbd\ub41c \uc0c8 FoodWithQuantity\n    ///\n    /// Example:\n    /// ```swift\n    /// let original = FoodWithQuantity(food: food, quantity: 1.0, unit: .serving)\n    /// let updated = original.withQuantity(300, unit: .grams)\n    /// // 1.0\uc778\ubd84 \u2192 300g\uc73c\ub85c \ubcc0\uacbd\n    /// ```\n    func withQuantity(_ newQuantity: Decimal, unit newUnit: QuantityUnit) -> FoodWithQuantity {\n        FoodWithQuantity(\n            food: food,\n            quantity: newQuantity,\n            unit: newUnit\n        )\n    }\n}\n\n// MARK: - Display Helpers\n\nextension FoodWithQuantity {\n    /// \uc12d\ucde8\ub7c9\uc744 \uc0ac\uc6a9\uc790\uc5d0\uac8c \ud45c\uc2dc\ud560 \ud615\uc2dd\uc73c\ub85c \ubc18\ud658\ud569\ub2c8\ub2e4\n    ///\n    /// - Returns: \"1.5\uc778\ubd84\" \ub610\ub294 \"300g\" \ud615\uc2dd\uc758 \ubb38\uc790\uc5f4\n    ///\n    /// Example:\n    /// ```swift\n    /// let display = foodWithQuantity.quantityDisplay\n    /// // \"1.5\uc778\ubd84\" \ub610\ub294 \"300g\"\n    /// ```\n    var quantityDisplay: String {\n        let quantityString = quantity.formatted()\n        return \"\\(quantityString)\\(unit.displayName)\"\n    }\n\n    /// \uc74c\uc2dd\uba85\uacfc \uc12d\ucde8\ub7c9\uc744 \uacb0\ud569\ud55c \uc804\uccb4 \ud45c\uc2dc \ubb38\uc790\uc5f4\uc744 \ubc18\ud658\ud569\ub2c8\ub2e4\n    ///\n    /// - Returns: \"\ud604\ubbf8\ubc25 1.5\uc778\ubd84\" \ud615\uc2dd\uc758 \ubb38\uc790\uc5f4\n    ///\n    /// Example:\n    /// ```swift\n    /// let display = foodWithQuantity.fullDisplay\n    /// // \"\ud604\ubbf8\ubc25 1.5\uc778\ubd84\"\n    /// ```\n    var fullDisplay: String {\n        \"\\(food.name) \\(quantityDisplay)\"\n    }\n}\n",
        "last_modified": "2026-01-14T22:55:39.263833"
      },
      "task_intent": {
        "title": "005-korean-food-database-integration",
        "description": "Integrate Korean Food & Drug Administration (\uc2dd\uc57d\ucc98) food nutrition database API as primary source, with USDA FoodData Central as fallback for international foods. Prioritize Korean dishes (kimchi jjigae, bibimbap, tteokbokki) that are poorly covered by competitors.",
        "from_plan": true
      },
      "commits_behind_main": 0,
      "status": "active",
      "merged_at": null
    }
  },
  "created_at": "2026-01-13T07:43:31.495564",
  "last_updated": "2026-01-13T07:46:24.145779"
}