{
  "file_path": "Bodii/Presentation/Features/Exercise/ViewModels/ExerciseInputViewModel.swift",
  "main_branch_history": [],
  "task_views": {
    "008-exercise-tracking-with-met-calculations": {
      "task_id": "008-exercise-tracking-with-met-calculations",
      "branch_point": {
        "commit_hash": "4e56d606f7b0d4cb74120dd392544f3fe2d4f5b4",
        "content": "",
        "timestamp": "2026-01-14T11:45:41.765455"
      },
      "worktree_state": {
        "content": "//\n//  ExerciseInputViewModel.swift\n//  Bodii\n//\n//  Created by Auto-Claude on 2026-01-14.\n//\n\n// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Form ViewModel Pattern\n// \uc785\ub825 \ud3fc\uc744 \uad00\ub9ac\ud558\ub294 ViewModel \ud328\ud134\n// \ud83d\udca1 Java \ube44\uad50: Android\uc758 ViewModel with Form State\uc640 \uc720\uc0ac\n\nimport Foundation\nimport Observation\n\n/// \uc6b4\ub3d9 \uc785\ub825 \ud3fc \ubdf0 \ubaa8\ub378\n///\n/// \uc6b4\ub3d9 \uc785\ub825 \ud3fc\uc758 \uc0c1\ud0dc\ub97c \uad00\ub9ac\ud558\uace0, \uc2e4\uc2dc\uac04 \uce7c\ub85c\ub9ac \ubbf8\ub9ac\ubcf4\uae30\ub97c \uc81c\uacf5\ud569\ub2c8\ub2e4.\n///\n/// ## \ucc45\uc784\n/// - \ud3fc \uc785\ub825 \uc0c1\ud0dc \uad00\ub9ac (\uc6b4\ub3d9 \uc885\ub958, \uc2dc\uac04, \uac15\ub3c4, \uba54\ubaa8)\n/// - \uc2e4\uc2dc\uac04 \uce7c\ub85c\ub9ac \uacc4\uc0b0 \ubbf8\ub9ac\ubcf4\uae30\n/// - \uc785\ub825\uac12 \uac80\uc99d\n/// - \uc6b4\ub3d9 \uae30\ub85d \uc800\uc7a5\n///\n/// ## \uc758\uc874\uc131\n/// - AddExerciseRecordUseCase: \uc6b4\ub3d9 \uae30\ub85d \ucd94\uac00\n///\n/// ## \uc0ac\uc6a9 \uc608\uc2dc\n/// ```swift\n/// let viewModel = ExerciseInputViewModel(\n///     addExerciseRecordUseCase: addExerciseRecordUseCase,\n///     userId: user.id,\n///     userWeight: user.currentWeight ?? 70.0,\n///     userBMR: user.currentBMR ?? 1650,\n///     userTDEE: user.currentTDEE ?? 2310\n/// )\n///\n/// // View\uc5d0\uc11c \uc0ac\uc6a9\n/// ExerciseTypeGridView(selectedType: $viewModel.selectedExerciseType)\n/// DurationInputView(duration: $viewModel.duration)\n/// Text(\"\uc608\uc0c1 \uc18c\ubaa8: \\(viewModel.previewCalories)kcal\")\n/// Button(\"\uc800\uc7a5\", action: viewModel.save)\n/// ```\n@Observable\nfinal class ExerciseInputViewModel {\n\n    // MARK: - Form State Properties\n\n    // \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Form State Management\n    // @Observable \ub9e4\ud06c\ub85c\ub85c \ubaa8\ub4e0 \ud504\ub85c\ud37c\ud2f0 \ubcc0\uacbd\uc774 \uc790\ub3d9\uc73c\ub85c View\uc5d0 \ubc18\uc601\ub428\n    // \ud83d\udca1 Java \ube44\uad50: Android\uc758 MutableStateFlow\uc640 \uc720\uc0ac\n\n    /// \uc120\ud0dd\ub41c \uc6b4\ub3d9 \uc885\ub958\n    var selectedExerciseType: ExerciseType = .running\n\n    /// \uc6b4\ub3d9 \uc2dc\uac04 (\ubd84)\n    var duration: Int32 = 30\n\n    /// \uc120\ud0dd\ub41c \uac15\ub3c4\n    var selectedIntensity: Intensity = .medium\n\n    /// \uba54\ubaa8 (\uc120\ud0dd\uc0ac\ud56d)\n    var note: String = \"\"\n\n    /// \uc6b4\ub3d9 \ub0a0\uc9dc\n    var selectedDate: Date = Date()\n\n    // MARK: - UI State Properties\n\n    /// \uc800\uc7a5 \uc911 \ub85c\ub529 \uc0c1\ud0dc\n    var isSaving: Bool = false\n\n    /// \uc5d0\ub7ec \uba54\uc2dc\uc9c0\n    var errorMessage: String?\n\n    /// \uc800\uc7a5 \uc131\uacf5 \uc5ec\ubd80\n    var isSaveSuccess: Bool = false\n\n    // MARK: - Computed Properties\n\n    // \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Computed Property with Side Effects\n    // \ud3fc \uc0c1\ud0dc\uac00 \ubcc0\uacbd\ub420 \ub54c\ub9c8\ub2e4 \uc790\ub3d9\uc73c\ub85c \uc7ac\uacc4\uc0b0\ub418\ub294 \ubbf8\ub9ac\ubcf4\uae30 \uce7c\ub85c\ub9ac\n\n    /// \uc2e4\uc2dc\uac04 \uce7c\ub85c\ub9ac \ubbf8\ub9ac\ubcf4\uae30\n    ///\n    /// \ud604\uc7ac \uc785\ub825\uac12\uc744 \uae30\ubc18\uc73c\ub85c \uc608\uc0c1 \uc18c\ubaa8 \uce7c\ub85c\ub9ac\ub97c \uacc4\uc0b0\ud569\ub2c8\ub2e4.\n    /// \ud3fc\uc758 \uc5b4\ub5a4 \uac12\uc774\ub4e0 \ubcc0\uacbd\ub418\uba74 \uc790\ub3d9\uc73c\ub85c \uc7ac\uacc4\uc0b0\ub429\ub2c8\ub2e4.\n    ///\n    /// - Returns: \uc608\uc0c1 \uc18c\ubaa8 \uce7c\ub85c\ub9ac (kcal)\n    ///\n    /// - Note: ExerciseCalcService\ub97c \uc0ac\uc6a9\ud558\uc5ec MET \uae30\ubc18 \uacc4\uc0b0\n    var previewCalories: Int32 {\n        guard duration > 0 else { return 0 }\n\n        return ExerciseCalcService.calculateCalories(\n            exerciseType: selectedExerciseType,\n            duration: duration,\n            intensity: selectedIntensity,\n            weight: userWeight\n        )\n    }\n\n    /// \ud3fc\uc774 \uc720\ud6a8\ud55c\uc9c0 \uc5ec\ubd80\n    ///\n    /// \ucd5c\uc18c 1\ubd84 \uc774\uc0c1\uc758 \uc6b4\ub3d9 \uc2dc\uac04\uc774 \uc785\ub825\ub418\uc5c8\ub294\uc9c0 \uac80\uc99d\ud569\ub2c8\ub2e4.\n    ///\n    /// - Returns: \ud3fc\uc774 \uc720\ud6a8\ud558\uba74 true\n    var isFormValid: Bool {\n        duration >= 1\n    }\n\n    /// \uc5d0\ub7ec\uac00 \uc788\ub294\uc9c0 \uc5ec\ubd80\n    var hasError: Bool {\n        errorMessage != nil\n    }\n\n    /// \ud3b8\uc9d1 \ubaa8\ub4dc\uc778\uc9c0 \uc5ec\ubd80\n    var isEditMode: Bool {\n        editingExercise != nil\n    }\n\n    // MARK: - Private Dependencies\n\n    // \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Dependency Injection\n    // \ud544\uc694\ud55c \uc758\uc874\uc131\uc740 \uc0dd\uc131\uc790\ub97c \ud1b5\ud574 \uc8fc\uc785\ubc1b\uc544 \ud14c\uc2a4\ud2b8 \uac00\ub2a5\uc131 \ud5a5\uc0c1\n\n    /// \uc6b4\ub3d9 \uae30\ub85d \ucd94\uac00 \uc720\uc2a4\ucf00\uc774\uc2a4\n    private let addExerciseRecordUseCase: AddExerciseRecordUseCase\n\n    /// \uc6b4\ub3d9 \uae30\ub85d \uc218\uc815 \uc720\uc2a4\ucf00\uc774\uc2a4 (\ud3b8\uc9d1 \ubaa8\ub4dc\uc77c \ub54c\ub9cc \uc0ac\uc6a9)\n    private let updateExerciseRecordUseCase: UpdateExerciseRecordUseCase?\n\n    /// \ud3b8\uc9d1 \uc911\uc778 \uc6b4\ub3d9 \uae30\ub85d (\ud3b8\uc9d1 \ubaa8\ub4dc\uc77c \ub54c\ub9cc \uc874\uc7ac)\n    private let editingExercise: ExerciseRecord?\n\n    /// \uc0ac\uc6a9\uc790 ID\n    private let userId: UUID\n\n    /// \uc0ac\uc6a9\uc790 \uccb4\uc911 (kg) - MET \uacc4\uc0b0\uc5d0 \uc0ac\uc6a9\n    private let userWeight: Decimal\n\n    /// \uc0ac\uc6a9\uc790 BMR - DailyLog \uc0dd\uc131 \uc2dc \uc0ac\uc6a9\n    private let userBMR: Decimal\n\n    /// \uc0ac\uc6a9\uc790 TDEE - DailyLog \uc0dd\uc131 \uc2dc \uc0ac\uc6a9\n    private let userTDEE: Decimal\n\n    // MARK: - Initialization\n\n    /// ExerciseInputViewModel \ucd08\uae30\ud654\n    ///\n    /// - Parameters:\n    ///   - addExerciseRecordUseCase: \uc6b4\ub3d9 \uae30\ub85d \ucd94\uac00 \uc720\uc2a4\ucf00\uc774\uc2a4\n    ///   - updateExerciseRecordUseCase: \uc6b4\ub3d9 \uae30\ub85d \uc218\uc815 \uc720\uc2a4\ucf00\uc774\uc2a4 (\ud3b8\uc9d1 \ubaa8\ub4dc\uc77c \ub54c\ub9cc \ud544\uc694)\n    ///   - userId: \uc0ac\uc6a9\uc790 ID\n    ///   - userWeight: \uc0ac\uc6a9\uc790 \uccb4\uc911 (kg)\n    ///   - userBMR: \uc0ac\uc6a9\uc790 BMR\n    ///   - userTDEE: \uc0ac\uc6a9\uc790 TDEE\n    ///   - editingExercise: \ud3b8\uc9d1\ud560 \uc6b4\ub3d9 \uae30\ub85d (\ud3b8\uc9d1 \ubaa8\ub4dc\uc77c \ub54c\ub9cc \uc81c\uacf5)\n    ///   - selectedDate: \ucd08\uae30 \uc120\ud0dd \ub0a0\uc9dc (\uae30\ubcf8\uac12: \uc624\ub298, \ud3b8\uc9d1 \ubaa8\ub4dc\uc5d0\uc11c\ub294 \ubb34\uc2dc\ub428)\n    init(\n        addExerciseRecordUseCase: AddExerciseRecordUseCase,\n        updateExerciseRecordUseCase: UpdateExerciseRecordUseCase? = nil,\n        userId: UUID,\n        userWeight: Decimal,\n        userBMR: Decimal,\n        userTDEE: Decimal,\n        editingExercise: ExerciseRecord? = nil,\n        selectedDate: Date = Date()\n    ) {\n        self.addExerciseRecordUseCase = addExerciseRecordUseCase\n        self.updateExerciseRecordUseCase = updateExerciseRecordUseCase\n        self.editingExercise = editingExercise\n        self.userId = userId\n        self.userWeight = userWeight\n        self.userBMR = userBMR\n        self.userTDEE = userTDEE\n        self.selectedDate = selectedDate\n\n        // \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Pre-fill Form in Edit Mode\n        // \ud3b8\uc9d1 \ubaa8\ub4dc\uc77c \ub54c\ub294 \uae30\uc874 \uc6b4\ub3d9 \uae30\ub85d \ub370\uc774\ud130\ub85c \ud3fc \ucd08\uae30\ud654\n        // \ud83d\udca1 Java \ube44\uad50: Intent extras\ub85c \uc804\ub2ec\ubc1b\uc740 \ub370\uc774\ud130\ub85c UI \ucd08\uae30\ud654\uc640 \uc720\uc0ac\n        if let exercise = editingExercise {\n            self.selectedExerciseType = exercise.exerciseType\n            self.duration = exercise.duration\n            self.selectedIntensity = exercise.intensity\n            self.note = exercise.note ?? \"\"\n            self.selectedDate = exercise.date\n        }\n    }\n\n    // MARK: - Public Methods\n\n    /// \uc6b4\ub3d9 \uae30\ub85d\uc744 \uc800\uc7a5\ud569\ub2c8\ub2e4.\n    ///\n    /// ## \uc2e4\ud589 \uc21c\uc11c\n    /// 1. \uc785\ub825\uac12 \uac80\uc99d\n    /// 2. \ub85c\ub529 \uc0c1\ud0dc \uc2dc\uc791\n    /// 3. AddExerciseRecordUseCase \ud638\ucd9c\n    /// 4. \uc131\uacf5 \uc2dc isSaveSuccess = true\n    /// 5. \uc2e4\ud328 \uc2dc errorMessage \uc124\uc815\n    ///\n    /// - Note: \uc131\uacf5 \uc2dc View\uac00 dismiss\ub418\ub3c4\ub85d isSaveSuccess \ud50c\ub798\uadf8 \uc0ac\uc6a9\n    ///\n    /// - Example:\n    /// ```swift\n    /// Button(\"\uc800\uc7a5\") {\n    ///     Task {\n    ///         await viewModel.save()\n    ///     }\n    /// }\n    /// .onChange(of: viewModel.isSaveSuccess) { success in\n    ///     if success {\n    ///         dismiss()\n    ///     }\n    /// }\n    /// ```\n    @MainActor\n    func save() async {\n        // 1. \uc785\ub825\uac12 \uac80\uc99d\n        guard isFormValid else {\n            errorMessage = \"\uc6b4\ub3d9 \uc2dc\uac04\uc740 \ucd5c\uc18c 1\ubd84 \uc774\uc0c1\uc774\uc5b4\uc57c \ud569\ub2c8\ub2e4.\"\n            return\n        }\n\n        // 2. \ub85c\ub529 \uc0c1\ud0dc \uc2dc\uc791\n        isSaving = true\n        errorMessage = nil\n        defer { isSaving = false }\n\n        do {\n            // 3. UseCase \ud638\ucd9c (\ud3b8\uc9d1 \ubaa8\ub4dc or \ucd94\uac00 \ubaa8\ub4dc)\n            // \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Conditional Logic for Add/Update\n            // editingExercise \uc720\ubb34\ub85c \ucd94\uac00/\uc218\uc815 \ubaa8\ub4dc \uad6c\ubd84\n            // \ud83d\udca1 Java \ube44\uad50: id != null ? update() : create() \ud328\ud134\uacfc \uc720\uc0ac\n\n            if let editingExercise = editingExercise,\n               let updateUseCase = updateExerciseRecordUseCase {\n                // \ud3b8\uc9d1 \ubaa8\ub4dc: UpdateExerciseRecordUseCase \ud638\ucd9c\n                _ = try await updateUseCase.execute(\n                    recordId: editingExercise.id,\n                    userId: userId,\n                    date: selectedDate,\n                    exerciseType: selectedExerciseType,\n                    duration: duration,\n                    intensity: selectedIntensity,\n                    note: note.isEmpty ? nil : note,\n                    userWeight: userWeight,\n                    userBMR: userBMR,\n                    userTDEE: userTDEE\n                )\n            } else {\n                // \ucd94\uac00 \ubaa8\ub4dc: AddExerciseRecordUseCase \ud638\ucd9c\n                _ = try await addExerciseRecordUseCase.execute(\n                    userId: userId,\n                    date: selectedDate,\n                    exerciseType: selectedExerciseType,\n                    duration: duration,\n                    intensity: selectedIntensity,\n                    note: note.isEmpty ? nil : note,\n                    userWeight: userWeight,\n                    userBMR: userBMR,\n                    userTDEE: userTDEE\n                )\n            }\n\n            // 4. \uc131\uacf5\n            isSaveSuccess = true\n\n        } catch {\n            // 5. \uc2e4\ud328\n            // \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Error Handling\n            // Swift\uc758 Error \ud504\ub85c\ud1a0\ucf5c\uc744 \uc0ac\uc6a9\ud55c \uc5d0\ub7ec \ucc98\ub9ac\n            // localizedDescription\uc73c\ub85c \uc0ac\uc6a9\uc790 \uce5c\ud654\uc801 \uba54\uc2dc\uc9c0 \uc81c\uacf5\n            errorMessage = \"\uc6b4\ub3d9 \uae30\ub85d \uc800\uc7a5 \uc2e4\ud328: \\(error.localizedDescription)\"\n        }\n    }\n\n    /// \ud3fc\uc744 \ucd08\uae30\ud654\ud569\ub2c8\ub2e4.\n    ///\n    /// \ubaa8\ub4e0 \uc785\ub825\uac12\uc744 \uae30\ubcf8\uac12\uc73c\ub85c \ub9ac\uc14b\ud569\ub2c8\ub2e4.\n    ///\n    /// - Note: \uc8fc\ub85c \uc800\uc7a5 \uc131\uacf5 \ud6c4 \ub610\ub294 \ucde8\uc18c \uc2dc \uc0ac\uc6a9\n    ///\n    /// - Example:\n    /// ```swift\n    /// Button(\"\ucde8\uc18c\") {\n    ///     viewModel.reset()\n    ///     dismiss()\n    /// }\n    /// ```\n    func reset() {\n        selectedExerciseType = .running\n        duration = 30\n        selectedIntensity = .medium\n        note = \"\"\n        selectedDate = Date()\n        errorMessage = nil\n        isSaveSuccess = false\n    }\n\n    /// \uc5d0\ub7ec \uba54\uc2dc\uc9c0\ub97c \uc9c0\uc6c1\ub2c8\ub2e4.\n    ///\n    /// \uc5d0\ub7ec \uc54c\ub9bc\uc744 \ub2eb\uc744 \ub54c \ud638\ucd9c\ud569\ub2c8\ub2e4.\n    ///\n    /// - Example:\n    /// ```swift\n    /// .alert(\"\uc624\ub958\", isPresented: $viewModel.hasError) {\n    ///     Button(\"\ud655\uc778\") { viewModel.clearError() }\n    /// }\n    /// ```\n    func clearError() {\n        errorMessage = nil\n    }\n\n    /// \uc6b4\ub3d9 \uc885\ub958\ub97c \uc120\ud0dd\ud569\ub2c8\ub2e4.\n    ///\n    /// - Parameter type: \uc120\ud0dd\ud560 \uc6b4\ub3d9 \uc885\ub958\n    ///\n    /// - Note: \uc120\ud0dd \uc2dc previewCalories\uac00 \uc790\ub3d9\uc73c\ub85c \uc7ac\uacc4\uc0b0\ub428\n    ///\n    /// - Example:\n    /// ```swift\n    /// Button(exerciseType.displayName) {\n    ///     viewModel.selectExerciseType(exerciseType)\n    /// }\n    /// ```\n    func selectExerciseType(_ type: ExerciseType) {\n        selectedExerciseType = type\n    }\n\n    /// \uac15\ub3c4\ub97c \uc120\ud0dd\ud569\ub2c8\ub2e4.\n    ///\n    /// - Parameter intensity: \uc120\ud0dd\ud560 \uac15\ub3c4\n    ///\n    /// - Note: \uc120\ud0dd \uc2dc previewCalories\uac00 \uc790\ub3d9\uc73c\ub85c \uc7ac\uacc4\uc0b0\ub428\n    ///\n    /// - Example:\n    /// ```swift\n    /// Picker(\"\uac15\ub3c4\", selection: $viewModel.selectedIntensity) {\n    ///     ForEach(Intensity.allCases) { intensity in\n    ///         Text(intensity.displayName).tag(intensity)\n    ///     }\n    /// }\n    /// ```\n    func selectIntensity(_ intensity: Intensity) {\n        selectedIntensity = intensity\n    }\n\n    /// \uc6b4\ub3d9 \uc2dc\uac04\uc744 \uc124\uc815\ud569\ub2c8\ub2e4.\n    ///\n    /// - Parameter minutes: \uc6b4\ub3d9 \uc2dc\uac04 (\ubd84)\n    ///\n    /// - Note: 0 \uc774\uc0c1\uc758 \uac12\ub9cc \ud5c8\uc6a9\n    /// - Note: \uc124\uc815 \uc2dc previewCalories\uac00 \uc790\ub3d9\uc73c\ub85c \uc7ac\uacc4\uc0b0\ub428\n    ///\n    /// - Example:\n    /// ```swift\n    /// Stepper(\"\\(viewModel.duration)\ubd84\", value: Binding(\n    ///     get: { Int(viewModel.duration) },\n    ///     set: { viewModel.setDuration(Int32($0)) }\n    /// ), in: 1...300)\n    /// ```\n    func setDuration(_ minutes: Int32) {\n        duration = max(0, minutes)\n    }\n}\n\n// MARK: - Validation Helpers\n\nextension ExerciseInputViewModel {\n\n    /// \uc6b4\ub3d9 \uc2dc\uac04 \uac80\uc99d \uc5d0\ub7ec \uba54\uc2dc\uc9c0\n    ///\n    /// - Returns: \uac80\uc99d \uc5d0\ub7ec\uac00 \uc788\uc73c\uba74 \uba54\uc2dc\uc9c0, \uc5c6\uc73c\uba74 nil\n    var durationValidationError: String? {\n        if duration < 1 {\n            return \"\ucd5c\uc18c 1\ubd84 \uc774\uc0c1 \uc785\ub825\ud574\uc8fc\uc138\uc694\"\n        }\n        return nil\n    }\n}\n\n// MARK: - Learning Notes\n\n/// ## Form ViewModel Pattern\n///\n/// Form ViewModel\uc740 \uc0ac\uc6a9\uc790 \uc785\ub825 \ud3fc\uc758 \uc0c1\ud0dc\uc640 \ub85c\uc9c1\uc744 \uad00\ub9ac\ud558\ub294 \ud328\ud134\uc785\ub2c8\ub2e4.\n///\n/// ### \uc8fc\uc694 \ucc45\uc784\n///\n/// 1. **Form State Management**:\n///    - \uac01 \uc785\ub825 \ud544\ub4dc\uc758 \uac12 \uc800\uc7a5 (selectedExerciseType, duration, selectedIntensity, note)\n///    - \uc785\ub825\uac12 \ubcc0\uacbd \uc2dc \uc790\ub3d9\uc73c\ub85c View \uc5c5\ub370\uc774\ud2b8\n///\n/// 2. **Real-time Validation**:\n///    - \uc785\ub825\uac12\uc774 \ubcc0\uacbd\ub420 \ub54c\ub9c8\ub2e4 \uac80\uc99d (isFormValid)\n///    - \uc5d0\ub7ec \uba54\uc2dc\uc9c0 \ud45c\uc2dc (durationValidationError)\n///\n/// 3. **Real-time Preview**:\n///    - \uc785\ub825\uac12\uc744 \uae30\ubc18\uc73c\ub85c \uacb0\uacfc \ubbf8\ub9ac\ubcf4\uae30 (previewCalories)\n///    - Computed Property\ub85c \uc790\ub3d9 \uc7ac\uacc4\uc0b0\n///\n/// 4. **Submit Action**:\n///    - \uc800\uc7a5 \uc561\uc158 \ucc98\ub9ac (save)\n///    - \ub85c\ub529 \uc0c1\ud0dc \uad00\ub9ac (isSaving)\n///    - \uc131\uacf5/\uc2e4\ud328 \ucc98\ub9ac (isSaveSuccess, errorMessage)\n///\n/// ### Form ViewModel vs List ViewModel\n///\n/// **List ViewModel** (ExerciseListViewModel):\n/// - \ub370\uc774\ud130 \uc870\ud68c \ubc0f \ud45c\uc2dc\n/// - \uc77d\uae30 \uc804\uc6a9 \uc791\uc5c5 \uc704\uc8fc\n/// - \uc608: \uc6b4\ub3d9 \uae30\ub85d \ubaa9\ub85d \uc870\ud68c\n///\n/// **Form ViewModel** (ExerciseInputViewModel):\n/// - \ub370\uc774\ud130 \uc785\ub825 \ubc0f \uc0dd\uc131\n/// - \uc4f0\uae30 \uc791\uc5c5 \uc704\uc8fc\n/// - \uc608: \uc0c8\ub85c\uc6b4 \uc6b4\ub3d9 \uae30\ub85d \ucd94\uac00\n///\n/// ### Real-time Calorie Preview\n///\n/// ```swift\n/// var previewCalories: Int32 {\n///     // \ud3fc \uc0c1\ud0dc\uac00 \ubcc0\uacbd\ub420 \ub54c\ub9c8\ub2e4 \uc790\ub3d9 \uc2e4\ud589\n///     ExerciseCalcService.calculateCalories(\n///         exerciseType: selectedExerciseType,  // \ubcc0\uacbd\ub418\uba74 \uc7ac\uacc4\uc0b0\n///         duration: duration,                   // \ubcc0\uacbd\ub418\uba74 \uc7ac\uacc4\uc0b0\n///         intensity: selectedIntensity,         // \ubcc0\uacbd\ub418\uba74 \uc7ac\uacc4\uc0b0\n///         weight: userWeight\n///     )\n/// }\n/// ```\n///\n/// @Observable \ub9e4\ud06c\ub85c \ub355\ubd84\uc5d0 selectedExerciseType, duration, selectedIntensity \uc911\n/// \uc5b4\ub5a4 \uac83\uc774\ub4e0 \ubcc0\uacbd\ub418\uba74 previewCalories\uac00 \uc790\ub3d9\uc73c\ub85c \uc7ac\uacc4\uc0b0\ub418\uace0 View\uac00 \uc5c5\ub370\uc774\ud2b8\ub429\ub2c8\ub2e4.\n///\n/// ### Validation Pattern\n///\n/// **Immediate Validation**:\n/// ```swift\n/// var isFormValid: Bool {\n///     duration >= 1\n/// }\n///\n/// var durationValidationError: String? {\n///     if duration < 1 { return \"\ucd5c\uc18c 1\ubd84 \uc774\uc0c1\" }\n///     return nil\n/// }\n/// ```\n///\n/// **Submit Time Validation**:\n/// ```swift\n/// func save() async {\n///     guard isFormValid else {\n///         errorMessage = \"\uc785\ub825\uac12\uc744 \ud655\uc778\ud574\uc8fc\uc138\uc694\"\n///         return\n///     }\n///     // \uc800\uc7a5 \ub85c\uc9c1\n/// }\n/// ```\n///\n/// ### UI Integration\n///\n/// **Form Binding**:\n/// ```swift\n/// struct ExerciseInputView: View {\n///     var viewModel: ExerciseInputViewModel\n///\n///     var body: some View {\n///         VStack {\n///             // \uc6b4\ub3d9 \uc885\ub958 \uc120\ud0dd\n///             ExerciseTypeGridView(\n///                 selectedType: Binding(\n///                     get: { viewModel.selectedExerciseType },\n///                     set: { viewModel.selectExerciseType($0) }\n///                 )\n///             )\n///\n///             // \uc6b4\ub3d9 \uc2dc\uac04 \uc785\ub825\n///             Stepper(\"\\(viewModel.duration)\ubd84\",\n///                 value: Binding(\n///                     get: { Int(viewModel.duration) },\n///                     set: { viewModel.setDuration(Int32($0)) }\n///                 )\n///             )\n///\n///             // \uc2e4\uc2dc\uac04 \uce7c\ub85c\ub9ac \ubbf8\ub9ac\ubcf4\uae30\n///             Text(\"\uc608\uc0c1 \uc18c\ubaa8: \\(viewModel.previewCalories)kcal\")\n///                 .font(.headline)\n///\n///             // \uc800\uc7a5 \ubc84\ud2bc\n///             Button(\"\uc800\uc7a5\") {\n///                 Task { await viewModel.save() }\n///             }\n///             .disabled(!viewModel.isFormValid || viewModel.isSaving)\n///         }\n///         .onChange(of: viewModel.isSaveSuccess) { success in\n///             if success { dismiss() }\n///         }\n///         .alert(\"\uc624\ub958\", isPresented: Binding(\n///             get: { viewModel.hasError },\n///             set: { _ in viewModel.clearError() }\n///         )) {\n///             Button(\"\ud655\uc778\") { viewModel.clearError() }\n///         } message: {\n///             Text(viewModel.errorMessage ?? \"\")\n///         }\n///     }\n/// }\n/// ```\n///\n/// ### Testing\n///\n/// Form ViewModel\uc740 \uc758\uc874\uc131 \uc8fc\uc785\uc744 \ud1b5\ud574 \uc27d\uac8c \ud14c\uc2a4\ud2b8\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4:\n///\n/// ```swift\n/// func testPreviewCaloriesCalculation() {\n///     // given\n///     let mockUseCase = MockAddExerciseRecordUseCase()\n///     let viewModel = ExerciseInputViewModel(\n///         addExerciseRecordUseCase: mockUseCase,\n///         userId: UUID(),\n///         userWeight: 70.0,\n///         userBMR: 1650,\n///         userTDEE: 2310\n///     )\n///\n///     // when\n///     viewModel.selectedExerciseType = .running  // 8.0 MET\n///     viewModel.duration = 30                    // 0.5 hours\n///     viewModel.selectedIntensity = .medium      // 1.0 multiplier\n///\n///     // then\n///     // 8.0 \u00d7 1.0 \u00d7 70 \u00d7 0.5 = 280 kcal\n///     XCTAssertEqual(viewModel.previewCalories, 280)\n/// }\n///\n/// func testFormValidation() {\n///     // given\n///     let viewModel = ExerciseInputViewModel(...)\n///\n///     // when\n///     viewModel.duration = 0\n///\n///     // then\n///     XCTAssertFalse(viewModel.isFormValid)\n///     XCTAssertEqual(viewModel.durationValidationError, \"\ucd5c\uc18c 1\ubd84 \uc774\uc0c1 \uc785\ub825\ud574\uc8fc\uc138\uc694\")\n/// }\n///\n/// func testSaveSuccess() async {\n///     // given\n///     let mockUseCase = MockAddExerciseRecordUseCase()\n///     let viewModel = ExerciseInputViewModel(\n///         addExerciseRecordUseCase: mockUseCase,\n///         userId: UUID(),\n///         userWeight: 70.0,\n///         userBMR: 1650,\n///         userTDEE: 2310\n///     )\n///     viewModel.duration = 30\n///\n///     // when\n///     await viewModel.save()\n///\n///     // then\n///     XCTAssertTrue(viewModel.isSaveSuccess)\n///     XCTAssertFalse(viewModel.hasError)\n///     XCTAssertTrue(mockUseCase.executeCalled)\n/// }\n/// ```\n///\n/// ### Best Practices\n///\n/// 1. **Computed Properties for Derived State**:\n///    - previewCalories\ub294 \uc800\uc7a5\ud558\uc9c0 \uc54a\uace0 \uacc4\uc0b0 (\ud56d\uc0c1 \ucd5c\uc2e0 \uc0c1\ud0dc \ubcf4\uc7a5)\n///\n/// 2. **Validation in Multiple Layers**:\n///    - UI \ub808\ubca8: isFormValid\ub85c \ubc84\ud2bc disable\n///    - Submit \ub808\ubca8: save()\uc5d0\uc11c guard \uac80\uc99d\n///    - UseCase \ub808\ubca8: AddExerciseRecordUseCase\uc5d0\uc11c \ucd5c\uc885 \uac80\uc99d\n///\n/// 3. **Clear Success Indicator**:\n///    - isSaveSuccess \ud50c\ub798\uadf8\ub85c View dismiss \uc2dc\uc810 \uba85\ud655\ud788\n///\n/// 4. **Reset Method**:\n///    - \uc800\uc7a5 \uc131\uacf5 \ud6c4 \ud3fc \uc7ac\uc0ac\uc6a9\uc744 \uc704\ud55c reset() \uc81c\uacf5\n///\n/// 5. **Immutable Dependencies**:\n///    - userWeight, userBMR, userTDEE\ub294 let\uc73c\ub85c \ubd88\ubcc0\uc131 \ubcf4\uc7a5\n///    - ViewModel \uc0dd\uc131 \uc2dc\uc810\uc758 \uac12\uc73c\ub85c \uace0\uc815\n",
        "last_modified": "2026-01-14T22:54:09.703468"
      },
      "task_intent": {
        "title": "008-exercise-tracking-with-met-calculations",
        "description": "Exercise logging with activity type selection, duration input, and automatic calorie burn calculation using MET (Metabolic Equivalent of Task) values. Track both cardio and strength training with appropriate calculations.",
        "from_plan": true
      },
      "commits_behind_main": 0,
      "status": "active",
      "merged_at": null
    }
  },
  "created_at": "2026-01-13T19:19:06.009387",
  "last_updated": "2026-01-14T11:45:41.995504"
}