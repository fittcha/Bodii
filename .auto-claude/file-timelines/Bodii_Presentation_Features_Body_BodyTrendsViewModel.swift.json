{
  "file_path": "Bodii/Presentation/Features/Body/BodyTrendsViewModel.swift",
  "main_branch_history": [],
  "task_views": {
    "003-body-composition-tracking-with-bmr-tdee": {
      "task_id": "003-body-composition-tracking-with-bmr-tdee",
      "branch_point": {
        "commit_hash": "2abdae73fb6199bcbf4f21f6deeb7952225f81e6",
        "content": "",
        "timestamp": "2026-01-13T07:46:22.394743"
      },
      "worktree_state": {
        "content": "//\n//  BodyTrendsViewModel.swift\n//  Bodii\n//\n//  Created by Auto-Claude on 2026-01-12.\n//\n\n// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Chart-Focused ViewModel Pattern\n// \ucc28\ud2b8 \ub370\uc774\ud130 \uad00\ub9ac\uc640 \uae30\uac04 \uc120\ud0dd\uc744 \uc704\ud55c ViewModel\n// \ud83d\udca1 Java \ube44\uad50: Android\uc758 ViewModel\uacfc \uc720\uc0ac\ud558\uc9c0\ub9cc \ucc28\ud2b8 \uc804\uc6a9 \uc0c1\ud0dc \uad00\ub9ac\n\nimport Foundation\nimport SwiftUI\nimport Combine\n\n// MARK: - BodyTrendsViewModel\n\n/// \uc2e0\uccb4 \uad6c\uc131 \ud2b8\ub80c\ub4dc \ucc28\ud2b8\ub97c \uc704\ud55c ViewModel\n/// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Chart Data Management\n/// - \ucc28\ud2b8 \ud45c\uc2dc\ub97c \uc704\ud55c \ud2b8\ub80c\ub4dc \ub370\uc774\ud130 \uad00\ub9ac\n/// - \uae30\uac04 \uc120\ud0dd \ubc0f \ub124\ube44\uac8c\uc774\uc158 \ucc98\ub9ac\n/// - \ube48 \uc0c1\ud0dc \ubc0f \ub85c\ub529 \uc0c1\ud0dc \uad00\ub9ac\n/// \ud83d\udca1 Java \ube44\uad50: Android ViewModel + Chart data transformation\n@MainActor\nclass BodyTrendsViewModel: ObservableObject {\n\n    // MARK: - Published Properties (View State)\n\n    /// \uc120\ud0dd\ub41c \ud2b8\ub80c\ub4dc \uae30\uac04\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: User Selection State\n    /// - \uc0ac\uc6a9\uc790\uac00 \uc120\ud0dd\ud55c \uae30\uac04 (7\uc77c/30\uc77c/90\uc77c)\n    /// - \ubcc0\uacbd \uc2dc \uc790\ub3d9\uc73c\ub85c \ub370\uc774\ud130 \ub2e4\uc2dc \ub85c\ub4dc\n    /// \ud83d\udca1 Java \ube44\uad50: LiveData<TrendPeriod>\uc640 \uc720\uc0ac\n    @Published var selectedPeriod: FetchBodyTrendsUseCase.TrendPeriod = .week\n\n    /// \ud2b8\ub80c\ub4dc \ub370\uc774\ud130 \ucd9c\ub825\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Optional State\n    /// - nil\uc774\uba74 \uc544\uc9c1 \ub370\uc774\ud130 \ub85c\ub4dc \uc548 \ub428\n    /// - \uac12\uc774 \uc788\uc73c\uba74 \ucc28\ud2b8\uc5d0 \ud45c\uc2dc\n    @Published var trendsOutput: FetchBodyTrendsUseCase.Output?\n\n    /// \ub85c\ub529 \uc0c1\ud0dc\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Loading State\n    /// - \ub370\uc774\ud130 \uc870\ud68c \uc911 \ub85c\ub529 \uc778\ub514\ucf00\uc774\ud130 \ud45c\uc2dc\n    @Published var isLoading: Bool = false\n\n    /// \uc5d0\ub7ec \uba54\uc2dc\uc9c0\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Error State\n    /// - nil\uc774\uba74 \uc5d0\ub7ec \uc5c6\uc74c\n    /// - \uac12\uc774 \uc788\uc73c\uba74 \uc5d0\ub7ec \uba54\uc2dc\uc9c0 \ud45c\uc2dc\n    @Published var errorMessage: String?\n\n    /// \ub300\uc0ac\uc728 \ub370\uc774\ud130 \ud3ec\ud568 \uc5ec\ubd80\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Toggle State\n    /// - \ucc28\ud2b8\uc5d0 BMR/TDEE \uc815\ubcf4 \ud45c\uc2dc \uc5ec\ubd80\n    /// - \uc131\ub2a5 \ucd5c\uc801\ud654\ub97c \uc704\ud574 \uc120\ud0dd\uc801 \ub85c\ub529\n    @Published var includeMetabolismData: Bool = false\n\n    /// \ucee4\uc2a4\ud140 \ub0a0\uc9dc \ubc94\uc704 \uc0ac\uc6a9 \uc5ec\ubd80\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Advanced Feature Toggle\n    /// - false: TrendPeriod \uc0ac\uc6a9\n    /// - true: customStartDate/customEndDate \uc0ac\uc6a9\n    @Published var useCustomDateRange: Bool = false\n\n    /// \ucee4\uc2a4\ud140 \uc2dc\uc791 \ub0a0\uc9dc\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Custom Date Range\n    /// - useCustomDateRange\uac00 true\uc77c \ub54c\ub9cc \uc0ac\uc6a9\n    @Published var customStartDate: Date = Calendar.current.date(byAdding: .day, value: -7, to: Date())!\n\n    /// \ucee4\uc2a4\ud140 \uc885\ub8cc \ub0a0\uc9dc\n    @Published var customEndDate: Date = Date()\n\n    // MARK: - Private Properties\n\n    /// \uc2e0\uccb4 \ud2b8\ub80c\ub4dc \uc870\ud68c Use Case\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Dependency Injection\n    /// - Use Case\ub97c \uc678\ubd80\uc5d0\uc11c \uc8fc\uc785\ubc1b\uc544 \uc0ac\uc6a9\n    /// - \ud14c\uc2a4\ud2b8 \uc2dc Mock\uc73c\ub85c \uad50\uccb4 \uac00\ub2a5\n    private let fetchBodyTrendsUseCase: FetchBodyTrendsUseCase\n\n    /// \uc2e0\uccb4 \ub370\uc774\ud130 \uc800\uc7a5\uc18c\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Protocol-Oriented Programming\n    /// - \uc9c1\uc811 \uc870\ud68c\uac00 \ud544\uc694\ud55c \uacbd\uc6b0\ub97c \uc704\ud574 Repository\ub3c4 \ubcf4\uc720\n    private let bodyRepository: BodyRepositoryProtocol\n\n    /// Combine \uad6c\ub3c5 \uc800\uc7a5\uc18c\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Reactive Programming\n    /// - selectedPeriod \ubcc0\uacbd \uc2dc \uc790\ub3d9\uc73c\ub85c \ub370\uc774\ud130 \ub2e4\uc2dc \ub85c\ub4dc\n    /// - \uba54\ubaa8\ub9ac \ub204\uc218 \ubc29\uc9c0\ub97c \uc704\ud55c \uad6c\ub3c5 \uad00\ub9ac\n    /// \ud83d\udca1 Java \ube44\uad50: RxJava\uc758 CompositeDisposable\uacfc \uc720\uc0ac\n    private var cancellables = Set<AnyCancellable>()\n\n    // MARK: - Initialization\n\n    /// BodyTrendsViewModel \ucd08\uae30\ud654\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Dependency Injection via Constructor\n    /// - \ubaa8\ub4e0 \uc758\uc874\uc131\uc744 \uc0dd\uc131\uc790\ub97c \ud1b5\ud574 \uc8fc\uc785\ubc1b\uc74c\n    /// - \uc758\uc874\uc131 \uc5ed\uc804 \uc6d0\uce59 (Dependency Inversion Principle) \uc900\uc218\n    /// \ud83d\udca1 Java \ube44\uad50: @Inject constructor\uc640 \uc720\uc0ac\n    ///\n    /// - Parameters:\n    ///   - fetchBodyTrendsUseCase: \uc2e0\uccb4 \ud2b8\ub80c\ub4dc \uc870\ud68c Use Case\n    ///   - bodyRepository: \uc2e0\uccb4 \ub370\uc774\ud130 \uc800\uc7a5\uc18c\n    init(\n        fetchBodyTrendsUseCase: FetchBodyTrendsUseCase,\n        bodyRepository: BodyRepositoryProtocol\n    ) {\n        self.fetchBodyTrendsUseCase = fetchBodyTrendsUseCase\n        self.bodyRepository = bodyRepository\n\n        // \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Reactive State Observation\n        // selectedPeriod \ubcc0\uacbd \uc2dc \uc790\ub3d9\uc73c\ub85c \ub370\uc774\ud130 \ub2e4\uc2dc \ub85c\ub4dc\n        setupPeriodObserver()\n\n        // \ucd08\uae30 \ub370\uc774\ud130 \ub85c\ub4dc\n        Task {\n            await loadTrends()\n        }\n    }\n\n    // MARK: - Computed Properties\n\n    /// \ub370\uc774\ud130\uac00 \ube44\uc5b4\uc788\ub294\uc9c0 \ud655\uc778\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Computed Property for Empty State\n    /// - View\uc5d0\uc11c empty state UI \ud45c\uc2dc \uc5ec\ubd80 \uacb0\uc815\n    var isEmpty: Bool {\n        trendsOutput?.isEmpty ?? true\n    }\n\n    /// \ub370\uc774\ud130 \ud3ec\uc778\ud2b8 \uac1c\uc218\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Quick Access Property\n    /// - UI\uc5d0\uc11c \ubc14\ub85c \uc0ac\uc6a9\ud560 \uc218 \uc788\ub294 \ud3b8\uc758 \uc18d\uc131\n    var dataPointCount: Int {\n        trendsOutput?.count ?? 0\n    }\n\n    /// \ucc28\ud2b8 \ub370\uc774\ud130 \ud3ec\uc778\ud2b8\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Convenience Property\n    /// - View\uc5d0\uc11c \uc9c1\uc811 \uc811\uadfc \uac00\ub2a5\ud55c \ub370\uc774\ud130 \ud3ec\uc778\ud2b8 \ubc30\uc5f4\n    var dataPoints: [FetchBodyTrendsUseCase.TrendDataPoint] {\n        trendsOutput?.dataPoints ?? []\n    }\n\n    /// \uae30\uac04 \ud45c\uc2dc \ubb38\uc790\uc5f4\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: UI Helper Property\n    /// - \"2024.01.01 - 2024.01.07\" \ud615\uc2dd\n    var periodDisplayString: String {\n        guard let output = trendsOutput else { return \"\" }\n\n        let formatter = DateFormatter()\n        formatter.dateStyle = .short\n        formatter.timeStyle = .none\n        formatter.locale = Locale(identifier: \"ko_KR\")\n\n        let startStr = formatter.string(from: output.startDate)\n        let endStr = formatter.string(from: output.endDate)\n\n        return \"\\(startStr) - \\(endStr)\"\n    }\n\n    // MARK: - Public Methods\n\n    /// \ud2b8\ub80c\ub4dc \ub370\uc774\ud130 \ub85c\ub4dc\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Async Data Loading\n    /// - Use Case\ub97c \ud638\ucd9c\ud558\uc5ec \ub370\uc774\ud130 \uc870\ud68c\n    /// - \ub85c\ub529 \uc0c1\ud0dc \ubc0f \uc5d0\ub7ec \ucc98\ub9ac\n    /// \ud83d\udca1 Java \ube44\uad50: Kotlin Coroutines\uc758 suspend function\uacfc \uc720\uc0ac\n    func loadTrends() async {\n        isLoading = true\n        errorMessage = nil\n\n        do {\n            // \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Conditional Query Strategy\n            // \ucee4\uc2a4\ud140 \ub0a0\uc9dc \ubc94\uc704 \uc0ac\uc6a9 \uc5ec\ubd80\uc5d0 \ub530\ub77c \ub2e4\ub978 \uba54\uc11c\ub4dc \ud638\ucd9c\n            if useCustomDateRange {\n                // \ucee4\uc2a4\ud140 \ub0a0\uc9dc \ubc94\uc704\ub85c \uc870\ud68c\n                let input = FetchBodyTrendsUseCase.Input(\n                    period: selectedPeriod,\n                    endDate: customEndDate,\n                    includeMetabolismData: includeMetabolismData\n                )\n                trendsOutput = try await fetchBodyTrendsUseCase.execute(input: input)\n            } else {\n                // \ud45c\uc900 \uae30\uac04\uc73c\ub85c \uc870\ud68c\n                let input = FetchBodyTrendsUseCase.Input(\n                    period: selectedPeriod,\n                    includeMetabolismData: includeMetabolismData\n                )\n                trendsOutput = try await fetchBodyTrendsUseCase.execute(input: input)\n            }\n\n        } catch let error as FetchBodyTrendsUseCase.TrendsError {\n            // \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Specific Error Handling\n            // Use Case\uc758 \ub3c4\uba54\uc778 \uc5d0\ub7ec\ub97c \uc0ac\uc6a9\uc790 \uce5c\ud654\uc801 \uba54\uc2dc\uc9c0\ub85c \ubcc0\ud658\n            errorMessage = error.localizedDescription\n            trendsOutput = nil\n        } catch {\n            // \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Generic Error Handling\n            errorMessage = \"\ud2b8\ub80c\ub4dc \ub370\uc774\ud130 \ub85c\ub4dc \uc2e4\ud328: \\(error.localizedDescription)\"\n            trendsOutput = nil\n        }\n\n        isLoading = false\n    }\n\n    /// \uae30\uac04 \ubcc0\uacbd\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: State Update Method\n    /// - \uae30\uac04 \ubcc0\uacbd \uc2dc \uc790\ub3d9\uc73c\ub85c \ub370\uc774\ud130 \ub2e4\uc2dc \ub85c\ub4dc (observer\ub97c \ud1b5\ud574)\n    ///\n    /// - Parameter period: \uc0c8\ub85c\uc6b4 \uae30\uac04\n    func changePeriod(to period: FetchBodyTrendsUseCase.TrendPeriod) {\n        selectedPeriod = period\n        useCustomDateRange = false\n    }\n\n    /// \uc774\uc804 \uae30\uac04\uc73c\ub85c \uc774\ub3d9\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Date Range Navigation\n    /// - \ud604\uc7ac \uae30\uac04\ub9cc\ud07c \uacfc\uac70\ub85c \uc774\ub3d9\n    /// - \uc608: 7\uc77c \uae30\uac04\uc774\uba74 7\uc77c \uc804\uc73c\ub85c \uc774\ub3d9\n    func navigateToPreviousPeriod() async {\n        // \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Date Calculation\n        // \ud604\uc7ac \uc885\ub8cc \ub0a0\uc9dc\uc5d0\uc11c \uae30\uac04\ub9cc\ud07c \uc774\uc804\uc73c\ub85c \uc774\ub3d9\n        let days = selectedPeriod.days\n\n        if useCustomDateRange {\n            // \ucee4\uc2a4\ud140 \ub0a0\uc9dc \ubc94\uc704 \uc0ac\uc6a9 \uc911\n            customEndDate = customStartDate\n            customStartDate = Calendar.current.date(byAdding: .day, value: -days, to: customStartDate) ?? customStartDate\n        } else {\n            // \ud45c\uc900 \uae30\uac04 \uc0ac\uc6a9 \uc911 \u2192 \ucee4\uc2a4\ud140 \ubaa8\ub4dc\ub85c \uc804\ud658\n            useCustomDateRange = true\n            let now = Date()\n            customEndDate = Calendar.current.date(byAdding: .day, value: -days, to: now) ?? now\n            customStartDate = Calendar.current.date(byAdding: .day, value: -days*2, to: now) ?? now\n        }\n\n        await loadTrends()\n    }\n\n    /// \ub2e4\uc74c \uae30\uac04\uc73c\ub85c \uc774\ub3d9\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Date Range Navigation\n    /// - \ud604\uc7ac \uae30\uac04\ub9cc\ud07c \ubbf8\ub798\ub85c \uc774\ub3d9 (\ucd5c\ub300 \ud604\uc7ac\uae4c\uc9c0)\n    func navigateToNextPeriod() async {\n        let days = selectedPeriod.days\n\n        if useCustomDateRange {\n            // \ucee4\uc2a4\ud140 \ub0a0\uc9dc \ubc94\uc704 \uc0ac\uc6a9 \uc911\n            let newEndDate = Calendar.current.date(byAdding: .day, value: days, to: customEndDate) ?? customEndDate\n\n            // \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Future Date Prevention\n            // \ubbf8\ub798 \ub0a0\uc9dc\ub294 \ud604\uc7ac \ub0a0\uc9dc\ub85c \uc81c\ud55c\n            let now = Date()\n            if newEndDate > now {\n                // \ud604\uc7ac\ub85c \ub9ac\uc14b\n                useCustomDateRange = false\n            } else {\n                customStartDate = customEndDate\n                customEndDate = newEndDate\n            }\n        }\n\n        await loadTrends()\n    }\n\n    /// \ud604\uc7ac \ub0a0\uc9dc\ub85c \ub9ac\uc14b\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Reset to Default State\n    /// - \ucee4\uc2a4\ud140 \ub0a0\uc9dc \ubc94\uc704\ub97c \ud574\uc81c\ud558\uace0 \ud604\uc7ac \uae30\uc900\uc73c\ub85c \uc870\ud68c\n    func resetToCurrentPeriod() async {\n        useCustomDateRange = false\n        await loadTrends()\n    }\n\n    /// \ub300\uc0ac\uc728 \ub370\uc774\ud130 \ud3ec\ud568 \uc5ec\ubd80 \ud1a0\uae00\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Toggle with Auto-Reload\n    /// - \ud1a0\uae00 \ud6c4 \uc790\ub3d9\uc73c\ub85c \ub370\uc774\ud130 \ub2e4\uc2dc \ub85c\ub4dc\n    func toggleMetabolismData() async {\n        includeMetabolismData.toggle()\n        await loadTrends()\n    }\n\n    /// \uc0c8\ub85c\uace0\uce68\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Manual Refresh\n    /// - Pull-to-refresh \ub4f1\uc5d0\uc11c \uc0ac\uc6a9\n    func refresh() async {\n        await loadTrends()\n    }\n\n    // MARK: - Private Methods\n\n    /// \uae30\uac04 \ubcc0\uacbd \uac10\uc9c0 \uc124\uc815\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Combine Publisher Observation\n    /// - @Published \ud504\ub85c\ud37c\ud2f0 \ubcc0\uacbd\uc744 \uac10\uc9c0\ud558\uc5ec \uc790\ub3d9 \ub3d9\uc791 \uc2e4\ud589\n    /// - debounce\ub85c \uc5f0\uc18d \ubcc0\uacbd \uc2dc \ub9c8\uc9c0\ub9c9\ub9cc \ucc98\ub9ac\n    /// \ud83d\udca1 Java \ube44\uad50: RxJava\uc758 Observable.debounce()\uc640 \uc720\uc0ac\n    private func setupPeriodObserver() {\n        // selectedPeriod \ubcc0\uacbd \uc2dc \uc790\ub3d9\uc73c\ub85c \ub370\uc774\ud130 \ub2e4\uc2dc \ub85c\ub4dc\n        $selectedPeriod\n            .dropFirst() // \ucd08\uae30\uac12 \ubb34\uc2dc\n            .debounce(for: .milliseconds(300), scheduler: DispatchQueue.main) // 300ms \ub51c\ub808\uc774\n            .sink { [weak self] _ in\n                guard let self = self else { return }\n                Task {\n                    await self.loadTrends()\n                }\n            }\n            .store(in: &cancellables)\n    }\n\n    // MARK: - Helper Methods\n\n    /// \ub0a0\uc9dc \ud3ec\ub9f7\ud305\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Date Formatting Helper\n    /// - \uc77c\uad00\ub41c \ub0a0\uc9dc \ud45c\uc2dc\ub97c \uc704\ud55c \ud5ec\ud37c \uba54\uc11c\ub4dc\n    ///\n    /// - Parameters:\n    ///   - date: \ud3ec\ub9f7\ud560 \ub0a0\uc9dc\n    ///   - style: \ub0a0\uc9dc \uc2a4\ud0c0\uc77c (\uae30\ubcf8\uac12: .medium)\n    /// - Returns: \ud3ec\ub9f7\ub41c \ubb38\uc790\uc5f4\n    func formatDate(_ date: Date, style: DateFormatter.Style = .medium) -> String {\n        let formatter = DateFormatter()\n        formatter.dateStyle = style\n        formatter.timeStyle = .none\n        formatter.locale = Locale(identifier: \"ko_KR\")\n        return formatter.string(from: date)\n    }\n\n    /// \uccb4\uc911 \ubcc0\ud654\ub7c9 \ud3ec\ub9f7\ud305\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Number Formatting with Sign\n    /// - \uc591\uc218\ub294 +, \uc74c\uc218\ub294 - \uae30\ud638 \ud3ec\ud568\n    /// - \ubcc0\ud654 \uc5c6\uc74c\uc740 \"0.0\"\n    ///\n    /// - Parameter change: \ubcc0\ud654\ub7c9\n    /// - Returns: \ud3ec\ub9f7\ub41c \ubb38\uc790\uc5f4 (\uc608: \"+1.5 kg\", \"-0.8 kg\")\n    func formatWeightChange(_ change: Decimal?) -> String {\n        guard let change = change else { return \"-\" }\n\n        let formatter = NumberFormatter()\n        formatter.numberStyle = .decimal\n        formatter.maximumFractionDigits = 1\n        formatter.minimumFractionDigits = 1\n        formatter.positivePrefix = \"+\"\n\n        let number = NSDecimalNumber(decimal: change)\n        return (formatter.string(from: number) ?? \"\\(change)\") + \" kg\"\n    }\n\n    /// \uccb4\uc9c0\ubc29\ub960 \ubcc0\ud654\ub7c9 \ud3ec\ub9f7\ud305\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Percentage Formatting\n    /// - \ud37c\uc13c\ud2b8 \uae30\ud638 \ud3ec\ud568\n    ///\n    /// - Parameter change: \ubcc0\ud654\ub7c9\n    /// - Returns: \ud3ec\ub9f7\ub41c \ubb38\uc790\uc5f4 (\uc608: \"+2.0%\", \"-1.5%\")\n    func formatBodyFatChange(_ change: Decimal?) -> String {\n        guard let change = change else { return \"-\" }\n\n        let formatter = NumberFormatter()\n        formatter.numberStyle = .decimal\n        formatter.maximumFractionDigits = 1\n        formatter.minimumFractionDigits = 1\n        formatter.positivePrefix = \"+\"\n\n        let number = NSDecimalNumber(decimal: change)\n        return (formatter.string(from: number) ?? \"\\(change)\") + \"%\"\n    }\n}\n\n// MARK: - Preview Support\n\n#if DEBUG\nextension BodyTrendsViewModel {\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Preview Helper\n    /// SwiftUI Preview\ub97c \uc704\ud55c Mock ViewModel\n    /// \ud83d\udca1 Java \ube44\uad50: Test fixture\uc640 \uc720\uc0ac\n    static func makePreview() -> BodyTrendsViewModel {\n        // Mock Repository \uc0dd\uc131 (\uc2e4\uc81c \uad6c\ud604 \ud544\uc694)\n        fatalError(\"Preview support not yet implemented. Need to create MockBodyRepository.\")\n    }\n\n    /// \uc0d8\ud50c \ub370\uc774\ud130\uac00 \uc788\ub294 ViewModel\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Sample Data for Preview\n    /// - \ucc28\ud2b8 \ubbf8\ub9ac\ubcf4\uae30\ub97c \uc704\ud55c \uc0d8\ud50c \ub370\uc774\ud130 \ud3ec\ud568\n    static func makePreviewWithData(repository: BodyRepositoryProtocol) -> BodyTrendsViewModel {\n        let useCase = FetchBodyTrendsUseCase(bodyRepository: repository)\n        let viewModel = BodyTrendsViewModel(\n            fetchBodyTrendsUseCase: useCase,\n            bodyRepository: repository\n        )\n\n        // \uc0d8\ud50c \ub370\uc774\ud130 \uc124\uc815\n        viewModel.trendsOutput = FetchBodyTrendsUseCase.sampleOutput()\n\n        return viewModel\n    }\n}\n#endif\n\n// MARK: - Documentation\n\n/// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Chart ViewModel Pattern \uc774\ud574\n///\n/// BodyTrendsViewModel\uc758 \uc5ed\ud560:\n/// - \ucc28\ud2b8 \ub370\uc774\ud130 \uad00\ub9ac: FetchBodyTrendsUseCase\ub97c \ud1b5\ud574 \ud2b8\ub80c\ub4dc \ub370\uc774\ud130 \uc870\ud68c\n/// - \uae30\uac04 \uc120\ud0dd: 7/30/90\uc77c \uae30\uac04 \ub610\ub294 \ucee4\uc2a4\ud140 \ub0a0\uc9dc \ubc94\uc704\n/// - \ub124\ube44\uac8c\uc774\uc158: \uc774\uc804/\ub2e4\uc74c \uae30\uac04\uc73c\ub85c \uc774\ub3d9\n/// - \ube48 \uc0c1\ud0dc \ucc98\ub9ac: \ub370\uc774\ud130 \uc5c6\uc744 \ub54c empty state \ud45c\uc2dc\n/// - \ub85c\ub529/\uc5d0\ub7ec \ucc98\ub9ac: \ube44\ub3d9\uae30 \uc791\uc5c5\uc758 \uc0c1\ud0dc \uad00\ub9ac\n///\n/// \uc8fc\uc694 \uae30\ub2a5:\n/// 1. \uae30\uac04 \uc120\ud0dd (7/30/90\uc77c)\n/// 2. \ub0a0\uc9dc \ubc94\uc704 \ub124\ube44\uac8c\uc774\uc158 (\uc774\uc804/\ub2e4\uc74c \uae30\uac04)\n/// 3. \ub300\uc0ac\uc728 \ub370\uc774\ud130 \uc120\ud0dd\uc801 \ub85c\ub529\n/// 4. \uc2e4\uc2dc\uac04 \uc0c1\ud0dc \ubc18\uc601 (@Published)\n/// 5. \uc790\ub3d9 \ub9ac\ub85c\ub4dc (\uae30\uac04 \ubcc0\uacbd \uc2dc)\n///\n/// \ucc28\ud2b8 \ucd5c\uc801\ud654:\n/// - \ub370\uc774\ud130\ub294 \uc774\ubbf8 \ub0a0\uc9dc\uc21c \uc815\ub82c\ub428 (Use Case\uc5d0\uc11c \ucc98\ub9ac)\n/// - \ub300\uc0ac\uc728 \ub370\uc774\ud130\ub294 \uc120\ud0dd\uc801 \ub85c\ub529 (\uc131\ub2a5 \ucd5c\uc801\ud654)\n/// - \ube48 \uc0c1\ud0dc \uccb4\ud06c \uc6a9\uc774 (isEmpty computed property)\n///\n/// \uc0c1\ud0dc \uad00\ub9ac:\n/// - @Published: \uac12 \ubcc0\uacbd \uc2dc \uc790\ub3d9\uc73c\ub85c View \uc5c5\ub370\uc774\ud2b8\n/// - @MainActor: \ubaa8\ub4e0 \uba54\uc11c\ub4dc\uac00 \uba54\uc778 \uc2a4\ub808\ub4dc\uc5d0\uc11c \uc2e4\ud589\n/// - Combine: \uae30\uac04 \ubcc0\uacbd \uac10\uc9c0 \ubc0f \uc790\ub3d9 \ub9ac\ub85c\ub4dc\n///\n/// \uc758\uc874\uc131:\n/// - FetchBodyTrendsUseCase: \ud2b8\ub80c\ub4dc \ub370\uc774\ud130 \uc870\ud68c\n/// - BodyRepositoryProtocol: \uc9c1\uc811 \uc870\ud68c\uac00 \ud544\uc694\ud55c \uacbd\uc6b0\n///\n/// \uc0ac\uc6a9 \uc608\uc2dc:\n/// ```swift\n/// struct BodyTrendsView: View {\n///     @StateObject private var viewModel = BodyTrendsViewModel(\n///         fetchBodyTrendsUseCase: trendsUseCase,\n///         bodyRepository: repository\n///     )\n///\n///     var body: some View {\n///         VStack {\n///             // \uae30\uac04 \uc120\ud0dd\uae30\n///             Picker(\"\uae30\uac04\", selection: $viewModel.selectedPeriod) {\n///                 ForEach(FetchBodyTrendsUseCase.TrendPeriod.allCases, id: \\.self) { period in\n///                     Text(period.displayName).tag(period)\n///                 }\n///             }\n///             .pickerStyle(.segmented)\n///\n///             // \ucc28\ud2b8\n///             if viewModel.isEmpty {\n///                 Text(\"\ub370\uc774\ud130\uac00 \uc5c6\uc2b5\ub2c8\ub2e4\")\n///             } else {\n///                 Chart(viewModel.dataPoints) { dataPoint in\n///                     LineMark(\n///                         x: .value(\"\ub0a0\uc9dc\", dataPoint.date),\n///                         y: .value(\"\uccb4\uc911\", dataPoint.weight)\n///                     )\n///                 }\n///             }\n///\n///             // \ub124\ube44\uac8c\uc774\uc158\n///             HStack {\n///                 Button(\"\uc774\uc804\") {\n///                     Task { await viewModel.navigateToPreviousPeriod() }\n///                 }\n///                 Spacer()\n///                 Button(\"\ub2e4\uc74c\") {\n///                     Task { await viewModel.navigateToNextPeriod() }\n///                 }\n///             }\n///         }\n///         .overlay {\n///             if viewModel.isLoading {\n///                 ProgressView()\n///             }\n///         }\n///     }\n/// }\n/// ```\n///\n/// \ud83d\udca1 Android ViewModel\uacfc\uc758 \ube44\uad50:\n/// - Android: ViewModel + StateFlow + Chart data\n/// - SwiftUI: ObservableObject + @Published + Chart data\n/// - Android: Flow.collect\ub85c \uc0c1\ud0dc \uad00\ucc30\n/// - SwiftUI: Combine sink\ub85c \uc0c1\ud0dc \uad00\ucc30\n///\n",
        "last_modified": "2026-01-13T19:18:50.337331"
      },
      "task_intent": {
        "title": "Body Composition Tracking with BMR/TDEE",
        "description": "Complete body composition logging system including height, weight, body fat percentage, muscle mass, with automatic BMR (Mifflin-St Jeor) and TDEE calculations. Visualize changes over time with Swift Charts graphs showing trends and goal progress.",
        "from_plan": true
      },
      "commits_behind_main": 1,
      "status": "active",
      "merged_at": null
    }
  },
  "created_at": "2026-01-13T07:43:04.725066",
  "last_updated": "2026-01-13T07:46:22.967108"
}