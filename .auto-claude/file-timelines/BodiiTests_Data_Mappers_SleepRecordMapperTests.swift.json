{
  "file_path": "BodiiTests/Data/Mappers/SleepRecordMapperTests.swift",
  "main_branch_history": [],
  "task_views": {
    "009-sleep-tracking-with-5-status-system": {
      "task_id": "009-sleep-tracking-with-5-status-system",
      "branch_point": {
        "commit_hash": "4e56d606f7b0d4cb74120dd392544f3fe2d4f5b4",
        "content": "",
        "timestamp": "2026-01-14T21:03:40.462795"
      },
      "worktree_state": {
        "content": "//\n//  SleepRecordMapperTests.swift\n//  BodiiTests\n//\n//  Created by Auto-Claude on 2026-01-14.\n//\n\n// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Mapper Unit Testing\n// Mapper\uc758 domain/entity \ubcc0\ud658 \ub85c\uc9c1\uc744 \ub2e8\uc704 \ud14c\uc2a4\ud2b8\n// \ud83d\udca1 Java \ube44\uad50: ModelMapper \ub610\ub294 MapStruct\uc758 \ub9e4\ud551 \ub85c\uc9c1 \ud14c\uc2a4\ud2b8\uc640 \uc720\uc0ac\n\nimport XCTest\nimport CoreData\n@testable import Bodii\n\n/// SleepRecordMapper\uc758 \ub2e8\uc704 \ud14c\uc2a4\ud2b8\n/// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Unit Test vs Integration Test\n/// - Unit Test: \uac1c\ubcc4 \ucef4\ud3ec\ub10c\ud2b8\ub97c \ub3c5\ub9bd\uc801\uc73c\ub85c \ud14c\uc2a4\ud2b8 (Mapper\ub9cc \ud14c\uc2a4\ud2b8)\n/// - Integration Test: \uc5ec\ub7ec \ucef4\ud3ec\ub10c\ud2b8\ub97c \ud568\uaed8 \ud14c\uc2a4\ud2b8 (Repository + DataSource)\n/// \ud83d\udca1 Java \ube44\uad50: JUnit\uc758 \ub2e8\uc704 \ud14c\uc2a4\ud2b8\uc640 \uc720\uc0ac\nfinal class SleepRecordMapperTests: XCTestCase {\n\n    // MARK: - Properties\n\n    /// \ud14c\uc2a4\ud2b8 \ub300\uc0c1 Mapper\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: System Under Test (SUT)\n    var sut: SleepRecordMapper!\n\n    /// \ud14c\uc2a4\ud2b8\uc6a9 Persistence Controller (\uc778\uba54\ubaa8\ub9ac)\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: In-Memory Core Data Stack\n    /// - Core Data entity \uc0dd\uc131\uc744 \uc704\ud574 context\uac00 \ud544\uc694\n    /// - \uc2e4\uc81c \ub514\uc2a4\ud06c\uc5d0 \uc800\uc7a5\ud558\uc9c0 \uc54a\uace0 \uba54\ubaa8\ub9ac\uc5d0\uc11c\ub9cc \ub3d9\uc791\n    var testPersistenceController: PersistenceController!\n\n    /// \ud14c\uc2a4\ud2b8\uc6a9 Context\n    var testContext: NSManagedObjectContext!\n\n    // MARK: - Setup & Teardown\n\n    /// \uac01 \ud14c\uc2a4\ud2b8 \uc2e4\ud589 \uc804 \ud638\ucd9c\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Test Setup\n    /// - \uac01 \ud14c\uc2a4\ud2b8\ub9c8\ub2e4 \uae68\ub057\ud55c \uc0c1\ud0dc\ub85c \uc2dc\uc791\n    override func setUp() {\n        super.setUp()\n\n        // \ub9e4\ud37c \ucd08\uae30\ud654\n        sut = SleepRecordMapper()\n\n        // \uc778\uba54\ubaa8\ub9ac Core Data \uc2a4\ud0dd \uc0dd\uc131\n        testPersistenceController = PersistenceController(inMemory: true)\n        testContext = testPersistenceController.container.viewContext\n    }\n\n    /// \uac01 \ud14c\uc2a4\ud2b8 \uc2e4\ud589 \ud6c4 \ud638\ucd9c\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Test Teardown\n    /// - \uba54\ubaa8\ub9ac \uc815\ub9ac\n    override func tearDown() {\n        sut = nil\n        testContext = nil\n        testPersistenceController = nil\n        super.tearDown()\n    }\n\n    // MARK: - Helper Methods\n\n    /// \ud14c\uc2a4\ud2b8\uc6a9 Domain SleepRecord \uc0dd\uc131\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Test Helper Method\n    /// - \ud14c\uc2a4\ud2b8 \ub370\uc774\ud130 \uc0dd\uc131 \ub85c\uc9c1\uc744 \uc7ac\uc0ac\uc6a9\n    /// - \uac00\ub3c5\uc131 \ud5a5\uc0c1\n    private func makeDomainSleepRecord(\n        id: UUID = UUID(),\n        userId: UUID = UUID(),\n        date: Date = Date(),\n        duration: Int32 = 420,  // 7\uc2dc\uac04 (good)\n        status: SleepStatus = .good,\n        createdAt: Date = Date(),\n        updatedAt: Date = Date()\n    ) -> Bodii.SleepRecord {\n        return Bodii.SleepRecord(\n            id: id,\n            userId: userId,\n            date: date,\n            duration: duration,\n            status: status,\n            createdAt: createdAt,\n            updatedAt: updatedAt\n        )\n    }\n\n    /// \ud14c\uc2a4\ud2b8\uc6a9 Core Data SleepRecord \uc5d4\ud2f0\ud2f0 \uc0dd\uc131\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: NSManagedObject Creation Helper\n    /// - Core Data \uc5d4\ud2f0\ud2f0\ub97c \ud14c\uc2a4\ud2b8\uc6a9\uc73c\ub85c \uc0dd\uc131\n    private func makeEntitySleepRecord(\n        id: UUID = UUID(),\n        userId: UUID = UUID(),\n        date: Date = Date(),\n        duration: Int32 = 420,\n        status: Int16 = 2,  // good\n        createdAt: Date = Date(),\n        updatedAt: Date = Date()\n    ) -> SleepRecord {\n        let entity = SleepRecord(context: testContext)\n        entity.id = id\n        entity.userId = userId\n        entity.date = date\n        entity.duration = duration\n        entity.status = status\n        entity.createdAt = createdAt\n        entity.updatedAt = updatedAt\n        return entity\n    }\n\n    // MARK: - toDomain Tests (Core Data \u2192 Domain)\n\n    /// toDomain - \uc815\uc0c1 \ucf00\uc774\uc2a4 (good status)\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Happy Path Testing\n    /// - \ubaa8\ub4e0 \ud544\ub4dc\uac00 \uc62c\ubc14\ub974\uac8c \ubcc0\ud658\ub418\ub294\uc9c0 \ud655\uc778\n    func testToDomain_ValidEntityGoodStatus_ConvertsSuccessfully() throws {\n        // Given: \uc720\ud6a8\ud55c Core Data SleepRecord \uc5d4\ud2f0\ud2f0 (good status)\n        let entityId = UUID()\n        let entityUserId = UUID()\n        let entityDate = Date()\n        let entityDuration: Int32 = 420  // 7\uc2dc\uac04\n        let entityStatus: Int16 = 2  // good\n        let entityCreatedAt = Date()\n        let entityUpdatedAt = Date()\n\n        let entity = makeEntitySleepRecord(\n            id: entityId,\n            userId: entityUserId,\n            date: entityDate,\n            duration: entityDuration,\n            status: entityStatus,\n            createdAt: entityCreatedAt,\n            updatedAt: entityUpdatedAt\n        )\n\n        // When: Domain\uc73c\ub85c \ubcc0\ud658\n        let domainRecord = try sut.toDomain(entity)\n\n        // Then: \ubaa8\ub4e0 \ud544\ub4dc\uac00 \uc62c\ubc14\ub974\uac8c \ubcc0\ud658\ub428\n        XCTAssertEqual(domainRecord.id, entityId, \"ID\uac00 \uc77c\uce58\ud574\uc57c \ud569\ub2c8\ub2e4\")\n        XCTAssertEqual(domainRecord.userId, entityUserId, \"userId\uac00 \uc77c\uce58\ud574\uc57c \ud569\ub2c8\ub2e4\")\n        XCTAssertEqual(domainRecord.date, entityDate, \"date\uac00 \uc77c\uce58\ud574\uc57c \ud569\ub2c8\ub2e4\")\n        XCTAssertEqual(domainRecord.duration, entityDuration, \"duration\uc774 \uc77c\uce58\ud574\uc57c \ud569\ub2c8\ub2e4\")\n        XCTAssertEqual(domainRecord.status, .good, \"status\uac00 good\uc774\uc5b4\uc57c \ud569\ub2c8\ub2e4\")\n        XCTAssertEqual(domainRecord.createdAt, entityCreatedAt, \"createdAt\uc774 \uc77c\uce58\ud574\uc57c \ud569\ub2c8\ub2e4\")\n        XCTAssertEqual(domainRecord.updatedAt, entityUpdatedAt, \"updatedAt\uc774 \uc77c\uce58\ud574\uc57c \ud569\ub2c8\ub2e4\")\n    }\n\n    /// toDomain - bad status \ubcc0\ud658\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Enum Conversion Testing\n    /// - Int16 \u2192 SleepStatus \ubcc0\ud658\uc774 \uc62c\ubc14\ub978\uc9c0 \ud655\uc778\n    func testToDomain_BadStatus_ConvertsSuccessfully() throws {\n        // Given: bad status \uc5d4\ud2f0\ud2f0\n        let entity = makeEntitySleepRecord(\n            duration: 240,  // 4\uc2dc\uac04\n            status: 0  // bad\n        )\n\n        // When: Domain\uc73c\ub85c \ubcc0\ud658\n        let domainRecord = try sut.toDomain(entity)\n\n        // Then: bad status\ub85c \ubcc0\ud658\ub428\n        XCTAssertEqual(domainRecord.status, .bad, \"status\uac00 bad\uc5ec\uc57c \ud569\ub2c8\ub2e4\")\n        XCTAssertEqual(domainRecord.status.rawValue, 0, \"rawValue\uac00 0\uc774\uc5b4\uc57c \ud569\ub2c8\ub2e4\")\n        XCTAssertEqual(domainRecord.duration, 240, \"duration\uc774 \uc77c\uce58\ud574\uc57c \ud569\ub2c8\ub2e4\")\n    }\n\n    /// toDomain - soso status \ubcc0\ud658\n    func testToDomain_SosoStatus_ConvertsSuccessfully() throws {\n        // Given: soso status \uc5d4\ud2f0\ud2f0\n        let entity = makeEntitySleepRecord(\n            duration: 360,  // 6\uc2dc\uac04\n            status: 1  // soso\n        )\n\n        // When: Domain\uc73c\ub85c \ubcc0\ud658\n        let domainRecord = try sut.toDomain(entity)\n\n        // Then: soso status\ub85c \ubcc0\ud658\ub428\n        XCTAssertEqual(domainRecord.status, .soso, \"status\uac00 soso\uc5ec\uc57c \ud569\ub2c8\ub2e4\")\n        XCTAssertEqual(domainRecord.status.rawValue, 1, \"rawValue\uac00 1\uc774\uc5b4\uc57c \ud569\ub2c8\ub2e4\")\n        XCTAssertEqual(domainRecord.duration, 360, \"duration\uc774 \uc77c\uce58\ud574\uc57c \ud569\ub2c8\ub2e4\")\n    }\n\n    /// toDomain - excellent status \ubcc0\ud658\n    func testToDomain_ExcellentStatus_ConvertsSuccessfully() throws {\n        // Given: excellent status \uc5d4\ud2f0\ud2f0\n        let entity = makeEntitySleepRecord(\n            duration: 480,  // 8\uc2dc\uac04\n            status: 3  // excellent\n        )\n\n        // When: Domain\uc73c\ub85c \ubcc0\ud658\n        let domainRecord = try sut.toDomain(entity)\n\n        // Then: excellent status\ub85c \ubcc0\ud658\ub428\n        XCTAssertEqual(domainRecord.status, .excellent, \"status\uac00 excellent\uc5ec\uc57c \ud569\ub2c8\ub2e4\")\n        XCTAssertEqual(domainRecord.status.rawValue, 3, \"rawValue\uac00 3\uc774\uc5b4\uc57c \ud569\ub2c8\ub2e4\")\n        XCTAssertEqual(domainRecord.duration, 480, \"duration\uc774 \uc77c\uce58\ud574\uc57c \ud569\ub2c8\ub2e4\")\n    }\n\n    /// toDomain - oversleep status \ubcc0\ud658\n    func testToDomain_OversleepStatus_ConvertsSuccessfully() throws {\n        // Given: oversleep status \uc5d4\ud2f0\ud2f0\n        let entity = makeEntitySleepRecord(\n            duration: 600,  // 10\uc2dc\uac04\n            status: 4  // oversleep\n        )\n\n        // When: Domain\uc73c\ub85c \ubcc0\ud658\n        let domainRecord = try sut.toDomain(entity)\n\n        // Then: oversleep status\ub85c \ubcc0\ud658\ub428\n        XCTAssertEqual(domainRecord.status, .oversleep, \"status\uac00 oversleep\uc774\uc5b4\uc57c \ud569\ub2c8\ub2e4\")\n        XCTAssertEqual(domainRecord.status.rawValue, 4, \"rawValue\uac00 4\uc5ec\uc57c \ud569\ub2c8\ub2e4\")\n        XCTAssertEqual(domainRecord.duration, 600, \"duration\uc774 \uc77c\uce58\ud574\uc57c \ud569\ub2c8\ub2e4\")\n    }\n\n    /// toDomain - \ubaa8\ub4e0 status \uac12 \ubcc0\ud658 \ud14c\uc2a4\ud2b8\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Comprehensive Enum Testing\n    /// - \ubaa8\ub4e0 enum \ucf00\uc774\uc2a4\uac00 \uc62c\ubc14\ub974\uac8c \ubcc0\ud658\ub418\ub294\uc9c0 \ud655\uc778\n    func testToDomain_AllStatusValues_ConvertCorrectly() throws {\n        // Given: \ubaa8\ub4e0 status \uac12\uc5d0 \ub300\ud55c \ud14c\uc2a4\ud2b8 \ucf00\uc774\uc2a4\n        let testCases: [(status: Int16, expected: SleepStatus, description: String)] = [\n            (0, .bad, \"bad\"),\n            (1, .soso, \"soso\"),\n            (2, .good, \"good\"),\n            (3, .excellent, \"excellent\"),\n            (4, .oversleep, \"oversleep\")\n        ]\n\n        // When/Then: \uac01 status \uac12\uc774 \uc62c\ubc14\ub974\uac8c \ubcc0\ud658\ub428\n        for testCase in testCases {\n            let entity = makeEntitySleepRecord(status: testCase.status)\n            let domainRecord = try sut.toDomain(entity)\n\n            XCTAssertEqual(\n                domainRecord.status,\n                testCase.expected,\n                \"\\(testCase.description) status\uac00 \uc62c\ubc14\ub974\uac8c \ubcc0\ud658\ub418\uc5b4\uc57c \ud569\ub2c8\ub2e4\"\n            )\n        }\n    }\n\n    /// toDomain - 0\ubd84 \uc218\uba74 \uc2dc\uac04 (\ubc24\uc0d8)\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Edge Case Testing\n    /// - \ucd5c\uc18c\uac12 \uacbd\uacc4 \uc870\uac74 \ud14c\uc2a4\ud2b8\n    func testToDomain_ZeroDuration_ConvertsSuccessfully() throws {\n        // Given: 0\ubd84 \uc218\uba74 \uc2dc\uac04 (\ubc24\uc0d8)\n        let entity = makeEntitySleepRecord(\n            duration: 0,\n            status: 0  // bad\n        )\n\n        // When: Domain\uc73c\ub85c \ubcc0\ud658\n        let domainRecord = try sut.toDomain(entity)\n\n        // Then: 0\ubd84\ub3c4 \uc62c\ubc14\ub974\uac8c \ubcc0\ud658\ub428\n        XCTAssertEqual(domainRecord.duration, 0, \"duration\uc774 0\uc774\uc5b4\uc57c \ud569\ub2c8\ub2e4\")\n        XCTAssertEqual(domainRecord.status, .bad, \"0\ubd84\uc740 bad status\uc5ec\uc57c \ud569\ub2c8\ub2e4\")\n    }\n\n    /// toDomain - \ub9e4\uc6b0 \uae34 \uc218\uba74 \uc2dc\uac04\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Large Value Testing\n    func testToDomain_LargeDuration_ConvertsSuccessfully() throws {\n        // Given: \ub9e4\uc6b0 \uae34 \uc218\uba74 \uc2dc\uac04 (12\uc2dc\uac04)\n        let entity = makeEntitySleepRecord(\n            duration: 720,  // 12\uc2dc\uac04\n            status: 4  // oversleep\n        )\n\n        // When: Domain\uc73c\ub85c \ubcc0\ud658\n        let domainRecord = try sut.toDomain(entity)\n\n        // Then: \ud070 \uac12\ub3c4 \uc62c\ubc14\ub974\uac8c \ubcc0\ud658\ub428\n        XCTAssertEqual(domainRecord.duration, 720, \"duration\uc774 720\uc774\uc5b4\uc57c \ud569\ub2c8\ub2e4\")\n        XCTAssertEqual(domainRecord.status, .oversleep, \"oversleep status\uc5ec\uc57c \ud569\ub2c8\ub2e4\")\n    }\n\n    // MARK: - toDomain Error Tests\n\n    /// toDomain - id \ud544\ub4dc \ub204\ub77d\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Error Case Testing\n    /// - \ud544\uc218 \ud544\ub4dc \ub204\ub77d \uc2dc \uc5d0\ub7ec\uac00 \ubc1c\uc0dd\ud558\ub294\uc9c0 \ud655\uc778\n    func testToDomain_MissingId_ThrowsError() throws {\n        // Given: id\uac00 nil\uc778 \uc5d4\ud2f0\ud2f0\n        let entity = makeEntitySleepRecord()\n        entity.id = nil\n\n        // When/Then: \uc5d0\ub7ec \ubc1c\uc0dd\n        XCTAssertThrowsError(try sut.toDomain(entity)) { error in\n            guard let mappingError = error as? SleepRecordMapper.MappingError else {\n                XCTFail(\"MappingError \ud0c0\uc785\uc774\uc5b4\uc57c \ud569\ub2c8\ub2e4\")\n                return\n            }\n\n            // \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Error Pattern Matching\n            if case .missingRequiredField(let field) = mappingError {\n                XCTAssertEqual(field, \"id\", \"id \ud544\ub4dc \ub204\ub77d \uc5d0\ub7ec\uc5ec\uc57c \ud569\ub2c8\ub2e4\")\n            } else {\n                XCTFail(\"missingRequiredField \uc5d0\ub7ec\uc5ec\uc57c \ud569\ub2c8\ub2e4\")\n            }\n        }\n    }\n\n    /// toDomain - userId \ud544\ub4dc \ub204\ub77d\n    func testToDomain_MissingUserId_ThrowsError() throws {\n        // Given: userId\uac00 nil\uc778 \uc5d4\ud2f0\ud2f0\n        let entity = makeEntitySleepRecord()\n        entity.userId = nil\n\n        // When/Then: \uc5d0\ub7ec \ubc1c\uc0dd\n        XCTAssertThrowsError(try sut.toDomain(entity)) { error in\n            guard let mappingError = error as? SleepRecordMapper.MappingError,\n                  case .missingRequiredField(let field) = mappingError else {\n                XCTFail(\"missingRequiredField \uc5d0\ub7ec\uc5ec\uc57c \ud569\ub2c8\ub2e4\")\n                return\n            }\n            XCTAssertEqual(field, \"userId\", \"userId \ud544\ub4dc \ub204\ub77d \uc5d0\ub7ec\uc5ec\uc57c \ud569\ub2c8\ub2e4\")\n        }\n    }\n\n    /// toDomain - date \ud544\ub4dc \ub204\ub77d\n    func testToDomain_MissingDate_ThrowsError() throws {\n        // Given: date\uac00 nil\uc778 \uc5d4\ud2f0\ud2f0\n        let entity = makeEntitySleepRecord()\n        entity.date = nil\n\n        // When/Then: \uc5d0\ub7ec \ubc1c\uc0dd\n        XCTAssertThrowsError(try sut.toDomain(entity)) { error in\n            guard let mappingError = error as? SleepRecordMapper.MappingError,\n                  case .missingRequiredField(let field) = mappingError else {\n                XCTFail(\"missingRequiredField \uc5d0\ub7ec\uc5ec\uc57c \ud569\ub2c8\ub2e4\")\n                return\n            }\n            XCTAssertEqual(field, \"date\", \"date \ud544\ub4dc \ub204\ub77d \uc5d0\ub7ec\uc5ec\uc57c \ud569\ub2c8\ub2e4\")\n        }\n    }\n\n    /// toDomain - createdAt \ud544\ub4dc \ub204\ub77d\n    func testToDomain_MissingCreatedAt_ThrowsError() throws {\n        // Given: createdAt\uc774 nil\uc778 \uc5d4\ud2f0\ud2f0\n        let entity = makeEntitySleepRecord()\n        entity.createdAt = nil\n\n        // When/Then: \uc5d0\ub7ec \ubc1c\uc0dd\n        XCTAssertThrowsError(try sut.toDomain(entity)) { error in\n            guard let mappingError = error as? SleepRecordMapper.MappingError,\n                  case .missingRequiredField(let field) = mappingError else {\n                XCTFail(\"missingRequiredField \uc5d0\ub7ec\uc5ec\uc57c \ud569\ub2c8\ub2e4\")\n                return\n            }\n            XCTAssertEqual(field, \"createdAt\", \"createdAt \ud544\ub4dc \ub204\ub77d \uc5d0\ub7ec\uc5ec\uc57c \ud569\ub2c8\ub2e4\")\n        }\n    }\n\n    /// toDomain - updatedAt \ud544\ub4dc \ub204\ub77d\n    func testToDomain_MissingUpdatedAt_ThrowsError() throws {\n        // Given: updatedAt\uc774 nil\uc778 \uc5d4\ud2f0\ud2f0\n        let entity = makeEntitySleepRecord()\n        entity.updatedAt = nil\n\n        // When/Then: \uc5d0\ub7ec \ubc1c\uc0dd\n        XCTAssertThrowsError(try sut.toDomain(entity)) { error in\n            guard let mappingError = error as? SleepRecordMapper.MappingError,\n                  case .missingRequiredField(let field) = mappingError else {\n                XCTFail(\"missingRequiredField \uc5d0\ub7ec\uc5ec\uc57c \ud569\ub2c8\ub2e4\")\n                return\n            }\n            XCTAssertEqual(field, \"updatedAt\", \"updatedAt \ud544\ub4dc \ub204\ub77d \uc5d0\ub7ec\uc5ec\uc57c \ud569\ub2c8\ub2e4\")\n        }\n    }\n\n    /// toDomain - \uc798\ubabb\ub41c status \uac12\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Invalid Enum Value Testing\n    /// - \uc874\uc7ac\ud558\uc9c0 \uc54a\ub294 enum \uac12\uc5d0 \ub300\ud55c \uc5d0\ub7ec \ucc98\ub9ac\n    func testToDomain_InvalidStatus_ThrowsError() throws {\n        // Given: \uc798\ubabb\ub41c status \uac12 (5\ub294 \uc874\uc7ac\ud558\uc9c0 \uc54a\uc74c)\n        let entity = makeEntitySleepRecord(status: 5)\n\n        // When/Then: \uc5d0\ub7ec \ubc1c\uc0dd\n        XCTAssertThrowsError(try sut.toDomain(entity)) { error in\n            guard let mappingError = error as? SleepRecordMapper.MappingError else {\n                XCTFail(\"MappingError \ud0c0\uc785\uc774\uc5b4\uc57c \ud569\ub2c8\ub2e4\")\n                return\n            }\n\n            if case .invalidEnumValue(let field) = mappingError {\n                XCTAssertTrue(field.contains(\"status\"), \"status \ud544\ub4dc \uc5d0\ub7ec\uc5ec\uc57c \ud569\ub2c8\ub2e4\")\n                XCTAssertTrue(field.contains(\"5\"), \"status \uac12 5\ub97c \ud3ec\ud568\ud574\uc57c \ud569\ub2c8\ub2e4\")\n            } else {\n                XCTFail(\"invalidEnumValue \uc5d0\ub7ec\uc5ec\uc57c \ud569\ub2c8\ub2e4\")\n            }\n        }\n    }\n\n    /// toDomain - \uc74c\uc218 status \uac12\n    func testToDomain_NegativeStatus_ThrowsError() throws {\n        // Given: \uc74c\uc218 status \uac12\n        let entity = makeEntitySleepRecord(status: -1)\n\n        // When/Then: \uc5d0\ub7ec \ubc1c\uc0dd\n        XCTAssertThrowsError(try sut.toDomain(entity)) { error in\n            guard let mappingError = error as? SleepRecordMapper.MappingError,\n                  case .invalidEnumValue = mappingError else {\n                XCTFail(\"invalidEnumValue \uc5d0\ub7ec\uc5ec\uc57c \ud569\ub2c8\ub2e4\")\n                return\n            }\n        }\n    }\n\n    // MARK: - toDomain Array Tests\n\n    /// toDomain - \uc5ec\ub7ec \uc5d4\ud2f0\ud2f0 \ubcc0\ud658\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Collection Transformation Testing\n    /// - \ubc30\uc5f4 \ubcc0\ud658\uc774 \uc62c\ubc14\ub974\uac8c \uc791\ub3d9\ud558\ub294\uc9c0 \ud655\uc778\n    func testToDomain_MultipleEntities_ConvertsAll() throws {\n        // Given: \uc5ec\ub7ec Core Data \uc5d4\ud2f0\ud2f0\n        let entity1 = makeEntitySleepRecord(duration: 240, status: 0)  // bad\n        let entity2 = makeEntitySleepRecord(duration: 360, status: 1)  // soso\n        let entity3 = makeEntitySleepRecord(duration: 480, status: 3)  // excellent\n\n        let entities = [entity1, entity2, entity3]\n\n        // When: \ubc30\uc5f4\uc744 Domain\uc73c\ub85c \ubcc0\ud658\n        let domainRecords = try sut.toDomain(entities)\n\n        // Then: \ubaa8\ub4e0 \uc5d4\ud2f0\ud2f0\uac00 \ubcc0\ud658\ub428\n        XCTAssertEqual(domainRecords.count, 3, \"3\uac1c\uc758 \ub808\ucf54\ub4dc\uac00 \ubcc0\ud658\ub418\uc5b4\uc57c \ud569\ub2c8\ub2e4\")\n        XCTAssertEqual(domainRecords[0].status, .bad, \"\uccab \ubc88\uc9f8\ub294 bad\uc5ec\uc57c \ud569\ub2c8\ub2e4\")\n        XCTAssertEqual(domainRecords[1].status, .soso, \"\ub450 \ubc88\uc9f8\ub294 soso\uc5ec\uc57c \ud569\ub2c8\ub2e4\")\n        XCTAssertEqual(domainRecords[2].status, .excellent, \"\uc138 \ubc88\uc9f8\ub294 excellent\uc5ec\uc57c \ud569\ub2c8\ub2e4\")\n    }\n\n    /// toDomain - \ube48 \ubc30\uc5f4\n    func testToDomain_EmptyArray_ReturnsEmptyArray() throws {\n        // Given: \ube48 \ubc30\uc5f4\n        let entities: [SleepRecord] = []\n\n        // When: \ubc30\uc5f4\uc744 Domain\uc73c\ub85c \ubcc0\ud658\n        let domainRecords = try sut.toDomain(entities)\n\n        // Then: \ube48 \ubc30\uc5f4 \ubc18\ud658\n        XCTAssertTrue(domainRecords.isEmpty, \"\ube48 \ubc30\uc5f4\uc744 \ubc18\ud658\ud574\uc57c \ud569\ub2c8\ub2e4\")\n    }\n\n    /// toDomain - \ubc30\uc5f4 \uc911 \ud558\ub098\uac00 \uc798\ubabb\ub41c \uacbd\uc6b0\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Fail-Fast Behavior\n    /// - \ud558\ub098\ub77c\ub3c4 \uc2e4\ud328\ud558\uba74 \uc804\uccb4 \ubcc0\ud658 \uc2e4\ud328\n    func testToDomain_ArrayWithInvalidEntity_ThrowsError() throws {\n        // Given: \ud558\ub098\ub294 \uc720\ud6a8\ud558\uace0 \ud558\ub098\ub294 \uc798\ubabb\ub41c \uc5d4\ud2f0\ud2f0\n        let validEntity = makeEntitySleepRecord()\n        let invalidEntity = makeEntitySleepRecord()\n        invalidEntity.id = nil\n\n        let entities = [validEntity, invalidEntity]\n\n        // When/Then: \uc5d0\ub7ec \ubc1c\uc0dd\n        XCTAssertThrowsError(try sut.toDomain(entities)) { error in\n            XCTAssertTrue(error is SleepRecordMapper.MappingError,\n                         \"MappingError \ud0c0\uc785\uc774\uc5b4\uc57c \ud569\ub2c8\ub2e4\")\n        }\n    }\n\n    // MARK: - toEntity Tests (Domain \u2192 Core Data)\n\n    /// toEntity - \uc815\uc0c1 \ucf00\uc774\uc2a4\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Domain to Entity Conversion\n    /// - Domain \ubaa8\ub378\uc744 Core Data \uc5d4\ud2f0\ud2f0\ub85c \ubcc0\ud658\n    func testToEntity_ValidDomainRecord_ConvertsSuccessfully() {\n        // Given: \uc720\ud6a8\ud55c Domain SleepRecord\n        let domainId = UUID()\n        let domainUserId = UUID()\n        let domainDate = Date()\n        let domainDuration: Int32 = 420\n        let domainStatus: SleepStatus = .good\n        let domainCreatedAt = Date()\n        let domainUpdatedAt = Date()\n\n        let domainRecord = makeDomainSleepRecord(\n            id: domainId,\n            userId: domainUserId,\n            date: domainDate,\n            duration: domainDuration,\n            status: domainStatus,\n            createdAt: domainCreatedAt,\n            updatedAt: domainUpdatedAt\n        )\n\n        // When: Core Data \uc5d4\ud2f0\ud2f0\ub85c \ubcc0\ud658\n        let entity = sut.toEntity(domainRecord, context: testContext)\n\n        // Then: \ubaa8\ub4e0 \ud544\ub4dc\uac00 \uc62c\ubc14\ub974\uac8c \ubcc0\ud658\ub428\n        XCTAssertEqual(entity.id, domainId, \"ID\uac00 \uc77c\uce58\ud574\uc57c \ud569\ub2c8\ub2e4\")\n        XCTAssertEqual(entity.userId, domainUserId, \"userId\uac00 \uc77c\uce58\ud574\uc57c \ud569\ub2c8\ub2e4\")\n        XCTAssertEqual(entity.date, domainDate, \"date\uac00 \uc77c\uce58\ud574\uc57c \ud569\ub2c8\ub2e4\")\n        XCTAssertEqual(entity.duration, domainDuration, \"duration\uc774 \uc77c\uce58\ud574\uc57c \ud569\ub2c8\ub2e4\")\n        XCTAssertEqual(entity.status, domainStatus.rawValue, \"status rawValue\uac00 \uc77c\uce58\ud574\uc57c \ud569\ub2c8\ub2e4\")\n        XCTAssertEqual(entity.createdAt, domainCreatedAt, \"createdAt\uc774 \uc77c\uce58\ud574\uc57c \ud569\ub2c8\ub2e4\")\n        XCTAssertEqual(entity.updatedAt, domainUpdatedAt, \"updatedAt\uc774 \uc77c\uce58\ud574\uc57c \ud569\ub2c8\ub2e4\")\n    }\n\n    /// toEntity - \ubaa8\ub4e0 status \uac12 \ubcc0\ud658\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Enum to Int16 Conversion\n    /// - SleepStatus \u2192 Int16 \ubcc0\ud658 \ud14c\uc2a4\ud2b8\n    func testToEntity_AllStatusValues_ConvertCorrectly() {\n        // Given: \ubaa8\ub4e0 status \uac12\uc5d0 \ub300\ud55c \ud14c\uc2a4\ud2b8 \ucf00\uc774\uc2a4\n        let testCases: [(status: SleepStatus, expectedRawValue: Int16, description: String)] = [\n            (.bad, 0, \"bad\"),\n            (.soso, 1, \"soso\"),\n            (.good, 2, \"good\"),\n            (.excellent, 3, \"excellent\"),\n            (.oversleep, 4, \"oversleep\")\n        ]\n\n        // When/Then: \uac01 status \uac12\uc774 \uc62c\ubc14\ub974\uac8c \ubcc0\ud658\ub428\n        for testCase in testCases {\n            let domainRecord = makeDomainSleepRecord(status: testCase.status)\n            let entity = sut.toEntity(domainRecord, context: testContext)\n\n            XCTAssertEqual(\n                entity.status,\n                testCase.expectedRawValue,\n                \"\\(testCase.description) status\uc758 rawValue\uac00 \uc62c\ubc14\ub974\uac8c \ubcc0\ud658\ub418\uc5b4\uc57c \ud569\ub2c8\ub2e4\"\n            )\n        }\n    }\n\n    /// toEntity - 0\ubd84 \uc218\uba74 \uc2dc\uac04\n    func testToEntity_ZeroDuration_ConvertsSuccessfully() {\n        // Given: 0\ubd84 \uc218\uba74 \uc2dc\uac04\n        let domainRecord = makeDomainSleepRecord(\n            duration: 0,\n            status: .bad\n        )\n\n        // When: Core Data \uc5d4\ud2f0\ud2f0\ub85c \ubcc0\ud658\n        let entity = sut.toEntity(domainRecord, context: testContext)\n\n        // Then: 0\ubd84\ub3c4 \uc62c\ubc14\ub974\uac8c \ubcc0\ud658\ub428\n        XCTAssertEqual(entity.duration, 0, \"duration\uc774 0\uc774\uc5b4\uc57c \ud569\ub2c8\ub2e4\")\n        XCTAssertEqual(entity.status, 0, \"status\uac00 bad(0)\uc5ec\uc57c \ud569\ub2c8\ub2e4\")\n    }\n\n    /// toEntity - \ub9e4\uc6b0 \uae34 \uc218\uba74 \uc2dc\uac04\n    func testToEntity_LargeDuration_ConvertsSuccessfully() {\n        // Given: \ub9e4\uc6b0 \uae34 \uc218\uba74 \uc2dc\uac04\n        let domainRecord = makeDomainSleepRecord(\n            duration: 720,\n            status: .oversleep\n        )\n\n        // When: Core Data \uc5d4\ud2f0\ud2f0\ub85c \ubcc0\ud658\n        let entity = sut.toEntity(domainRecord, context: testContext)\n\n        // Then: \ud070 \uac12\ub3c4 \uc62c\ubc14\ub974\uac8c \ubcc0\ud658\ub428\n        XCTAssertEqual(entity.duration, 720, \"duration\uc774 720\uc774\uc5b4\uc57c \ud569\ub2c8\ub2e4\")\n        XCTAssertEqual(entity.status, 4, \"status\uac00 oversleep(4)\uc5ec\uc57c \ud569\ub2c8\ub2e4\")\n    }\n\n    // MARK: - Round-trip Conversion Tests\n\n    /// Round-trip \ubcc0\ud658 - Entity \u2192 Domain \u2192 Entity\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Round-trip Testing\n    /// - \uc591\ubc29\ud5a5 \ubcc0\ud658 \ud6c4\uc5d0\ub3c4 \ub370\uc774\ud130\uac00 \ubcf4\uc874\ub418\ub294\uc9c0 \ud655\uc778\n    func testRoundTrip_EntityToDomainToEntity_PreservesData() throws {\n        // Given: \uc6d0\ubcf8 Core Data \uc5d4\ud2f0\ud2f0\n        let originalEntity = makeEntitySleepRecord(\n            id: UUID(),\n            userId: UUID(),\n            date: Date(),\n            duration: 480,\n            status: 3,  // excellent\n            createdAt: Date(),\n            updatedAt: Date()\n        )\n\n        // When: Entity \u2192 Domain \u2192 Entity \ubcc0\ud658\n        let domainRecord = try sut.toDomain(originalEntity)\n        let newEntity = sut.toEntity(domainRecord, context: testContext)\n\n        // Then: \ubaa8\ub4e0 \ub370\uc774\ud130\uac00 \ubcf4\uc874\ub428\n        XCTAssertEqual(newEntity.id, originalEntity.id, \"ID\uac00 \ubcf4\uc874\ub418\uc5b4\uc57c \ud569\ub2c8\ub2e4\")\n        XCTAssertEqual(newEntity.userId, originalEntity.userId, \"userId\uac00 \ubcf4\uc874\ub418\uc5b4\uc57c \ud569\ub2c8\ub2e4\")\n        XCTAssertEqual(newEntity.date, originalEntity.date, \"date\uac00 \ubcf4\uc874\ub418\uc5b4\uc57c \ud569\ub2c8\ub2e4\")\n        XCTAssertEqual(newEntity.duration, originalEntity.duration, \"duration\uc774 \ubcf4\uc874\ub418\uc5b4\uc57c \ud569\ub2c8\ub2e4\")\n        XCTAssertEqual(newEntity.status, originalEntity.status, \"status\uac00 \ubcf4\uc874\ub418\uc5b4\uc57c \ud569\ub2c8\ub2e4\")\n        XCTAssertEqual(newEntity.createdAt, originalEntity.createdAt, \"createdAt\uc774 \ubcf4\uc874\ub418\uc5b4\uc57c \ud569\ub2c8\ub2e4\")\n        XCTAssertEqual(newEntity.updatedAt, originalEntity.updatedAt, \"updatedAt\uc774 \ubcf4\uc874\ub418\uc5b4\uc57c \ud569\ub2c8\ub2e4\")\n    }\n\n    /// Round-trip \ubcc0\ud658 - Domain \u2192 Entity \u2192 Domain\n    func testRoundTrip_DomainToEntityToDomain_PreservesData() throws {\n        // Given: \uc6d0\ubcf8 Domain \ub808\ucf54\ub4dc\n        let originalDomain = makeDomainSleepRecord(\n            id: UUID(),\n            userId: UUID(),\n            date: Date(),\n            duration: 360,\n            status: .soso,\n            createdAt: Date(),\n            updatedAt: Date()\n        )\n\n        // When: Domain \u2192 Entity \u2192 Domain \ubcc0\ud658\n        let entity = sut.toEntity(originalDomain, context: testContext)\n        let newDomain = try sut.toDomain(entity)\n\n        // Then: \ubaa8\ub4e0 \ub370\uc774\ud130\uac00 \ubcf4\uc874\ub428\n        XCTAssertEqual(newDomain.id, originalDomain.id, \"ID\uac00 \ubcf4\uc874\ub418\uc5b4\uc57c \ud569\ub2c8\ub2e4\")\n        XCTAssertEqual(newDomain.userId, originalDomain.userId, \"userId\uac00 \ubcf4\uc874\ub418\uc5b4\uc57c \ud569\ub2c8\ub2e4\")\n        XCTAssertEqual(newDomain.date, originalDomain.date, \"date\uac00 \ubcf4\uc874\ub418\uc5b4\uc57c \ud569\ub2c8\ub2e4\")\n        XCTAssertEqual(newDomain.duration, originalDomain.duration, \"duration\uc774 \ubcf4\uc874\ub418\uc5b4\uc57c \ud569\ub2c8\ub2e4\")\n        XCTAssertEqual(newDomain.status, originalDomain.status, \"status\uac00 \ubcf4\uc874\ub418\uc5b4\uc57c \ud569\ub2c8\ub2e4\")\n        XCTAssertEqual(newDomain.createdAt, originalDomain.createdAt, \"createdAt\uc774 \ubcf4\uc874\ub418\uc5b4\uc57c \ud569\ub2c8\ub2e4\")\n        XCTAssertEqual(newDomain.updatedAt, originalDomain.updatedAt, \"updatedAt\uc774 \ubcf4\uc874\ub418\uc5b4\uc57c \ud569\ub2c8\ub2e4\")\n    }\n\n    // MARK: - updateEntity Tests\n\n    /// updateEntity - \uc815\uc0c1 \ucf00\uc774\uc2a4\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Partial Update Testing\n    /// - \uae30\uc874 \uc5d4\ud2f0\ud2f0\ub97c \uc5c5\ub370\uc774\ud2b8\ud558\ub294 \ub85c\uc9c1 \ud14c\uc2a4\ud2b8\n    func testUpdateEntity_ValidData_UpdatesSuccessfully() {\n        // Given: \uae30\uc874 \uc5d4\ud2f0\ud2f0\uc640 \uc0c8\ub85c\uc6b4 Domain \ub808\ucf54\ub4dc\n        let entity = makeEntitySleepRecord(\n            duration: 360,\n            status: 1  // soso\n        )\n\n        let updatedDomain = makeDomainSleepRecord(\n            id: entity.id!,\n            userId: entity.userId!,\n            duration: 480,  // \uc218\uc815\ub41c \uac12\n            status: .excellent,  // \uc218\uc815\ub41c \uac12\n            updatedAt: Date()\n        )\n\n        // When: \uc5d4\ud2f0\ud2f0 \uc5c5\ub370\uc774\ud2b8\n        sut.updateEntity(entity, from: updatedDomain)\n\n        // Then: \ud544\ub4dc\uac00 \uc5c5\ub370\uc774\ud2b8\ub428\n        XCTAssertEqual(entity.duration, 480, \"duration\uc774 \uc5c5\ub370\uc774\ud2b8\ub418\uc5b4\uc57c \ud569\ub2c8\ub2e4\")\n        XCTAssertEqual(entity.status, 3, \"status\uac00 excellent(3)\ub85c \uc5c5\ub370\uc774\ud2b8\ub418\uc5b4\uc57c \ud569\ub2c8\ub2e4\")\n        XCTAssertEqual(entity.date, updatedDomain.date, \"date\uac00 \uc5c5\ub370\uc774\ud2b8\ub418\uc5b4\uc57c \ud569\ub2c8\ub2e4\")\n        XCTAssertEqual(entity.updatedAt, updatedDomain.updatedAt, \"updatedAt\uc774 \uc5c5\ub370\uc774\ud2b8\ub418\uc5b4\uc57c \ud569\ub2c8\ub2e4\")\n    }\n\n    /// updateEntity - ID\ub294 \ubcc0\uacbd\ub418\uc9c0 \uc54a\uc74c\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Immutable Field Testing\n    /// - ID\uc640 userId, createdAt\uc740 \ubcc0\uacbd\ub418\uc9c0 \uc54a\uc544\uc57c \ud568\n    func testUpdateEntity_ImmutableFields_NotUpdated() {\n        // Given: \uae30\uc874 \uc5d4\ud2f0\ud2f0\n        let originalId = UUID()\n        let originalUserId = UUID()\n        let originalCreatedAt = Date()\n\n        let entity = makeEntitySleepRecord(\n            id: originalId,\n            userId: originalUserId,\n            createdAt: originalCreatedAt\n        )\n\n        // \ub2e4\ub978 ID\ub97c \uac00\uc9c4 Domain \ub808\ucf54\ub4dc\n        let updatedDomain = makeDomainSleepRecord(\n            id: UUID(),  // \ub2e4\ub978 ID\n            userId: UUID(),  // \ub2e4\ub978 userId\n            createdAt: Date()  // \ub2e4\ub978 createdAt\n        )\n\n        // When: \uc5d4\ud2f0\ud2f0 \uc5c5\ub370\uc774\ud2b8\n        sut.updateEntity(entity, from: updatedDomain)\n\n        // Then: ID, userId, createdAt\uc740 \ubcc0\uacbd\ub418\uc9c0 \uc54a\uc74c\n        XCTAssertEqual(entity.id, originalId, \"ID\ub294 \ubcc0\uacbd\ub418\uc9c0 \uc54a\uc544\uc57c \ud569\ub2c8\ub2e4\")\n        XCTAssertEqual(entity.userId, originalUserId, \"userId\ub294 \ubcc0\uacbd\ub418\uc9c0 \uc54a\uc544\uc57c \ud569\ub2c8\ub2e4\")\n        XCTAssertEqual(entity.createdAt, originalCreatedAt, \"createdAt\uc740 \ubcc0\uacbd\ub418\uc9c0 \uc54a\uc544\uc57c \ud569\ub2c8\ub2e4\")\n    }\n\n    /// updateEntity - status \ubcc0\uacbd\n    func testUpdateEntity_StatusChange_UpdatesSuccessfully() {\n        // Given: bad status \uc5d4\ud2f0\ud2f0\n        let entity = makeEntitySleepRecord(\n            duration: 240,\n            status: 0  // bad\n        )\n\n        // excellent status\ub85c \ubcc0\uacbd\n        let updatedDomain = makeDomainSleepRecord(\n            id: entity.id!,\n            userId: entity.userId!,\n            duration: 480,\n            status: .excellent\n        )\n\n        // When: \uc5d4\ud2f0\ud2f0 \uc5c5\ub370\uc774\ud2b8\n        sut.updateEntity(entity, from: updatedDomain)\n\n        // Then: status\uac00 \ubcc0\uacbd\ub428\n        XCTAssertEqual(entity.status, 3, \"status\uac00 excellent(3)\ub85c \ubcc0\uacbd\ub418\uc5b4\uc57c \ud569\ub2c8\ub2e4\")\n        XCTAssertEqual(entity.duration, 480, \"duration\ub3c4 \ubcc0\uacbd\ub418\uc5b4\uc57c \ud569\ub2c8\ub2e4\")\n    }\n\n    // MARK: - Convenience Method Tests\n\n    /// createAndSave - \uc815\uc0c1 \ucf00\uc774\uc2a4\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Convenience Method Testing\n    /// - \uc0dd\uc131\uacfc \uc800\uc7a5\uc744 \ud55c \ubc88\uc5d0 \ucc98\ub9ac\ud558\ub294 \uba54\uc11c\ub4dc \ud14c\uc2a4\ud2b8\n    func testCreateAndSave_ValidData_SavesSuccessfully() throws {\n        // Given: \uc720\ud6a8\ud55c Domain \ub808\ucf54\ub4dc\n        let domainRecord = makeDomainSleepRecord()\n\n        // When: \uc0dd\uc131 \ubc0f \uc800\uc7a5\n        let savedEntity = try sut.createAndSave(domainRecord, context: testContext)\n\n        // Then: \uc800\uc7a5 \uc131\uacf5\n        XCTAssertNotNil(savedEntity, \"\uc800\uc7a5\ub41c \uc5d4\ud2f0\ud2f0\uac00 nil\uc774 \uc544\ub2c8\uc5b4\uc57c \ud569\ub2c8\ub2e4\")\n        XCTAssertEqual(savedEntity.id, domainRecord.id, \"ID\uac00 \uc77c\uce58\ud574\uc57c \ud569\ub2c8\ub2e4\")\n        XCTAssertEqual(savedEntity.duration, domainRecord.duration, \"duration\uc774 \uc77c\uce58\ud574\uc57c \ud569\ub2c8\ub2e4\")\n\n        // \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Context State Verification\n        // save()\uac00 \ud638\ucd9c\ub418\uc5c8\ub294\uc9c0 \ud655\uc778\n        XCTAssertFalse(testContext.hasChanges, \"\uc800\uc7a5 \ud6c4\uc5d0\ub294 \ubcc0\uacbd\uc0ac\ud56d\uc774 \uc5c6\uc5b4\uc57c \ud569\ub2c8\ub2e4\")\n    }\n\n    /// updateAndSave - \uc815\uc0c1 \ucf00\uc774\uc2a4\n    func testUpdateAndSave_ValidData_SavesSuccessfully() throws {\n        // Given: \uae30\uc874 \uc5d4\ud2f0\ud2f0\n        let entity = makeEntitySleepRecord(duration: 360, status: 1)\n\n        // When: \uc5c5\ub370\uc774\ud2b8 \ubc0f \uc800\uc7a5\n        let updatedDomain = makeDomainSleepRecord(\n            id: entity.id!,\n            userId: entity.userId!,\n            duration: 480,\n            status: .excellent\n        )\n\n        try sut.updateAndSave(entity, from: updatedDomain, context: testContext)\n\n        // Then: \uc5c5\ub370\uc774\ud2b8 \uc131\uacf5\n        XCTAssertEqual(entity.duration, 480, \"duration\uc774 \uc5c5\ub370\uc774\ud2b8\ub418\uc5b4\uc57c \ud569\ub2c8\ub2e4\")\n        XCTAssertEqual(entity.status, 3, \"status\uac00 \uc5c5\ub370\uc774\ud2b8\ub418\uc5b4\uc57c \ud569\ub2c8\ub2e4\")\n        XCTAssertFalse(testContext.hasChanges, \"\uc800\uc7a5 \ud6c4\uc5d0\ub294 \ubcc0\uacbd\uc0ac\ud56d\uc774 \uc5c6\uc5b4\uc57c \ud569\ub2c8\ub2e4\")\n    }\n\n    // MARK: - Date Handling Tests\n\n    /// Date \uc815\ubc00\ub3c4 \ubcf4\uc874 \ud14c\uc2a4\ud2b8\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Date Precision Testing\n    /// - \ub0a0\uc9dc \uc815\ubc00\ub3c4\uac00 \uc720\uc9c0\ub418\ub294\uc9c0 \ud655\uc778\n    func testRoundTrip_PreservesDatePrecision() throws {\n        // Given: \ud2b9\uc815 \uc2dc\uac04\uc758 Domain \ub808\ucf54\ub4dc\n        let calendar = Calendar.current\n        let specificDate = calendar.date(from: DateComponents(\n            year: 2026, month: 1, day: 14,\n            hour: 2, minute: 30, second: 0\n        ))!\n\n        let domainRecord = makeDomainSleepRecord(date: specificDate)\n\n        // When: Domain \u2192 Entity \u2192 Domain \ubcc0\ud658\n        let entity = sut.toEntity(domainRecord, context: testContext)\n        let convertedDomain = try sut.toDomain(entity)\n\n        // Then: \ub0a0\uc9dc \uc815\ubc00\ub3c4\uac00 \uc720\uc9c0\ub428 (\ucd08 \ub2e8\uc704\uae4c\uc9c0)\n        let originalComponents = calendar.dateComponents(\n            [.year, .month, .day, .hour, .minute, .second],\n            from: specificDate\n        )\n        let convertedComponents = calendar.dateComponents(\n            [.year, .month, .day, .hour, .minute, .second],\n            from: convertedDomain.date\n        )\n\n        XCTAssertEqual(originalComponents, convertedComponents,\n                      \"\ub0a0\uc9dc \uc815\ubc00\ub3c4\uac00 \uc720\uc9c0\ub418\uc5b4\uc57c \ud569\ub2c8\ub2e4\")\n    }\n}\n\n// MARK: - Documentation\n\n/// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Mapper Unit Test \uc791\uc131 \uac00\uc774\ub4dc\n///\n/// Mapper Test\uc758 \ubaa9\uc801:\n/// - Domain \u2194 Entity \ubcc0\ud658 \ub85c\uc9c1\uc758 \uc815\ud655\uc131 \uac80\uc99d\n/// - Enum \ubcc0\ud658 \ub85c\uc9c1 \ud14c\uc2a4\ud2b8 (Int16 \u2194 SleepStatus)\n/// - \ud544\uc218 \ud544\ub4dc \ub204\ub77d \uc2dc \uc5d0\ub7ec \ucc98\ub9ac \uac80\uc99d\n/// - Round-trip \ubcc0\ud658 \uc2dc \ub370\uc774\ud130 \ubcf4\uc874 \ud655\uc778\n///\n/// \ud14c\uc2a4\ud2b8 \uc804\ub7b5:\n/// 1. toDomain (Core Data \u2192 Domain) \ud14c\uc2a4\ud2b8\n///    - \uc815\uc0c1 \ucf00\uc774\uc2a4: \ubaa8\ub4e0 status \uac12\n///    - \uc5d0\ub7ec \ucf00\uc774\uc2a4: \ud544\uc218 \ud544\ub4dc \ub204\ub77d, \uc798\ubabb\ub41c enum \uac12\n///    - \uacbd\uacc4 \uc870\uac74: 0\ubd84, \ub9e4\uc6b0 \uae34 \uc2dc\uac04\n///    - \ubc30\uc5f4 \ubcc0\ud658\n///\n/// 2. toEntity (Domain \u2192 Core Data) \ud14c\uc2a4\ud2b8\n///    - \uc815\uc0c1 \ucf00\uc774\uc2a4: \ubaa8\ub4e0 status \uac12\n///    - Enum \u2192 rawValue \ubcc0\ud658\n///    - \uacbd\uacc4 \uc870\uac74\n///\n/// 3. updateEntity \ud14c\uc2a4\ud2b8\n///    - \uac00\ubcc0 \ud544\ub4dc \uc5c5\ub370\uc774\ud2b8\n///    - \ubd88\ubcc0 \ud544\ub4dc \ubcf4\uc874 (id, userId, createdAt)\n///\n/// 4. Round-trip \ud14c\uc2a4\ud2b8\n///    - Entity \u2192 Domain \u2192 Entity\n///    - Domain \u2192 Entity \u2192 Domain\n///    - \ub370\uc774\ud130 \ubcf4\uc874 \uac80\uc99d\n///\n/// 5. Convenience Method \ud14c\uc2a4\ud2b8\n///    - createAndSave\n///    - updateAndSave\n///\n/// Helper Method \ud65c\uc6a9:\n/// - makeDomainSleepRecord(): \ud14c\uc2a4\ud2b8\uc6a9 Domain \uc5d4\ud2f0\ud2f0 \uc0dd\uc131\n/// - makeEntitySleepRecord(): \ud14c\uc2a4\ud2b8\uc6a9 Core Data \uc5d4\ud2f0\ud2f0 \uc0dd\uc131\n/// - \uae30\ubcf8\uac12 \uc81c\uacf5\uc73c\ub85c \uac04\uacb0\ud55c \ud14c\uc2a4\ud2b8 \uc791\uc131\n///\n/// \ud83d\udca1 \uc2e4\ubb34 \ud301:\n/// - Given-When-Then \ud328\ud134\uc73c\ub85c \uac00\ub3c5\uc131 \ud5a5\uc0c1\n/// - Enum \ubcc0\ud658\uc740 \ubaa8\ub4e0 \ucf00\uc774\uc2a4\ub97c \ud14c\uc2a4\ud2b8\n/// - \uc5d0\ub7ec \ucf00\uc774\uc2a4\ub294 \uad6c\uccb4\uc801\uc778 \uc5d0\ub7ec \ud0c0\uc785\uacfc \uba54\uc2dc\uc9c0 \uac80\uc99d\n/// - Round-trip \ud14c\uc2a4\ud2b8\ub85c \ub370\uc774\ud130 \ubb34\uacb0\uc131 \ubcf4\uc7a5\n/// - In-Memory Core Data \uc0ac\uc6a9\uc73c\ub85c \ube60\ub978 \ud14c\uc2a4\ud2b8 \uc2e4\ud589\n///\n/// \ud83d\udca1 Java \ube44\uad50:\n/// - ModelMapper/MapStruct \ud14c\uc2a4\ud2b8\uc640 \uc720\uc0ac\n/// - Entity \u2194 DTO \ubcc0\ud658 \ub85c\uc9c1 \uac80\uc99d\n/// - @BeforeEach setUp()\uacfc \uc720\uc0ac\ud55c \ud328\ud134\n/// - assertThrows()\uc640 \uc720\uc0ac\ud55c XCTAssertThrowsError\n///\n",
        "last_modified": "2026-01-14T22:52:08.915218"
      },
      "task_intent": {
        "title": "009-sleep-tracking-with-5-status-system",
        "description": "Sleep logging with 5-status tracking (bad, soso, good, excellent, oversleep), duration input, wake time prompts, and correlation with other health metrics. Automatic morning prompt to log previous night's sleep.",
        "from_plan": true
      },
      "commits_behind_main": 0,
      "status": "active",
      "merged_at": null
    }
  },
  "created_at": "2026-01-14T18:01:05.336122",
  "last_updated": "2026-01-14T21:03:40.696449"
}