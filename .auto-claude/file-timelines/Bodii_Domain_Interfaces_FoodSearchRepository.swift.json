{
  "file_path": "Bodii/Domain/Interfaces/FoodSearchRepository.swift",
  "main_branch_history": [],
  "task_views": {
    "005-korean-food-database-integration": {
      "task_id": "005-korean-food-database-integration",
      "branch_point": {
        "commit_hash": "c44bfbcd7c1699b176a8bb155e8c35f43ebd4ad9",
        "content": "",
        "timestamp": "2026-01-13T07:46:23.878686"
      },
      "worktree_state": {
        "content": "//\n//  FoodSearchRepository.swift\n//  Bodii\n//\n//  Created by Auto-Claude on 2026-01-12.\n//\n\n// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Repository Pattern\n// \ub370\uc774\ud130 \uc18c\uc2a4\ub97c \ucd94\uc0c1\ud654\ud558\uc5ec \ub3c4\uba54\uc778 \ub808\uc774\uc5b4\uac00 \ub370\uc774\ud130 \ucd9c\ucc98\uc5d0 \uc758\uc874\ud558\uc9c0 \uc54a\ub3c4\ub85d \ud568\n// \ud83d\udca1 Java \ube44\uad50: Spring Data Repository \uc778\ud130\ud398\uc774\uc2a4\uc640 \uc720\uc0ac\ud55c \uc5ed\ud560\n\nimport Foundation\n\n/// \uc2dd\ud488 \uac80\uc0c9 \uc800\uc7a5\uc18c \ud504\ub85c\ud1a0\ucf5c\n///\n/// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Dependency Inversion Principle (SOLID)\n/// \ub3c4\uba54\uc778 \ub808\uc774\uc5b4\uac00 \ub370\uc774\ud130 \ub808\uc774\uc5b4\uc758 \uad6c\uccb4\uc801\uc778 \uad6c\ud604\uc5d0 \uc758\uc874\ud558\uc9c0 \uc54a\ub3c4\ub85d\n/// \ud504\ub85c\ud1a0\ucf5c\uc744 \ud1b5\ud574 \ucd94\uc0c1\ud654\ub41c \uc778\ud130\ud398\uc774\uc2a4 \uc81c\uacf5\n/// \ud83d\udca1 Java \ube44\uad50: Repository \uc778\ud130\ud398\uc774\uc2a4 (JpaRepository, CrudRepository \ub4f1)\n///\n/// **\uc5ed\ud560:**\n/// - \uc2dd\ud488 \uac80\uc0c9 \uae30\ub2a5\uc758 \ucd94\uc0c1\ud654\ub41c \uc778\ud130\ud398\uc774\uc2a4 \uc815\uc758\n/// - \ub3c4\uba54\uc778 \ub808\uc774\uc5b4\uc640 \ub370\uc774\ud130 \ub808\uc774\uc5b4 \uac04\uc758 \uacbd\uacc4 (Boundary)\n/// - \uad6c\ud604\uccb4\ub294 \uc5ec\ub7ec \ub370\uc774\ud130 \uc18c\uc2a4\ub97c \uc870\ud569\ud558\uac70\ub098 \uc120\ud0dd\ud560 \uc218 \uc788\uc74c\n///\n/// **\uad6c\ud604 \uc804\ub7b5:**\n/// - \uc2dd\uc57d\ucc98 API \uc6b0\uc120 \uac80\uc0c9 (\ud55c\uad6d \uc74c\uc2dd)\n/// - USDA API \ud3f4\ubc31 (\uc678\uad6d \uc74c\uc2dd)\n/// - \ub85c\uceec \uce90\uc2dc \ud65c\uc6a9 (\uc624\ud504\ub77c\uc778 \uc9c0\uc6d0)\n/// - \uac80\uc0c9 \uacb0\uacfc \ubcd1\ud569 \ubc0f \uc911\ubcf5 \uc81c\uac70\n///\n/// **\uc0ac\uc6a9 \uc608\uc2dc:**\n/// ```swift\n/// // DIContainer\uc5d0\uc11c \uc8fc\uc785\ubc1b\uc74c\n/// let repository: FoodSearchRepository = container.resolve()\n///\n/// // \uc2dd\ud488 \uac80\uc0c9\n/// let foods = try await repository.searchFoods(\n///     query: \"\uae40\uce58\ucc0c\uac1c\",\n///     limit: 20,\n///     useCache: true\n/// )\n///\n/// foods.forEach { food in\n///     print(\"\\(food.name): \\(food.calories)kcal (\\(food.source.displayName))\")\n/// }\n/// ```\nprotocol FoodSearchRepository {\n\n    // MARK: - Search Methods\n\n    /// \uc2dd\ud488 \uac80\uc0c9\n    ///\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Protocol Method with Async/Throws\n    /// \ube44\ub3d9\uae30 \uc791\uc5c5\uacfc \uc5d0\ub7ec \ucc98\ub9ac\ub97c \ud504\ub85c\ud1a0\ucf5c \ub808\ubca8\uc5d0\uc11c \uba85\uc2dc\n    /// \ud83d\udca1 Java \ube44\uad50: CompletableFuture\ub97c \ubc18\ud658\ud558\ub294 \uba54\uc11c\ub4dc\uc640 \uc720\uc0ac\n    ///\n    /// **\uac80\uc0c9 \uc804\ub7b5:**\n    /// 1. \uce90\uc2dc \ud655\uc778 (useCache=true\uc778 \uacbd\uc6b0)\n    /// 2. \uc2dd\uc57d\ucc98 API \uac80\uc0c9 (\ud55c\uad6d \uc74c\uc2dd \uc6b0\uc120)\n    /// 3. USDA API \uac80\uc0c9 (\ud3f4\ubc31 \ub610\ub294 \uc678\uad6d \uc74c\uc2dd)\n    /// 4. \uacb0\uacfc \ubcd1\ud569 (\ud55c\uad6d \uc74c\uc2dd \uba3c\uc800)\n    /// 5. \uc911\ubcf5 \uc81c\uac70 (apiCode \uae30\uc900)\n    /// 6. \uac80\uc0c9 \uacb0\uacfc \uce90\uc2dc\uc5d0 \uc800\uc7a5\n    ///\n    /// **\uac80\uc0c9 \ub85c\uc9c1:**\n    /// - \ud55c\uae00\uc774 \ud3ec\ud568\ub41c \uac80\uc0c9\uc5b4: \uc2dd\uc57d\ucc98 API \uba3c\uc800 \u2192 USDA \ud3f4\ubc31\n    /// - \uc601\ubb38 \uac80\uc0c9\uc5b4: USDA API \uba3c\uc800 \u2192 \uc2dd\uc57d\ucc98 \ud3f4\ubc31\n    /// - \ube48 \uacb0\uacfc: \uc591\ucabd API \ubaa8\ub450 \uac80\uc0c9 \u2192 \uce90\uc2dc \uac80\uc0c9\n    ///\n    /// - Parameters:\n    ///   - query: \uac80\uc0c9\uc5b4 (\uc2dd\ud488\uba85, \uc608: \"\uae40\uce58\ucc0c\uac1c\", \"chicken breast\")\n    ///   - limit: \ucd5c\ub300 \uacb0\uacfc \uac1c\uc218 (\uae30\ubcf8\uac12: 20)\n    ///   - offset: \ud398\uc774\uc9d5 \uc624\ud504\uc14b (\uae30\ubcf8\uac12: 0)\n    ///   - useCache: \uce90\uc2dc \uc0ac\uc6a9 \uc5ec\ubd80 (\uae30\ubcf8\uac12: true)\n    ///\n    /// - Returns: \uac80\uc0c9\ub41c \uc2dd\ud488 \ub3c4\uba54\uc778 \uc5d4\ud2f0\ud2f0 \ubc30\uc5f4\n    ///\n    /// - Throws:\n    ///   - `FoodSearchError.invalidQuery`: \uac80\uc0c9\uc5b4\uac00 \ube44\uc5b4\uc788\uac70\ub098 \uc720\ud6a8\ud558\uc9c0 \uc54a\uc74c\n    ///   - `FoodSearchError.networkFailure`: \ub124\ud2b8\uc6cc\ud06c \uc5f0\uacb0 \uc2e4\ud328\n    ///   - `FoodSearchError.apiError`: API \uc694\uccad \uc2e4\ud328\n    ///   - `FoodSearchError.noResults`: \uac80\uc0c9 \uacb0\uacfc \uc5c6\uc74c (\ube48 \ubc30\uc5f4 \ubc18\ud658)\n    ///\n    /// - Note: \uc5d0\ub7ec \ubc1c\uc0dd \uc2dc \uce90\uc2dc\ub41c \uacb0\uacfc\ub97c \ubc18\ud658\ud560 \uc218 \uc788\uc74c (graceful degradation)\n    ///\n    /// - Example:\n    /// ```swift\n    /// // \uae30\ubcf8 \uac80\uc0c9\n    /// let foods = try await searchFoods(query: \"\ud604\ubbf8\ubc25\")\n    ///\n    /// // \ud398\uc774\uc9d5 \uac80\uc0c9\n    /// let moreFoods = try await searchFoods(\n    ///     query: \"\ud604\ubbf8\ubc25\",\n    ///     limit: 10,\n    ///     offset: 10\n    /// )\n    ///\n    /// // \uce90\uc2dc \uc5c6\uc774 \uac80\uc0c9 (\ud56d\uc0c1 \ucd5c\uc2e0 \ub370\uc774\ud130)\n    /// let freshFoods = try await searchFoods(\n    ///     query: \"\ud604\ubbf8\ubc25\",\n    ///     useCache: false\n    /// )\n    /// ```\n    func searchFoods(\n        query: String,\n        limit: Int,\n        offset: Int,\n        useCache: Bool\n    ) async throws -> [Food]\n\n    // MARK: - Cache Methods\n\n    /// \ucd5c\uadfc \uac80\uc0c9\ud55c \uc2dd\ud488 \ubaa9\ub85d \uc870\ud68c\n    ///\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Cache-First Strategy\n    /// \uc624\ud504\ub77c\uc778 \uc9c0\uc6d0\uacfc \ube60\ub978 \uc751\ub2f5\uc744 \uc704\ud55c \uce90\uc2dc \uc6b0\uc120 \uc804\ub7b5\n    /// \ud83d\udca1 Java \ube44\uad50: @Cacheable \uc5b4\ub178\ud14c\uc774\uc158\uacfc \uc720\uc0ac\n    ///\n    /// - Parameter limit: \ucd5c\ub300 \uacb0\uacfc \uac1c\uc218 (\uae30\ubcf8\uac12: 20)\n    ///\n    /// - Returns: \ucd5c\uadfc \uac80\uc0c9\ud55c \uc2dd\ud488 \ubaa9\ub85d (lastAccessedAt \uae30\uc900 \uc815\ub82c)\n    ///\n    /// - Note: \uce90\uc2dc\uc5d0 \uc800\uc7a5\ub41c \uc2dd\ud488\ub9cc \ubc18\ud658 (API \ud638\ucd9c \uc5c6\uc74c)\n    ///\n    /// - Example:\n    /// ```swift\n    /// let recentFoods = try await getRecentFoods(limit: 10)\n    /// // \ucd5c\uadfc 10\uac1c \uc2dd\ud488 \ubc18\ud658\n    /// ```\n    func getRecentFoods(limit: Int) async throws -> [Food]\n\n    /// \uc2dd\ud488 \uc811\uadfc \uc2dc\uac04 \uc5c5\ub370\uc774\ud2b8\n    ///\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Activity Tracking\n    /// \uc0ac\uc6a9\uc790\uac00 \uc2dd\ud488\uc744 \uc120\ud0dd\ud560 \ub54c\ub9c8\ub2e4 \uc811\uadfc \uc2dc\uac04 \uc5c5\ub370\uc774\ud2b8\n    /// LRU(Least Recently Used) \uce90\uc2dc \uc815\ucc45\uc5d0 \uc0ac\uc6a9\n    /// \ud83d\udca1 Java \ube44\uad50: @CachePut\uacfc \uc720\uc0ac\n    ///\n    /// - Parameter foodId: \uc2dd\ud488 \uace0\uc720 ID\n    ///\n    /// - Note: \uce90\uc2dc\uc5d0 \uc5c6\ub294 \uc2dd\ud488\uc774\uba74 \ubb34\uc2dc\n    ///\n    /// - Example:\n    /// ```swift\n    /// // \uc0ac\uc6a9\uc790\uac00 \uc2dd\ud488\uc744 \uc120\ud0dd\ud588\uc744 \ub54c\n    /// try await updateFoodAccessTime(foodId: food.id)\n    /// ```\n    func updateFoodAccessTime(foodId: UUID) async throws\n\n    /// \uce90\uc2dc \uc815\ub9ac (LRU \uc815\ucc45)\n    ///\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Cache Eviction Policy\n    /// \uc624\ub798\ub41c \uce90\uc2dc \ud56d\ubaa9\uc744 \uc790\ub3d9\uc73c\ub85c \uc815\ub9ac\ud558\uc5ec \uc800\uc7a5 \uacf5\uac04 \ucd5c\uc801\ud654\n    /// \ud83d\udca1 Java \ube44\uad50: @CacheEvict(allEntries=true)\uc640 \uc720\uc0ac\n    ///\n    /// - Parameter maxCacheSize: \uce90\uc2dc \ucd5c\ub300 \ud06c\uae30 (\uae30\ubcf8\uac12: 500)\n    ///\n    /// - Note: lastAccessedAt \uae30\uc900\uc73c\ub85c \uc624\ub798\ub41c \ud56d\ubaa9\ubd80\ud130 \uc0ad\uc81c\n    ///\n    /// - Example:\n    /// ```swift\n    /// // \uc8fc\uae30\uc801\uc73c\ub85c \uce90\uc2dc \uc815\ub9ac (\uc608: \uc571 \uc2dc\uc791 \uc2dc)\n    /// try await cleanupCache(maxCacheSize: 500)\n    /// ```\n    func cleanupCache(maxCacheSize: Int) async throws\n}\n\n// MARK: - Default Parameter Values\n\nextension FoodSearchRepository {\n\n    /// \uc2dd\ud488 \uac80\uc0c9 (\uae30\ubcf8 \ud30c\ub77c\ubbf8\ud130 \uc801\uc6a9)\n    ///\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Protocol Extension with Default Values\n    /// \ud504\ub85c\ud1a0\ucf5c \uc775\uc2a4\ud150\uc158\uc744 \ud1b5\ud574 \uae30\ubcf8 \ud30c\ub77c\ubbf8\ud130 \uac12 \uc81c\uacf5\n    /// \ud638\ucd9c \ucf54\ub4dc\ub97c \uac04\uacb0\ud558\uac8c \ub9cc\ub4e4\uace0 \uc720\uc5f0\uc131 \ud5a5\uc0c1\n    /// \ud83d\udca1 Java \ube44\uad50: \uba54\uc11c\ub4dc \uc624\ubc84\ub85c\ub529\uacfc \uc720\uc0ac\ud55c \ud6a8\uacfc\n    ///\n    /// - Parameter query: \uac80\uc0c9\uc5b4\n    ///\n    /// - Returns: \uac80\uc0c9\ub41c \uc2dd\ud488 \ubc30\uc5f4 (\ucd5c\ub300 20\uac1c, \uce90\uc2dc \uc0ac\uc6a9)\n    func searchFoods(query: String) async throws -> [Food] {\n        try await searchFoods(\n            query: query,\n            limit: 20,\n            offset: 0,\n            useCache: true\n        )\n    }\n\n    /// \ucd5c\uadfc \uac80\uc0c9\ud55c \uc2dd\ud488 \ubaa9\ub85d \uc870\ud68c (\uae30\ubcf8 \ud30c\ub77c\ubbf8\ud130 \uc801\uc6a9)\n    ///\n    /// - Returns: \ucd5c\uadfc 20\uac1c \uc2dd\ud488\n    func getRecentFoods() async throws -> [Food] {\n        try await getRecentFoods(limit: 20)\n    }\n\n    /// \uce90\uc2dc \uc815\ub9ac (\uae30\ubcf8 \ud30c\ub77c\ubbf8\ud130 \uc801\uc6a9)\n    func cleanupCache() async throws {\n        try await cleanupCache(maxCacheSize: 500)\n    }\n}\n\n// MARK: - Search Error\n// FoodSearchError\ub294 \ubcc4\ub3c4 \ud30c\uc77c\ub85c \ubd84\ub9ac\ub428: FoodSearchError.swift\n// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Error Type Separation\n// \uc5d0\ub7ec \ud0c0\uc785\uc744 \ubcc4\ub3c4 \ud30c\uc77c\ub85c \ubd84\ub9ac\ud558\uc5ec \uc7ac\uc0ac\uc6a9\uc131\uacfc \uc720\uc9c0\ubcf4\uc218\uc131 \ud5a5\uc0c1\n// \ud83d\udca1 Java \ube44\uad50: Custom Exception\uc744 \ubcc4\ub3c4 \ud074\ub798\uc2a4 \ud30c\uc77c\ub85c \ubd84\ub9ac\ud558\ub294 \uac83\uacfc \ub3d9\uc77c\n",
        "last_modified": "2026-01-14T22:55:39.264720"
      },
      "task_intent": {
        "title": "005-korean-food-database-integration",
        "description": "Integrate Korean Food & Drug Administration (\uc2dd\uc57d\ucc98) food nutrition database API as primary source, with USDA FoodData Central as fallback for international foods. Prioritize Korean dishes (kimchi jjigae, bibimbap, tteokbokki) that are poorly covered by competitors.",
        "from_plan": true
      },
      "commits_behind_main": 0,
      "status": "active",
      "merged_at": null
    }
  },
  "created_at": "2026-01-13T07:43:31.876892",
  "last_updated": "2026-01-13T07:46:24.046630"
}