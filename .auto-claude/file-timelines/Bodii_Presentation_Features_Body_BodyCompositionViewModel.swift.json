{
  "file_path": "Bodii/Presentation/Features/Body/BodyCompositionViewModel.swift",
  "main_branch_history": [],
  "task_views": {
    "003-body-composition-tracking-with-bmr-tdee": {
      "task_id": "003-body-composition-tracking-with-bmr-tdee",
      "branch_point": {
        "commit_hash": "2abdae73fb6199bcbf4f21f6deeb7952225f81e6",
        "content": "",
        "timestamp": "2026-01-13T07:46:22.394743"
      },
      "worktree_state": {
        "content": "//\n//  BodyCompositionViewModel.swift\n//  Bodii\n//\n//  Created by Auto-Claude on 2026-01-12.\n//\n\n// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: ViewModel Pattern in SwiftUI\n// MVVM \ud328\ud134\uc758 ViewModel - View\uc640 \ube44\uc988\ub2c8\uc2a4 \ub85c\uc9c1\uc744 \uc5f0\uacb0\n// \ud83d\udca1 Java \ube44\uad50: Android\uc758 ViewModel\uacfc \uc720\uc0ac\ud558\uc9c0\ub9cc SwiftUI\uc758 @Published \uc0ac\uc6a9\n\nimport Foundation\nimport SwiftUI\nimport Combine\n\n// MARK: - BodyCompositionViewModel\n\n/// \uc2e0\uccb4 \uad6c\uc131 \uc785\ub825 \ubc0f \ud788\uc2a4\ud1a0\ub9ac \ud45c\uc2dc\ub97c \uc704\ud55c ViewModel\n/// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: MVVM Pattern\n/// - View\uc758 \uc0c1\ud0dc\ub97c \uad00\ub9ac\ud558\uace0 \ube44\uc988\ub2c8\uc2a4 \ub85c\uc9c1 \ud638\ucd9c\n/// - @Published\ub85c \uc0c1\ud0dc \ubcc0\uacbd \uc2dc \uc790\ub3d9\uc73c\ub85c View \uc5c5\ub370\uc774\ud2b8\n/// - @MainActor\ub85c UI \uc2a4\ub808\ub4dc\uc5d0\uc11c \uc548\uc804\ud558\uac8c \uc2e4\ud589\n/// \ud83d\udca1 Java \ube44\uad50: Android ViewModel + LiveData\uc640 \uc720\uc0ac\n@MainActor\nclass BodyCompositionViewModel: ObservableObject {\n\n    // MARK: - Published Properties (Input State)\n\n    /// \uccb4\uc911 \uc785\ub825 \uac12 (kg)\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: @Published\n    /// - \uac12\uc774 \ubcc0\uacbd\ub418\uba74 \uc790\ub3d9\uc73c\ub85c View \uc5c5\ub370\uc774\ud2b8\n    /// - SwiftUI\uc758 \uc591\ubc29\ud5a5 \ubc14\uc778\ub529 \uc9c0\uc6d0\n    /// \ud83d\udca1 Java \ube44\uad50: LiveData\uc640 \uc720\uc0ac\n    @Published var weightInput: String = \"\"\n\n    /// \uccb4\uc9c0\ubc29\ub960 \uc785\ub825 \uac12 (%)\n    @Published var bodyFatPercentInput: String = \"\"\n\n    /// \uadfc\uc721\ub7c9 \uc785\ub825 \uac12 (kg)\n    @Published var muscleMassInput: String = \"\"\n\n    // MARK: - Published Properties (View State)\n\n    /// \ub85c\ub529 \uc0c1\ud0dc\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Loading State\n    /// - API \ud638\ucd9c \uc911 \ub85c\ub529 \uc778\ub514\ucf00\uc774\ud130 \ud45c\uc2dc\uc5d0 \uc0ac\uc6a9\n    @Published var isLoading: Bool = false\n\n    /// \uc800\uc7a5 \uc911 \uc0c1\ud0dc\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Separate Loading States\n    /// - \ub370\uc774\ud130 \uc870\ud68c\uc640 \uc800\uc7a5\uc744 \uad6c\ubd84\ud558\uc5ec UX \uac1c\uc120\n    @Published var isSaving: Bool = false\n\n    /// \uc5d0\ub7ec \uba54\uc2dc\uc9c0\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Optional Error State\n    /// - nil\uc774\uba74 \uc5d0\ub7ec \uc5c6\uc74c, \uac12\uc774 \uc788\uc73c\uba74 \uc5d0\ub7ec \uba54\uc2dc\uc9c0 \ud45c\uc2dc\n    @Published var errorMessage: String?\n\n    /// \uc131\uacf5 \uba54\uc2dc\uc9c0\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Success Feedback\n    /// - \uc800\uc7a5 \uc131\uacf5 \uc2dc \uc0ac\uc6a9\uc790\uc5d0\uac8c \ud53c\ub4dc\ubc31 \uc81c\uacf5\n    @Published var successMessage: String?\n\n    /// \uc2e0\uccb4 \uad6c\uc131 \uae30\ub85d \ud788\uc2a4\ud1a0\ub9ac\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Collection State\n    /// - \ucd5c\uadfc \uae30\ub85d\ub4e4\uc744 \ub9ac\uc2a4\ud2b8\ub85c \ud45c\uc2dc\n    @Published var history: [BodyCompositionEntry] = []\n\n    /// \ucd5c\uadfc \ub300\uc0ac\uc728 \ub370\uc774\ud130\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Optional State\n    /// - \uac00\uc7a5 \ucd5c\uadfc \uacc4\uc0b0\ub41c BMR/TDEE \ud45c\uc2dc\n    @Published var latestMetabolism: MetabolismData?\n\n    /// \uc785\ub825 \uc720\ud6a8\uc131 \uac80\uc99d \uba54\uc2dc\uc9c0\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Validation Feedback\n    /// - \uc2e4\uc2dc\uac04 \uc785\ub825 \uac80\uc99d \ud53c\ub4dc\ubc31\n    @Published var validationMessages: [String] = []\n\n    // MARK: - Private Properties\n\n    /// \uc2e0\uccb4 \uad6c\uc131 \uae30\ub85d Use Case\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Dependency Injection\n    /// - Use Case\ub97c \uc678\ubd80\uc5d0\uc11c \uc8fc\uc785\ubc1b\uc544 \uc0ac\uc6a9\n    /// - \ud14c\uc2a4\ud2b8 \uc2dc Mock\uc73c\ub85c \uad50\uccb4 \uac00\ub2a5\n    private let recordBodyCompositionUseCase: RecordBodyCompositionUseCase\n\n    /// \uc2e0\uccb4 \ud2b8\ub80c\ub4dc \uc870\ud68c Use Case\n    private let fetchBodyTrendsUseCase: FetchBodyTrendsUseCase\n\n    /// \uc2e0\uccb4 \ub370\uc774\ud130 \uc800\uc7a5\uc18c\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Protocol-Oriented Programming\n    /// - \uad6c\ud604\uccb4\uac00 \uc544\ub2cc \ud504\ub85c\ud1a0\ucf5c\uc5d0 \uc758\uc874\n    private let bodyRepository: BodyRepositoryProtocol\n\n    /// \uc0ac\uc6a9\uc790 \ud504\ub85c\ud544\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: User Context\n    /// - BMR/TDEE \uacc4\uc0b0\uc5d0 \ud544\uc694\ud55c \uc0ac\uc6a9\uc790 \uc815\ubcf4\n    /// - TODO: UserRepository\uc5d0\uc11c \uc870\ud68c\ud558\ub3c4\ub85d \uac1c\uc120\n    private var userProfile: UserProfile\n\n    /// Combine \uad6c\ub3c5 \uc800\uc7a5\uc18c\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Combine Framework\n    /// - \ube44\ub3d9\uae30 \uc774\ubca4\ud2b8 \uc2a4\ud2b8\ub9bc \uad00\ub9ac\n    /// - \uba54\ubaa8\ub9ac \ub204\uc218 \ubc29\uc9c0\ub97c \uc704\ud55c \uad6c\ub3c5 \uad00\ub9ac\n    /// \ud83d\udca1 Java \ube44\uad50: RxJava\uc758 CompositeDisposable\uacfc \uc720\uc0ac\n    private var cancellables = Set<AnyCancellable>()\n\n    // MARK: - Initialization\n\n    /// BodyCompositionViewModel \ucd08\uae30\ud654\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Dependency Injection via Constructor\n    /// - \ubaa8\ub4e0 \uc758\uc874\uc131\uc744 \uc0dd\uc131\uc790\ub97c \ud1b5\ud574 \uc8fc\uc785\ubc1b\uc74c\n    /// - \uc758\uc874\uc131 \uc5ed\uc804 \uc6d0\uce59 (Dependency Inversion Principle) \uc900\uc218\n    /// \ud83d\udca1 Java \ube44\uad50: @Inject constructor\uc640 \uc720\uc0ac\n    ///\n    /// - Parameters:\n    ///   - recordBodyCompositionUseCase: \uc2e0\uccb4 \uad6c\uc131 \uae30\ub85d Use Case\n    ///   - fetchBodyTrendsUseCase: \uc2e0\uccb4 \ud2b8\ub80c\ub4dc \uc870\ud68c Use Case\n    ///   - bodyRepository: \uc2e0\uccb4 \ub370\uc774\ud130 \uc800\uc7a5\uc18c\n    ///   - userProfile: \uc0ac\uc6a9\uc790 \ud504\ub85c\ud544 (\uae30\ubcf8\uac12: \uc0d8\ud50c \ub370\uc774\ud130)\n    init(\n        recordBodyCompositionUseCase: RecordBodyCompositionUseCase,\n        fetchBodyTrendsUseCase: FetchBodyTrendsUseCase,\n        bodyRepository: BodyRepositoryProtocol,\n        userProfile: UserProfile = .sample\n    ) {\n        self.recordBodyCompositionUseCase = recordBodyCompositionUseCase\n        self.fetchBodyTrendsUseCase = fetchBodyTrendsUseCase\n        self.bodyRepository = bodyRepository\n        self.userProfile = userProfile\n\n        // \ucd08\uae30 \ub370\uc774\ud130 \ub85c\ub4dc\n        Task {\n            await loadHistory()\n            await loadLatestMetabolism()\n        }\n    }\n\n    // MARK: - Computed Properties\n\n    /// \uc785\ub825 \uac12\uc774 \uc720\ud6a8\ud55c\uc9c0 \ud655\uc778\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Computed Property for Validation\n    /// - \uc2e4\uc2dc\uac04\uc73c\ub85c \uc785\ub825 \uc720\ud6a8\uc131 \uac80\uc99d\n    /// - View\uc5d0\uc11c \uc800\uc7a5 \ubc84\ud2bc \ud65c\uc131\ud654/\ube44\ud65c\uc131\ud654\uc5d0 \uc0ac\uc6a9\n    var isInputValid: Bool {\n        guard let weight = Decimal(string: weightInput),\n              let bodyFatPercent = Decimal(string: bodyFatPercentInput),\n              let muscleMass = Decimal(string: muscleMassInput) else {\n            return false\n        }\n\n        // \ubc94\uc704 \uac80\uc99d\n        guard weight >= 20 && weight <= 500 else { return false }\n        guard bodyFatPercent >= 1 && bodyFatPercent <= 60 else { return false }\n        guard muscleMass >= 10 && muscleMass <= 100 else { return false }\n        guard muscleMass < weight else { return false }\n\n        return true\n    }\n\n    /// \uc800\uc7a5 \ubc84\ud2bc \ud65c\uc131\ud654 \uc5ec\ubd80\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: UI State Calculation\n    /// - \uc785\ub825\uc774 \uc720\ud6a8\ud558\uace0 \uc800\uc7a5 \uc911\uc774 \uc544\ub2d0 \ub54c\ub9cc \ud65c\uc131\ud654\n    var canSave: Bool {\n        isInputValid && !isSaving\n    }\n\n    // MARK: - Public Methods\n\n    /// \uc2e0\uccb4 \uad6c\uc131 \ub370\uc774\ud130 \uc800\uc7a5\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Async Method in ViewModel\n    /// - Use Case\ub97c \ud638\ucd9c\ud558\uc5ec \ube44\uc988\ub2c8\uc2a4 \ub85c\uc9c1 \uc2e4\ud589\n    /// - \uc131\uacf5/\uc2e4\ud328 \ucc98\ub9ac \ubc0f UI \uc0c1\ud0dc \uc5c5\ub370\uc774\ud2b8\n    /// \ud83d\udca1 Java \ube44\uad50: Kotlin Coroutines\uc758 suspend function\uacfc \uc720\uc0ac\n    func saveBodyComposition() async {\n        // \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Guard Statement\n        // \uc785\ub825\uc774 \uc720\ud6a8\ud558\uc9c0 \uc54a\uc73c\uba74 \uc870\uae30 \ub9ac\ud134\n        guard isInputValid else {\n            errorMessage = \"\uc785\ub825 \uac12\uc774 \uc720\ud6a8\ud558\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4.\"\n            return\n        }\n\n        // \uc785\ub825 \uac12\uc744 Decimal\ub85c \ubcc0\ud658\n        guard let weight = Decimal(string: weightInput),\n              let bodyFatPercent = Decimal(string: bodyFatPercentInput),\n              let muscleMass = Decimal(string: muscleMassInput) else {\n            errorMessage = \"\uc22b\uc790 \ubcc0\ud658\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.\"\n            return\n        }\n\n        // \uc800\uc7a5 \uc2dc\uc791\n        isSaving = true\n        errorMessage = nil\n        successMessage = nil\n\n        do {\n            // \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Use Case Execution\n            // \ube44\uc988\ub2c8\uc2a4 \ub85c\uc9c1\uc740 Use Case\uc5d0 \uc704\uc784\n            let result = try await recordBodyCompositionUseCase.execute(\n                weight: weight,\n                bodyFatPercent: bodyFatPercent,\n                muscleMass: muscleMass,\n                userProfile: userProfile\n            )\n\n            // \uc131\uacf5 \ucc98\ub9ac\n            successMessage = \"\uc800\uc7a5\ub418\uc5c8\uc2b5\ub2c8\ub2e4. BMR: \\(formatCalories(result.bmr)) kcal/day\"\n\n            // \ucd5c\uadfc \ub300\uc0ac\uc728 \ub370\uc774\ud130 \uc5c5\ub370\uc774\ud2b8\n            latestMetabolism = result.metabolismData\n\n            // \uc785\ub825 \ud544\ub4dc \ucd08\uae30\ud654\n            clearInputs()\n\n            // \ud788\uc2a4\ud1a0\ub9ac \uc0c8\ub85c\uace0\uce68\n            await loadHistory()\n\n            // \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Delayed Message Clear\n            // 3\ucd08 \ud6c4 \uc131\uacf5 \uba54\uc2dc\uc9c0 \uc790\ub3d9 \uc81c\uac70\n            Task {\n                try? await Task.sleep(nanoseconds: 3_000_000_000) // 3\ucd08\n                successMessage = nil\n            }\n\n        } catch let error as RecordBodyCompositionUseCase.RecordError {\n            // \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Specific Error Handling\n            // Use Case\uc758 \ub3c4\uba54\uc778 \uc5d0\ub7ec\ub97c \uc0ac\uc6a9\uc790 \uce5c\ud654\uc801 \uba54\uc2dc\uc9c0\ub85c \ubcc0\ud658\n            errorMessage = error.localizedDescription\n        } catch {\n            // \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Generic Error Handling\n            // \uc608\uc0c1\ud558\uc9c0 \ubabb\ud55c \uc5d0\ub7ec \ucc98\ub9ac\n            errorMessage = \"\uc800\uc7a5 \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4: \\(error.localizedDescription)\"\n        }\n\n        isSaving = false\n    }\n\n    /// \ud788\uc2a4\ud1a0\ub9ac \ub85c\ub4dc\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Data Loading Method\n    /// - Repository\uc5d0\uc11c \ucd5c\uadfc \ub370\uc774\ud130 \uc870\ud68c\n    /// - \uc5d0\ub7ec \ucc98\ub9ac \ubc0f \ub85c\ub529 \uc0c1\ud0dc \uad00\ub9ac\n    func loadHistory() async {\n        isLoading = true\n        errorMessage = nil\n\n        do {\n            // \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Repository Query\n            // \ucd5c\uadfc 30\uc77c \ub370\uc774\ud130 \uc870\ud68c\n            history = try await bodyRepository.fetchRecent(days: 30)\n        } catch {\n            errorMessage = \"\ud788\uc2a4\ud1a0\ub9ac \ub85c\ub4dc \uc2e4\ud328: \\(error.localizedDescription)\"\n            history = []\n        }\n\n        isLoading = false\n    }\n\n    /// \ucd5c\uadfc \ub300\uc0ac\uc728 \ub370\uc774\ud130 \ub85c\ub4dc\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Related Data Loading\n    /// - \uac00\uc7a5 \ucd5c\uadfc \uae30\ub85d\uc758 \ub300\uc0ac\uc728 \ub370\uc774\ud130 \uc870\ud68c\n    private func loadLatestMetabolism() async {\n        do {\n            // \uac00\uc7a5 \ucd5c\uadfc \uae30\ub85d \uc870\ud68c\n            if let latestEntry = try await bodyRepository.fetchLatest() {\n                // \ud574\ub2f9 \uae30\ub85d\uc758 \ub300\uc0ac\uc728 \ub370\uc774\ud130 \uc870\ud68c\n                latestMetabolism = try await bodyRepository.fetchMetabolismData(for: latestEntry.id)\n            }\n        } catch {\n            // \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Silent Failure\n            // \uc120\ud0dd\uc801 \ub370\uc774\ud130 \ub85c\ub4dc \uc2e4\ud328\ub294 \uc870\uc6a9\ud788 \ucc98\ub9ac\n            print(\"\u26a0\ufe0f \ucd5c\uadfc \ub300\uc0ac\uc728 \ub370\uc774\ud130 \ub85c\ub4dc \uc2e4\ud328: \\(error.localizedDescription)\")\n        }\n    }\n\n    /// \ud2b9\uc815 \uae30\ub85d \uc0ad\uc81c\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Delete Operation\n    /// - \uc0ac\uc6a9\uc790 \ud655\uc778 \ud6c4 \ud638\ucd9c\n    /// - \uc0ad\uc81c \ud6c4 \ud788\uc2a4\ud1a0\ub9ac \uc0c8\ub85c\uace0\uce68\n    ///\n    /// - Parameter id: \uc0ad\uc81c\ud560 \uae30\ub85d ID\n    func deleteEntry(id: UUID) async {\n        isLoading = true\n        errorMessage = nil\n\n        do {\n            try await bodyRepository.delete(by: id)\n\n            // \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Optimistic Update\n            // \uc11c\ubc84 \uc751\ub2f5\uc744 \uae30\ub2e4\ub9ac\uc9c0 \uc54a\uace0 \uc989\uc2dc UI\uc5d0\uc11c \uc81c\uac70\n            history.removeAll { $0.id == id }\n\n            successMessage = \"\uc0ad\uc81c\ub418\uc5c8\uc2b5\ub2c8\ub2e4.\"\n\n            // 3\ucd08 \ud6c4 \uba54\uc2dc\uc9c0 \uc81c\uac70\n            Task {\n                try? await Task.sleep(nanoseconds: 3_000_000_000)\n                successMessage = nil\n            }\n\n        } catch {\n            errorMessage = \"\uc0ad\uc81c \uc2e4\ud328: \\(error.localizedDescription)\"\n        }\n\n        isLoading = false\n    }\n\n    /// \uc785\ub825 \ud544\ub4dc \ucd08\uae30\ud654\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: State Reset\n    /// - \uc800\uc7a5 \ud6c4 \uc785\ub825 \ud544\ub4dc \ud074\ub9ac\uc5b4\n    func clearInputs() {\n        weightInput = \"\"\n        bodyFatPercentInput = \"\"\n        muscleMassInput = \"\"\n        validationMessages = []\n    }\n\n    /// \uc785\ub825 \uac80\uc99d \ubc0f \uac80\uc99d \uba54\uc2dc\uc9c0 \uc5c5\ub370\uc774\ud2b8\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Real-time Validation\n    /// - \uc0ac\uc6a9\uc790\uac00 \uc785\ub825\ud560 \ub54c\ub9c8\ub2e4 \uc2e4\uc2dc\uac04 \uac80\uc99d\n    /// - \uad6c\uccb4\uc801\uc778 \uc5d0\ub7ec \uba54\uc2dc\uc9c0 \uc81c\uacf5\n    func validateInputs() {\n        validationMessages = []\n\n        // \uccb4\uc911 \uac80\uc99d\n        if !weightInput.isEmpty {\n            if let weight = Decimal(string: weightInput) {\n                if weight < 20 {\n                    validationMessages.append(\"\uccb4\uc911\uc740 20kg \uc774\uc0c1\uc774\uc5b4\uc57c \ud569\ub2c8\ub2e4.\")\n                } else if weight > 500 {\n                    validationMessages.append(\"\uccb4\uc911\uc740 500kg \uc774\ud558\uc5ec\uc57c \ud569\ub2c8\ub2e4.\")\n                }\n            } else {\n                validationMessages.append(\"\uccb4\uc911\uc744 \uc62c\ubc14\ub974\uac8c \uc785\ub825\ud574\uc8fc\uc138\uc694.\")\n            }\n        }\n\n        // \uccb4\uc9c0\ubc29\ub960 \uac80\uc99d\n        if !bodyFatPercentInput.isEmpty {\n            if let bodyFatPercent = Decimal(string: bodyFatPercentInput) {\n                if bodyFatPercent < 1 {\n                    validationMessages.append(\"\uccb4\uc9c0\ubc29\ub960\uc740 1% \uc774\uc0c1\uc774\uc5b4\uc57c \ud569\ub2c8\ub2e4.\")\n                } else if bodyFatPercent > 60 {\n                    validationMessages.append(\"\uccb4\uc9c0\ubc29\ub960\uc740 60% \uc774\ud558\uc5ec\uc57c \ud569\ub2c8\ub2e4.\")\n                }\n            } else {\n                validationMessages.append(\"\uccb4\uc9c0\ubc29\ub960\uc744 \uc62c\ubc14\ub974\uac8c \uc785\ub825\ud574\uc8fc\uc138\uc694.\")\n            }\n        }\n\n        // \uadfc\uc721\ub7c9 \uac80\uc99d\n        if !muscleMassInput.isEmpty {\n            if let muscleMass = Decimal(string: muscleMassInput) {\n                if muscleMass < 10 {\n                    validationMessages.append(\"\uadfc\uc721\ub7c9\uc740 10kg \uc774\uc0c1\uc774\uc5b4\uc57c \ud569\ub2c8\ub2e4.\")\n                } else if muscleMass > 100 {\n                    validationMessages.append(\"\uadfc\uc721\ub7c9\uc740 100kg \uc774\ud558\uc5ec\uc57c \ud569\ub2c8\ub2e4.\")\n                }\n\n                // \uadfc\uc721\ub7c9\uc774 \uccb4\uc911\ubcf4\ub2e4 \ud070\uc9c0 \uac80\uc99d\n                if let weight = Decimal(string: weightInput), muscleMass >= weight {\n                    validationMessages.append(\"\uadfc\uc721\ub7c9\uc740 \uccb4\uc911\ubcf4\ub2e4 \uc791\uc544\uc57c \ud569\ub2c8\ub2e4.\")\n                }\n            } else {\n                validationMessages.append(\"\uadfc\uc721\ub7c9\uc744 \uc62c\ubc14\ub974\uac8c \uc785\ub825\ud574\uc8fc\uc138\uc694.\")\n            }\n        }\n    }\n\n    /// \uc0ac\uc6a9\uc790 \ud504\ub85c\ud544 \uc5c5\ub370\uc774\ud2b8\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Profile Management\n    /// - BMR/TDEE \uacc4\uc0b0\uc5d0 \uc0ac\uc6a9\ub418\ub294 \ud504\ub85c\ud544 \uc5c5\ub370\uc774\ud2b8\n    /// - TODO: UserRepository\ub97c \ud1b5\ud574 \uc601\uad6c \uc800\uc7a5\n    ///\n    /// - Parameter newProfile: \uc0c8\ub85c\uc6b4 \uc0ac\uc6a9\uc790 \ud504\ub85c\ud544\n    func updateUserProfile(_ newProfile: UserProfile) {\n        self.userProfile = newProfile\n    }\n\n    // MARK: - Helper Methods\n\n    /// \uce7c\ub85c\ub9ac \uac12 \ud3ec\ub9f7\ud305\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Number Formatting\n    /// - Decimal\uc744 \uc77d\uae30 \uc26c\uc6b4 \ubb38\uc790\uc5f4\ub85c \ubcc0\ud658\n    /// - \uc18c\uc218\uc810 \uc5c6\uc774 \uc815\uc218\ub85c \ud45c\uc2dc\n    ///\n    /// - Parameter calories: \uce7c\ub85c\ub9ac \uac12\n    /// - Returns: \ud3ec\ub9f7\ub41c \ubb38\uc790\uc5f4 (\uc608: \"1,650\")\n    private func formatCalories(_ calories: Decimal) -> String {\n        let formatter = NumberFormatter()\n        formatter.numberStyle = .decimal\n        formatter.maximumFractionDigits = 0\n        formatter.minimumFractionDigits = 0\n\n        let number = NSDecimalNumber(decimal: calories)\n        return formatter.string(from: number) ?? \"\\(calories)\"\n    }\n}\n\n// MARK: - Preview Support\n\n#if DEBUG\nextension BodyCompositionViewModel {\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Preview Helper\n    /// SwiftUI Preview\ub97c \uc704\ud55c Mock ViewModel\n    /// \ud83d\udca1 Java \ube44\uad50: Test fixture\uc640 \uc720\uc0ac\n    static func makePreview() -> BodyCompositionViewModel {\n        // Mock Repository \uc0dd\uc131 (\uc2e4\uc81c \uad6c\ud604 \ud544\uc694)\n        // \uc5ec\uae30\uc11c\ub294 \uc0d8\ud50c \ub370\uc774\ud130\ub97c \ubc18\ud658\ud558\ub294 Mock \uc0ac\uc6a9\n        fatalError(\"Preview support not yet implemented. Need to create MockBodyRepository.\")\n    }\n}\n#endif\n\n// MARK: - Documentation\n\n/// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: ViewModel Pattern \uc774\ud574\n///\n/// BodyCompositionViewModel\uc758 \uc5ed\ud560:\n/// - View\uc758 \uc0c1\ud0dc \uad00\ub9ac: @Published \ud504\ub85c\ud37c\ud2f0\ub85c View \uc790\ub3d9 \uc5c5\ub370\uc774\ud2b8\n/// - \ube44\uc988\ub2c8\uc2a4 \ub85c\uc9c1 \ud638\ucd9c: Use Case\ub97c \ud1b5\ud574 \ub3c4\uba54\uc778 \ub85c\uc9c1 \uc2e4\ud589\n/// - \uc5d0\ub7ec \ucc98\ub9ac: \ub3c4\uba54\uc778 \uc5d0\ub7ec\ub97c \uc0ac\uc6a9\uc790 \uce5c\ud654\uc801 \uba54\uc2dc\uc9c0\ub85c \ubcc0\ud658\n/// - \uc785\ub825 \uac80\uc99d: \uc2e4\uc2dc\uac04 \uc785\ub825 \uac80\uc99d \ubc0f \ud53c\ub4dc\ubc31\n/// - \ub370\uc774\ud130 \ub85c\ub529: Repository\ub97c \ud1b5\ud574 \ud788\uc2a4\ud1a0\ub9ac \uc870\ud68c\n///\n/// MVVM \ud328\ud134\uc5d0\uc11c\uc758 \uc704\uce58:\n/// - Model: Domain entities (BodyCompositionEntry, MetabolismData)\n/// - View: SwiftUI Views (BodyCompositionView)\n/// - ViewModel: \uc774 \ud074\ub798\uc2a4 (BodyCompositionViewModel)\n///\n/// \uc0c1\ud0dc \uad00\ub9ac:\n/// - @Published: \uac12 \ubcc0\uacbd \uc2dc \uc790\ub3d9\uc73c\ub85c View \uc5c5\ub370\uc774\ud2b8\n/// - @MainActor: \ubaa8\ub4e0 \uba54\uc11c\ub4dc\uac00 \uba54\uc778 \uc2a4\ub808\ub4dc\uc5d0\uc11c \uc2e4\ud589\ub418\uc5b4 UI \uc548\uc804 \ubcf4\uc7a5\n/// - Combine: \ube44\ub3d9\uae30 \uc774\ubca4\ud2b8 \uc2a4\ud2b8\ub9bc \uad00\ub9ac\n///\n/// \uc758\uc874\uc131:\n/// - RecordBodyCompositionUseCase: \uc2e0\uccb4 \uad6c\uc131 \uc800\uc7a5\n/// - FetchBodyTrendsUseCase: \ud2b8\ub80c\ub4dc \ub370\uc774\ud130 \uc870\ud68c\n/// - BodyRepositoryProtocol: \ub370\uc774\ud130 \uc601\uc18d\ud654\n/// - UserProfile: BMR/TDEE \uacc4\uc0b0\uc6a9 \uc0ac\uc6a9\uc790 \uc815\ubcf4\n///\n/// \uc0ac\uc6a9 \uc608\uc2dc:\n/// ```swift\n/// struct BodyCompositionView: View {\n///     @StateObject private var viewModel = BodyCompositionViewModel(\n///         recordBodyCompositionUseCase: recordUseCase,\n///         fetchBodyTrendsUseCase: trendsUseCase,\n///         bodyRepository: repository\n///     )\n///\n///     var body: some View {\n///         Form {\n///             Section(\"\uc785\ub825\") {\n///                 TextField(\"\uccb4\uc911 (kg)\", text: $viewModel.weightInput)\n///                 TextField(\"\uccb4\uc9c0\ubc29\ub960 (%)\", text: $viewModel.bodyFatPercentInput)\n///                 TextField(\"\uadfc\uc721\ub7c9 (kg)\", text: $viewModel.muscleMassInput)\n///\n///                 Button(\"\uc800\uc7a5\") {\n///                     Task {\n///                         await viewModel.saveBodyComposition()\n///                     }\n///                 }\n///                 .disabled(!viewModel.canSave)\n///             }\n///\n///             Section(\"\ucd5c\uadfc \uae30\ub85d\") {\n///                 ForEach(viewModel.history) { entry in\n///                     BodyEntryRow(entry: entry)\n///                 }\n///             }\n///         }\n///         .alert(\"\uc5d0\ub7ec\", isPresented: .constant(viewModel.errorMessage != nil)) {\n///             Button(\"\ud655\uc778\") { viewModel.errorMessage = nil }\n///         } message: {\n///             Text(viewModel.errorMessage ?? \"\")\n///         }\n///     }\n/// }\n/// ```\n///\n/// \ud83d\udca1 Android ViewModel\uacfc\uc758 \ube44\uad50:\n/// - Android: ViewModel + LiveData + Repository\n/// - SwiftUI: ObservableObject + @Published + Use Cases\n/// - Android: viewModelScope.launch\n/// - SwiftUI: Task { await ... } with @MainActor\n///\n",
        "last_modified": "2026-01-13T19:18:50.336462"
      },
      "task_intent": {
        "title": "Body Composition Tracking with BMR/TDEE",
        "description": "Complete body composition logging system including height, weight, body fat percentage, muscle mass, with automatic BMR (Mifflin-St Jeor) and TDEE calculations. Visualize changes over time with Swift Charts graphs showing trends and goal progress.",
        "from_plan": true
      },
      "commits_behind_main": 1,
      "status": "active",
      "merged_at": null
    }
  },
  "created_at": "2026-01-13T07:43:04.693958",
  "last_updated": "2026-01-13T07:46:22.936935"
}