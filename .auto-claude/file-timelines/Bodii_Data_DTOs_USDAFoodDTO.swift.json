{
  "file_path": "Bodii/Data/DTOs/USDAFoodDTO.swift",
  "main_branch_history": [],
  "task_views": {
    "005-korean-food-database-integration": {
      "task_id": "005-korean-food-database-integration",
      "branch_point": {
        "commit_hash": "c44bfbcd7c1699b176a8bb155e8c35f43ebd4ad9",
        "content": "",
        "timestamp": "2026-01-13T07:46:23.878686"
      },
      "worktree_state": {
        "content": "//\n//  USDAFoodDTO.swift\n//  Bodii\n//\n//  Created by Auto-Claude on 2026-01-12.\n//\n\n// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: USDA FoodData Central DTO\n// USDA API\uc758 \ubcf5\uc7a1\ud55c \uc911\ucca9 \uad6c\uc870\ub97c Swift \ud0c0\uc785\uc73c\ub85c \uc548\uc804\ud558\uac8c \ud30c\uc2f1\n// \ud83d\udca1 Java \ube44\uad50: Complex DTO with nested objects - KFDA\ubcf4\ub2e4 \ub354 \uae4a\uc740 \uc911\ucca9 \uad6c\uc870\n\nimport Foundation\n\n/// USDA FoodData Central API \uc2dd\ud488 \uc815\ubcf4 DTO\n///\n/// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Multi-Type Food Data\n/// USDA API\ub294 \uc5ec\ub7ec \uc2dd\ud488 \ud0c0\uc785\uc744 \uc9c0\uc6d0\ud569\ub2c8\ub2e4:\n/// - Foundation Foods: \uae30\ubcf8 \uc2dd\ud488 (\uc0ac\uacfc, \uc300 \ub4f1)\n/// - SR Legacy: Standard Reference \ub808\uac70\uc2dc \ub370\uc774\ud130\n/// - Branded Foods: \ube0c\ub79c\ub4dc \uc81c\ud488 (\ubc14\ucf54\ub4dc \uc788\ub294 \uc0c1\ud488)\n/// - Survey (FNDDS): \uc601\uc591 \uc870\uc0ac \ub370\uc774\ud130\n/// \ud83d\udca1 Java \ube44\uad50: Polymorphic DTO - \ub2e4\uc591\ud55c \ud0c0\uc785\uc744 \ud558\ub098\uc758 \uad6c\uc870\ub85c \ucc98\ub9ac\n///\n/// **API \uc751\ub2f5 \uad6c\uc870:**\n/// ```json\n/// {\n///   \"fdcId\": 123456,\n///   \"description\": \"Apple, raw\",\n///   \"dataType\": \"Foundation\",\n///   \"foodNutrients\": [\n///     { \"nutrientId\": 1008, \"value\": 52, \"unitName\": \"kcal\" },\n///     ...\n///   ],\n///   \"servingSize\": 100,\n///   \"servingSizeUnit\": \"g\",\n///   \"brandOwner\": \"Some Brand\",\n///   \"gtinUpc\": \"012345678901\"\n/// }\n/// ```\n///\n/// **\uc0ac\uc6a9 \uc608\uc2dc:**\n/// ```swift\n/// let decoder = JSONDecoder()\n/// let foodDTO = try decoder.decode(USDAFoodDTO.self, from: jsonData)\n/// let calories = foodDTO.foodNutrients?.value(for: USDANutrientID.energy)\n/// ```\n///\n/// **\ucc38\uace0:**\n/// - API \ubb38\uc11c: https://fdc.nal.usda.gov/api-guide.html\n/// - API Spec: https://app.swaggerhub.com/apis/fdcnal/food-data_central_api\nstruct USDAFoodDTO: Codable {\n\n    // MARK: - \uc2dd\ud488 \uae30\ubcf8 \uc815\ubcf4\n\n    /// FDC ID (Food Data Central \uace0\uc720 \uc2dd\ubcc4\uc790)\n    ///\n    /// USDA \uc2dd\ud488 \ub370\uc774\ud130\ubca0\uc774\uc2a4\uc758 \uace0\uc720 ID\n    /// API \ud638\ucd9c \ubc0f \uc911\ubcf5 \uccb4\ud06c\uc5d0 \uc0ac\uc6a9\n    let fdcId: Int\n\n    /// \uc2dd\ud488 \uc124\uba85 (\uc774\ub984)\n    ///\n    /// \uc601\ubb38 \uc2dd\ud488\uba85 (\uc608: \"Apple, raw\", \"Milk, whole\")\n    /// Branded \uc2dd\ud488\uc758 \uacbd\uc6b0 \ube0c\ub79c\ub4dc\uba85 \ud3ec\ud568\n    let description: String\n\n    /// \ub370\uc774\ud130 \ud0c0\uc785\n    ///\n    /// \uc2dd\ud488 \ub370\uc774\ud130\uc758 \ucd9c\ucc98/\ud0c0\uc785\n    /// - \"Foundation\": \uae30\ubcf8 \uc2dd\ud488\n    /// - \"SR Legacy\": Standard Reference \ub808\uac70\uc2dc\n    /// - \"Branded\": \ube0c\ub79c\ub4dc \uc81c\ud488\n    /// - \"Survey (FNDDS)\": \uc601\uc591 \uc870\uc0ac \ub370\uc774\ud130\n    let dataType: String?\n\n    /// \uc2dd\ud488 \ucf54\ub4dc (\uc120\ud0dd\uc801)\n    ///\n    /// Survey \ub370\uc774\ud130\uc758 \uacbd\uc6b0 \uc2dd\ud488 \ucf54\ub4dc \uc81c\uacf5\n    let foodCode: String?\n\n    /// \uac8c\uc2dc \ub0a0\uc9dc\n    ///\n    /// \ub370\uc774\ud130\uac00 FDC\uc5d0 \uac8c\uc2dc\ub41c \ub0a0\uc9dc (ISO 8601 \ud615\uc2dd)\n    let publicationDate: String?\n\n    // MARK: - \uc601\uc591 \uc815\ubcf4\n\n    /// \uc601\uc591\uc18c \ubc30\uc5f4\n    ///\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Array of Nutrients\n    /// KFDA\uc640 \ub2ec\ub9ac USDA\ub294 \uc601\uc591\uc18c\ub97c \ubc30\uc5f4\ub85c \uc81c\uacf5\n    /// \uac01 \uc601\uc591\uc18c\ub294 ID\ub85c \uc2dd\ubcc4\ub428\n    /// \ud83d\udca1 Java \ube44\uad50: List<Nutrient> - \ub3d9\uc801 \uc601\uc591\uc18c \ubaa9\ub85d\n    let foodNutrients: [USDANutrientDTO]?\n\n    // MARK: - \uc81c\uacf5\ub7c9 \uc815\ubcf4\n\n    /// 1\ud68c \uc81c\uacf5\ub7c9 \ud06c\uae30\n    ///\n    /// \uc601\uc591 \uc815\ubcf4\uc758 \uae30\uc900\uc774 \ub418\ub294 \uc81c\uacf5\ub7c9\n    /// Branded \uc2dd\ud488\uc5d0\uc11c \uc8fc\ub85c \uc81c\uacf5\ub428\n    let servingSize: Double?\n\n    /// \uc81c\uacf5\ub7c9 \ub2e8\uc704\n    ///\n    /// \uc81c\uacf5\ub7c9\uc758 \ub2e8\uc704 (\uc608: \"g\", \"ml\", \"oz\")\n    let servingSizeUnit: String?\n\n    /// \uac00\uad6c \uc81c\uacf5\ub7c9 \uc124\uba85 (\uc120\ud0dd\uc801)\n    ///\n    /// \uc0ac\uc6a9\uc790 \uce5c\ud654\uc801 \uc81c\uacf5\ub7c9 \ud45c\uc2dc (\uc608: \"1 cup\", \"1 medium apple\")\n    let householdServingFullText: String?\n\n    // MARK: - \ube0c\ub79c\ub4dc \uc2dd\ud488 \uc815\ubcf4\n\n    /// \ube0c\ub79c\ub4dc \uc18c\uc720\uc790\n    ///\n    /// Branded \uc2dd\ud488\uc758 \uc81c\uc870\uc0ac/\ube0c\ub79c\ub4dc\uba85\n    let brandOwner: String?\n\n    /// \ube0c\ub79c\ub4dc\uba85\n    ///\n    /// Branded \uc2dd\ud488\uc758 \uc81c\ud488 \ube0c\ub79c\ub4dc\n    let brandName: String?\n\n    /// GTIN/UPC \ubc14\ucf54\ub4dc\n    ///\n    /// \uc81c\ud488 \ubc14\ucf54\ub4dc \ubc88\ud638 (Branded \uc2dd\ud488)\n    let gtinUpc: String?\n\n    /// \uc131\ubd84 \ub9ac\uc2a4\ud2b8\n    ///\n    /// Branded \uc2dd\ud488\uc758 \uc6d0\uc7ac\ub8cc \ubaa9\ub85d (\uc601\ubb38)\n    let ingredients: String?\n\n    // MARK: - \uc2dd\ud488 \uce74\ud14c\uace0\ub9ac\n\n    /// \uc2dd\ud488 \uce74\ud14c\uace0\ub9ac ID\n    ///\n    /// USDA \uc2dd\ud488 \ubd84\ub958 ID\n    let foodCategoryId: Int?\n\n    /// \uc2dd\ud488 \uce74\ud14c\uace0\ub9ac\uba85\n    ///\n    /// USDA \uc2dd\ud488 \ubd84\ub958\uba85 (\uc608: \"Fruits and Fruit Juices\")\n    let foodCategory: String?\n\n    // MARK: - \ucd94\uac00 \uba54\ud0c0\ub370\uc774\ud130\n\n    /// \uacfc\ud559\uc801 \uc774\ub984 (\uc120\ud0dd\uc801)\n    ///\n    /// \uc2dd\ud488\uc758 \ud559\uba85 (\uc608: \"Malus domestica\" for apple)\n    let scientificName: String?\n\n    /// \ubaa8\ub4e0 \uce74\ud14c\uace0\ub9ac \uc815\ubcf4 (\uc120\ud0dd\uc801)\n    ///\n    /// \uc2dd\ud488\uc774 \uc18d\ud55c \ubaa8\ub4e0 \uce74\ud14c\uace0\ub9ac \uc815\ubcf4\n    let allHighlightFields: String?\n\n    /// \uc810\uc218 (\uc120\ud0dd\uc801)\n    ///\n    /// \uac80\uc0c9 \uacb0\uacfc\uc758 \uad00\ub828\ub3c4 \uc810\uc218\n    let score: Double?\n\n    // MARK: - CodingKeys\n\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: CodingKeys\n    /// USDA API\ub294 camelCase\ub97c \uc0ac\uc6a9\ud558\uc9c0\ub9cc \uba85\uc2dc\uc801 \ub9e4\ud551\uc73c\ub85c \uc548\uc815\uc131 \ud655\ubcf4\n    /// \ud83d\udca1 Java \ube44\uad50: @JsonProperty \uc5b4\ub178\ud14c\uc774\uc158\uacfc \uc720\uc0ac\n    enum CodingKeys: String, CodingKey {\n        case fdcId = \"fdcId\"\n        case description = \"description\"\n        case dataType = \"dataType\"\n        case foodCode = \"foodCode\"\n        case publicationDate = \"publicationDate\"\n        case foodNutrients = \"foodNutrients\"\n        case servingSize = \"servingSize\"\n        case servingSizeUnit = \"servingSizeUnit\"\n        case householdServingFullText = \"householdServingFullText\"\n        case brandOwner = \"brandOwner\"\n        case brandName = \"brandName\"\n        case gtinUpc = \"gtinUpc\"\n        case ingredients = \"ingredients\"\n        case foodCategoryId = \"foodCategoryId\"\n        case foodCategory = \"foodCategory\"\n        case scientificName = \"scientificName\"\n        case allHighlightFields = \"allHighlightFields\"\n        case score = \"score\"\n    }\n}\n\n// MARK: - Helper Extensions\n\nextension USDAFoodDTO {\n\n    /// \ud2b9\uc815 \uc601\uc591\uc18c \uac12 \uac00\uc838\uc624\uae30\n    ///\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Convenience Method\n    /// \uc601\uc591\uc18c \ubc30\uc5f4\uc5d0\uc11c \ud2b9\uc815 \uc601\uc591\uc18c\ub97c \uc27d\uac8c \ucc3e\uc744 \uc218 \uc788\ub3c4\ub85d \ud5ec\ud37c \uba54\uc11c\ub4dc \uc81c\uacf5\n    /// \ud83d\udca1 Java \ube44\uad50: Stream API filter\uc640 \uc720\uc0ac\n    ///\n    /// - Parameter nutrientId: \uc601\uc591\uc18c ID\n    ///\n    /// - Returns: \uc601\uc591\uc18c \uac12 (\uc5c6\uc73c\uba74 nil)\n    ///\n    /// - Example:\n    /// ```swift\n    /// let calories = foodDTO.getNutrientValue(USDANutrientID.energy)\n    /// let protein = foodDTO.getNutrientValue(USDANutrientID.protein)\n    /// ```\n    func getNutrientValue(_ nutrientId: Int) -> Double? {\n        return foodNutrients?.value(for: nutrientId)\n    }\n\n    /// \ud2b9\uc815 \uc601\uc591\uc18c Decimal \uac12 \uac00\uc838\uc624\uae30\n    ///\n    /// - Parameter nutrientId: \uc601\uc591\uc18c ID\n    ///\n    /// - Returns: Decimal \uc601\uc591\uc18c \uac12 (\uc5c6\uc73c\uba74 nil)\n    func getNutrientDecimalValue(_ nutrientId: Int) -> Decimal? {\n        return foodNutrients?.decimalValue(for: nutrientId)\n    }\n\n    /// \ud2b9\uc815 \uc601\uc591\uc18c Int32 \uac12 \uac00\uc838\uc624\uae30\n    ///\n    /// - Parameter nutrientId: \uc601\uc591\uc18c ID\n    ///\n    /// - Returns: Int32 \uc601\uc591\uc18c \uac12 (\uc5c6\uc73c\uba74 nil)\n    func getNutrientInt32Value(_ nutrientId: Int) -> Int32? {\n        return foodNutrients?.int32Value(for: nutrientId)\n    }\n\n    /// \uc81c\uacf5\ub7c9 \ud06c\uae30\ub97c Decimal\ub85c \ubcc0\ud658\n    ///\n    /// - Returns: Decimal \uc81c\uacf5\ub7c9 (\uc5c6\uc73c\uba74 100g \uae30\ubcf8\uac12)\n    func getServingSizeDecimal() -> Decimal {\n        guard let servingSize = servingSize else {\n            return 100 // \uae30\ubcf8\uac12: 100g\n        }\n        return Decimal(servingSize)\n    }\n}\n\n// MARK: - Food Type Helpers\n\nextension USDAFoodDTO {\n\n    /// Branded \uc2dd\ud488 \uc5ec\ubd80\n    ///\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Computed Property\n    /// \uc2dd\ud488 \ud0c0\uc785\uc744 \ud310\ub2e8\ud558\ub294 \ud3b8\uc758 \ud504\ub85c\ud37c\ud2f0\n    /// \ud83d\udca1 Java \ube44\uad50: getter \uba54\uc11c\ub4dc\uc640 \ub3d9\uc77c\ud558\uc9c0\ub9cc \ub354 \uac04\uacb0\n    ///\n    /// - Returns: Branded \uc2dd\ud488\uc774\uba74 true\n    var isBranded: Bool {\n        return dataType?.lowercased() == \"branded\"\n    }\n\n    /// Foundation \uc2dd\ud488 \uc5ec\ubd80\n    ///\n    /// - Returns: Foundation \uc2dd\ud488\uc774\uba74 true\n    var isFoundation: Bool {\n        return dataType?.lowercased() == \"foundation\"\n    }\n\n    /// SR Legacy \uc2dd\ud488 \uc5ec\ubd80\n    ///\n    /// - Returns: SR Legacy \uc2dd\ud488\uc774\uba74 true\n    var isSRLegacy: Bool {\n        return dataType?.lowercased() == \"sr legacy\"\n    }\n\n    /// Survey \uc2dd\ud488 \uc5ec\ubd80\n    ///\n    /// - Returns: Survey \uc2dd\ud488\uc774\uba74 true\n    var isSurvey: Bool {\n        return dataType?.lowercased().contains(\"survey\") ?? false\n    }\n\n    /// \uc2dd\ud488 \ud0c0\uc785 \ud45c\uc2dc\uba85\n    ///\n    /// \uc0ac\uc6a9\uc790\uc5d0\uac8c \ubcf4\uc5ec\uc904 \uc2dd\ud488 \ud0c0\uc785\uba85 (\ud55c\uae00)\n    ///\n    /// - Returns: \ud55c\uae00 \ud0c0\uc785\uba85\n    var dataTypeDisplayName: String {\n        guard let dataType = dataType else {\n            return \"\uc54c \uc218 \uc5c6\uc74c\"\n        }\n\n        switch dataType.lowercased() {\n        case \"branded\":\n            return \"\ube0c\ub79c\ub4dc \uc81c\ud488\"\n        case \"foundation\":\n            return \"\uae30\ubcf8 \uc2dd\ud488\"\n        case \"sr legacy\":\n            return \"\ud45c\uc900 \ucc38\uace0 \ub370\uc774\ud130\"\n        case let type where type.contains(\"survey\"):\n            return \"\uc601\uc591 \uc870\uc0ac \ub370\uc774\ud130\"\n        default:\n            return dataType\n        }\n    }\n}\n\n// MARK: - Validation\n\nextension USDAFoodDTO {\n\n    /// DTO\uc758 \ud544\uc218 \ud544\ub4dc\uac00 \uc720\ud6a8\ud55c\uc9c0 \uac80\uc99d\n    ///\n    /// \ud83d\udcda \ud559\uc2b5 \ud3ec\uc778\ud2b8: Data Validation\n    /// \ud30c\uc2f1 \ud6c4 \ud544\uc218 \ub370\uc774\ud130\uac00 \uc788\ub294\uc9c0 \uac80\uc99d\ud558\uc5ec \uc798\ubabb\ub41c \ub370\uc774\ud130 \uac78\ub7ec\ub0b4\uae30\n    /// \ud83d\udca1 Java \ube44\uad50: Bean Validation\uacfc \uc720\uc0ac\n    ///\n    /// - Returns: \uc720\ud6a8\ud558\uba74 true, \ud544\uc218 \ud544\ub4dc \ub204\ub77d \uc2dc false\n    ///\n    /// **\uac80\uc99d \ud56d\ubaa9:**\n    /// - FDC ID \uc874\uc7ac \uc5ec\ubd80\n    /// - \uc2dd\ud488\uba85 \uc874\uc7ac \uc5ec\ubd80\n    /// - \uc601\uc591\uc18c \ubc30\uc5f4 \uc874\uc7ac \ubc0f \ucd5c\uc18c \ud558\ub098 \uc774\uc0c1\uc758 \uc601\uc591\uc18c\n    var isValid: Bool {\n        // FDC ID\ub294 \ud56d\uc0c1 \uc874\uc7ac (non-optional)\n\n        // \uc2dd\ud488\uba85 \uac80\uc99d\n        guard !description.isEmpty else {\n            return false\n        }\n\n        // \ucd5c\uc18c \ud558\ub098 \uc774\uc0c1\uc758 \uc601\uc591\uc18c \ud544\uc694\n        guard let nutrients = foodNutrients, !nutrients.isEmpty else {\n            return false\n        }\n\n        // \uce7c\ub85c\ub9ac \uc815\ubcf4\uac00 \uc788\ub294\uc9c0 \ud655\uc778 (\ud544\uc218 \uc601\uc591\uc18c)\n        let hasCalories = nutrients.contains { $0.nutrientId == USDANutrientID.energy }\n\n        return hasCalories\n    }\n}\n",
        "last_modified": "2026-01-14T22:55:39.258942"
      },
      "task_intent": {
        "title": "005-korean-food-database-integration",
        "description": "Integrate Korean Food & Drug Administration (\uc2dd\uc57d\ucc98) food nutrition database API as primary source, with USDA FoodData Central as fallback for international foods. Prioritize Korean dishes (kimchi jjigae, bibimbap, tteokbokki) that are poorly covered by competitors.",
        "from_plan": true
      },
      "commits_behind_main": 0,
      "status": "active",
      "merged_at": null
    }
  },
  "created_at": "2026-01-13T07:43:31.744563",
  "last_updated": "2026-01-13T07:46:23.911508"
}