{
  "file_path": "Bodii/Domain/UseCases/Exercise/DeleteExerciseRecordUseCase.swift",
  "main_branch_history": [],
  "task_views": {
    "008-exercise-tracking-with-met-calculations": {
      "task_id": "008-exercise-tracking-with-met-calculations",
      "branch_point": {
        "commit_hash": "4e56d606f7b0d4cb74120dd392544f3fe2d4f5b4",
        "content": "",
        "timestamp": "2026-01-14T11:45:41.765455"
      },
      "worktree_state": {
        "content": "//\n//  DeleteExerciseRecordUseCase.swift\n//  Bodii\n//\n//  Created by Auto-Claude on 2026-01-14.\n//\n\nimport Foundation\n\n/// \uc6b4\ub3d9 \uae30\ub85d \uc0ad\uc81c \uc720\uc2a4\ucf00\uc774\uc2a4\n///\n/// \uae30\uc874 \uc6b4\ub3d9 \uae30\ub85d\uc744 \uc0ad\uc81c\ud558\uace0 DailyLog\ub97c \uc5c5\ub370\uc774\ud2b8\ud569\ub2c8\ub2e4.\n///\n/// ## \ucc45\uc784\n/// - \uc6b4\ub3d9 \uae30\ub85d \uc870\ud68c (ID\ub85c)\n/// - \uc0ac\uc6a9\uc790 \uad8c\ud55c \ud655\uc778\n/// - DailyLog \uc5c5\ub370\uc774\ud2b8 (\uce7c\ub85c\ub9ac \ubc0f \uc2dc\uac04 \ucc28\uac10)\n/// - ExerciseRecord \uc0ad\uc81c\n///\n/// ## \uc758\uc874\uc131\n/// - ExerciseRecordRepository: \uc6b4\ub3d9 \uae30\ub85d \uc870\ud68c \ubc0f \uc0ad\uc81c\n/// - DailyLogService: DailyLog \uc5c5\ub370\uc774\ud2b8\n///\n/// ## \uc0ac\uc6a9 \uc2dc\ub098\ub9ac\uc624\n/// ```swift\n/// let useCase = DeleteExerciseRecordUseCase(\n///     exerciseRepository: exerciseRepository,\n///     dailyLogService: dailyLogService\n/// )\n///\n/// try await useCase.execute(\n///     recordId: existingRecord.id,\n///     userId: userId\n/// )\n/// ```\n///\n/// ## \uc5d0\ub7ec \ucf00\uc774\uc2a4\n/// - recordId\uc5d0 \ud574\ub2f9\ud558\ub294 \uae30\ub85d\uc774 \uc5c6\uc74c: RecordNotFoundError\n/// - userId \ubd88\uc77c\uce58: UnauthorizedError\nfinal class DeleteExerciseRecordUseCase {\n\n    // MARK: - Properties\n\n    /// \uc6b4\ub3d9 \uae30\ub85d \uc800\uc7a5\uc18c\n    private let exerciseRepository: ExerciseRecordRepository\n\n    /// DailyLog \uad00\ub9ac \uc11c\ube44\uc2a4\n    private let dailyLogService: DailyLogService\n\n    // MARK: - Initialization\n\n    /// DeleteExerciseRecordUseCase \ucd08\uae30\ud654\n    ///\n    /// - Parameters:\n    ///   - exerciseRepository: \uc6b4\ub3d9 \uae30\ub85d \uc800\uc7a5\uc18c\n    ///   - dailyLogService: DailyLog \uad00\ub9ac \uc11c\ube44\uc2a4\n    init(\n        exerciseRepository: ExerciseRecordRepository,\n        dailyLogService: DailyLogService\n    ) {\n        self.exerciseRepository = exerciseRepository\n        self.dailyLogService = dailyLogService\n    }\n\n    // MARK: - Public Methods\n\n    /// \uc6b4\ub3d9 \uae30\ub85d\uc744 \uc0ad\uc81c\ud569\ub2c8\ub2e4.\n    ///\n    /// ## \uc2e4\ud589 \uc21c\uc11c\n    /// 1. \uae30\uc874 \uc6b4\ub3d9 \uae30\ub85d \uc870\ud68c (ID\ub85c)\n    /// 2. \uad8c\ud55c \ud655\uc778 (userId \uc77c\uce58 \uc5ec\ubd80)\n    /// 3. DailyLogService\ub97c \ud1b5\ud574 DailyLog \uc5c5\ub370\uc774\ud2b8 (\uce7c\ub85c\ub9ac \ubc0f \uc2dc\uac04 \ucc28\uac10)\n    /// 4. ExerciseRecord \uc0ad\uc81c\n    ///\n    /// - Parameters:\n    ///   - recordId: \uc0ad\uc81c\ud560 \uc6b4\ub3d9 \uae30\ub85d ID\n    ///   - userId: \uc0ac\uc6a9\uc790 ID\n    ///\n    /// - Throws:\n    ///   - RecordNotFoundError: \uc6b4\ub3d9 \uae30\ub85d\uc744 \ucc3e\uc744 \uc218 \uc5c6\uc744 \ub54c\n    ///   - UnauthorizedError: userId\uac00 \uc77c\uce58\ud558\uc9c0 \uc54a\uc744 \ub54c\n    ///   - RepositoryError: \uc0ad\uc81c \uc2e4\ud328 \uc2dc\n    ///\n    /// - Example:\n    /// ```swift\n    /// do {\n    ///     try await useCase.execute(\n    ///         recordId: record.id,\n    ///         userId: user.id\n    ///     )\n    ///     print(\"\uc6b4\ub3d9 \uae30\ub85d \uc0ad\uc81c \uc644\ub8cc\")\n    /// } catch {\n    ///     print(\"\uc6b4\ub3d9 \uae30\ub85d \uc0ad\uc81c \uc2e4\ud328: \\(error)\")\n    /// }\n    /// ```\n    func execute(\n        recordId: UUID,\n        userId: UUID\n    ) async throws {\n        // 1. \uae30\uc874 \uc6b4\ub3d9 \uae30\ub85d \uc870\ud68c\n        guard let existingRecord = try await exerciseRepository.fetchById(recordId, userId: userId) else {\n            throw RecordNotFoundError.exerciseRecordNotFound(\"\uc6b4\ub3d9 \uae30\ub85d\uc744 \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.\")\n        }\n\n        // 2. \uad8c\ud55c \ud655\uc778\n        guard existingRecord.userId == userId else {\n            throw UnauthorizedError.notOwner(\"\ud574\ub2f9 \uc6b4\ub3d9 \uae30\ub85d\uc744 \uc0ad\uc81c\ud560 \uad8c\ud55c\uc774 \uc5c6\uc2b5\ub2c8\ub2e4.\")\n        }\n\n        // 3. DailyLog \uc5c5\ub370\uc774\ud2b8 (\uce7c\ub85c\ub9ac \ubc0f \uc2dc\uac04 \ucc28\uac10)\n        try await dailyLogService.removeExercise(\n            date: existingRecord.date,\n            userId: userId,\n            calories: existingRecord.caloriesBurned,\n            duration: existingRecord.duration\n        )\n\n        // 4. ExerciseRecord \uc0ad\uc81c\n        try await exerciseRepository.delete(id: recordId, userId: userId)\n    }\n}\n\n// MARK: - Delete Pattern \uc124\uba85\n\n/// ## Delete UseCase Pattern\n///\n/// Delete UseCase\ub294 \ub370\uc774\ud130\ub97c \uc0ad\uc81c\ud560 \ub54c \ub2e4\uc74c \ud328\ud134\uc744 \ub530\ub985\ub2c8\ub2e4:\n///\n/// ### 1. \uae30\uc874 \ub370\uc774\ud130 \uc870\ud68c\n/// ```swift\n/// guard let existingRecord = try await repository.fetchById(id, userId: userId) else {\n///     throw RecordNotFoundError.exerciseRecordNotFound(\"...\")\n/// }\n/// ```\n///\n/// ### 2. \uad8c\ud55c \ud655\uc778\n/// ```swift\n/// guard existingRecord.userId == userId else {\n///     throw UnauthorizedError.notOwner(\"...\")\n/// }\n/// ```\n///\n/// ### 3. \uc5f0\uad00 \ub370\uc774\ud130 \uc815\ub9ac (DailyLog \uc5c5\ub370\uc774\ud2b8)\n/// ```swift\n/// try await dailyLogService.removeExercise(\n///     date: existingRecord.date,\n///     userId: userId,\n///     calories: existingRecord.caloriesBurned,\n///     duration: existingRecord.duration\n/// )\n/// ```\n///\n/// ### 4. \ub370\uc774\ud130 \uc0ad\uc81c\n/// ```swift\n/// try await exerciseRepository.delete(id: recordId, userId: userId)\n/// ```\n///\n/// ### \uc65c \uc774\ub7f0 \ud328\ud134\uc744 \uc0ac\uc6a9\ud558\ub294\uac00?\n///\n/// 1. **\ub370\uc774\ud130 \uc77c\uad00\uc131**:\n///    - \uc0ad\uc81c \uc804 \uc874\uc7ac \uc5ec\ubd80 \ud655\uc778\n///    - DailyLog\uc640 ExerciseRecord \uac04 \uc77c\uad00\uc131 \uc720\uc9c0\n///\n/// 2. **\ubcf4\uc548**:\n///    - userId \ud655\uc778\uc73c\ub85c \ub2e4\ub978 \uc0ac\uc6a9\uc790\uc758 \uae30\ub85d \uc0ad\uc81c \ubc29\uc9c0\n///    - \uad8c\ud55c \uac80\uc99d\uc740 \ud544\uc218\n///\n/// 3. **\uc5f0\uad00 \ub370\uc774\ud130 \ucc98\ub9ac**:\n///    - ExerciseRecord\ub97c \uc0ad\uc81c\ud558\uae30 \uc804\uc5d0 DailyLog\uc5d0\uc11c \ud574\ub2f9 \uac12\uc744 \ucc28\uac10\n///    - \uc0ad\uc81c \uc21c\uc11c\uac00 \uc911\uc694: DailyLog \uc5c5\ub370\uc774\ud2b8 \u2192 ExerciseRecord \uc0ad\uc81c\n///\n/// 4. **\ud2b8\ub79c\uc7ad\uc158 \ubb34\uacb0\uc131**:\n///    - DailyLog \uc5c5\ub370\uc774\ud2b8\uc640 ExerciseRecord \uc0ad\uc81c\ub97c \uc21c\ucc28\uc801\uc73c\ub85c \uc2e4\ud589\n///    - \ud558\ub098\ub77c\ub3c4 \uc2e4\ud328\ud558\uba74 \uc804\uccb4 \ub864\ubc31 (async/await\uc758 throw \uba54\ucee4\ub2c8\uc998)\n///\n/// 5. **\uac10\uc0ac \ucd94\uc801**:\n///    - \uae30\uc874 \uae30\ub85d\uc744 \uba3c\uc800 \uc870\ud68c\ud558\uc5ec \uc0ad\uc81c\ud560 \ub370\uc774\ud130\ub97c \ud655\uc778\n///    - \ub85c\uae45\uc774 \ud544\uc694\ud55c \uacbd\uc6b0 \uc0ad\uc81c \uc804 \uae30\ub85d \ub0b4\uc6a9 \uc800\uc7a5 \uac00\ub2a5\n///\n/// ### Add vs Update vs Delete \ucc28\uc774\uc810\n///\n/// **Add (\uc0dd\uc131)**:\n/// 1. \uc785\ub825\uac12 \uac80\uc99d\n/// 2. \uce7c\ub85c\ub9ac \uacc4\uc0b0\n/// 3. ExerciseRecord \uc0dd\uc131\n/// 4. DailyLog \uc99d\uac00 (addExercise)\n///\n/// **Update (\uc218\uc815)**:\n/// 1. \uae30\uc874 \uae30\ub85d \uc870\ud68c \ubc0f \uad8c\ud55c \ud655\uc778\n/// 2. \uc785\ub825\uac12 \uac80\uc99d\n/// 3. \uce7c\ub85c\ub9ac \uc7ac\uacc4\uc0b0 (\ud544\uc694 \uc2dc)\n/// 4. ExerciseRecord \uc5c5\ub370\uc774\ud2b8\n/// 5. DailyLog \uc870\uc815 (updateExercise - \ucc28\uc774\uac12\ub9cc\ud07c)\n///\n/// **Delete (\uc0ad\uc81c)**:\n/// 1. \uae30\uc874 \uae30\ub85d \uc870\ud68c \ubc0f \uad8c\ud55c \ud655\uc778\n/// 2. DailyLog \uac10\uc18c (removeExercise)\n/// 3. ExerciseRecord \uc0ad\uc81c\n///\n/// ### \uc0ad\uc81c \uc21c\uc11c\uc758 \uc911\uc694\uc131\n///\n/// ```swift\n/// // \u2705 \uc62c\ubc14\ub978 \uc21c\uc11c: DailyLog \uba3c\uc800 \uc5c5\ub370\uc774\ud2b8\n/// try await dailyLogService.removeExercise(...)\n/// try await exerciseRepository.delete(...)\n///\n/// // \u274c \uc798\ubabb\ub41c \uc21c\uc11c: ExerciseRecord\ub97c \uba3c\uc800 \uc0ad\uc81c\ud558\uba74\n/// //    removeExercise\uc5d0\uc11c \ucc38\uc870\ud560 \ub370\uc774\ud130\uac00 \uc0ac\ub77c\uc9d0\n/// try await exerciseRepository.delete(...)\n/// try await dailyLogService.removeExercise(...)  // \uc774\ubbf8 \uc0ad\uc81c\ub428!\n/// ```\n///\n/// \uc0ad\uc81c \uc804\uc5d0 \uae30\ub85d\uc744 \uba3c\uc800 \uc870\ud68c\ud558\ub294 \uc774\uc720:\n/// - DailyLog \uc5c5\ub370\uc774\ud2b8\uc5d0 \ud544\uc694\ud55c \uc815\ubcf4 (date, calories, duration) \ud655\ubcf4\n/// - \uc0ad\uc81c \ud6c4\uc5d0\ub294 \uc774 \uc815\ubcf4\ub97c \uc5bb\uc744 \uc218 \uc5c6\uc74c\n///\n/// ### \uc0ac\uc6a9 \uc608\uc2dc\n///\n/// ```swift\n/// // ViewModel\uc5d0\uc11c DeleteExerciseRecordUseCase \uc0ac\uc6a9\n/// final class ExerciseListViewModel: ObservableObject {\n///     let deleteExerciseUseCase: DeleteExerciseRecordUseCase\n///\n///     func deleteExercise(recordId: UUID) async {\n///         do {\n///             try await deleteExerciseUseCase.execute(\n///                 recordId: recordId,\n///                 userId: currentUser.id\n///             )\n///             // UI \uc5c5\ub370\uc774\ud2b8: \ub9ac\uc2a4\ud2b8\uc5d0\uc11c \uc81c\uac70\n///             await loadExercises()\n///             self.isSuccess = true\n///         } catch RecordNotFoundError.exerciseRecordNotFound {\n///             self.errorMessage = \"\uc6b4\ub3d9 \uae30\ub85d\uc744 \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.\"\n///         } catch UnauthorizedError.notOwner {\n///             self.errorMessage = \"\uc0ad\uc81c \uad8c\ud55c\uc774 \uc5c6\uc2b5\ub2c8\ub2e4.\"\n///         } catch {\n///             self.errorMessage = \"\uc0ad\uc81c \uc2e4\ud328: \\(error.localizedDescription)\"\n///         }\n///     }\n/// }\n/// ```\n///\n/// ### SwiftUI\uc5d0\uc11c \uc2a4\uc640\uc774\ud504 \uc0ad\uc81c \uad6c\ud604\n///\n/// ```swift\n/// List {\n///     ForEach(exercises) { exercise in\n///         ExerciseCardView(exercise: exercise)\n///     }\n///     .onDelete { indexSet in\n///         Task {\n///             for index in indexSet {\n///                 await viewModel.deleteExercise(recordId: exercises[index].id)\n///             }\n///         }\n///     }\n/// }\n/// ```\n///\n",
        "last_modified": "2026-01-14T22:54:09.702331"
      },
      "task_intent": {
        "title": "008-exercise-tracking-with-met-calculations",
        "description": "Exercise logging with activity type selection, duration input, and automatic calorie burn calculation using MET (Metabolic Equivalent of Task) values. Track both cardio and strength training with appropriate calculations.",
        "from_plan": true
      },
      "commits_behind_main": 0,
      "status": "active",
      "merged_at": null
    }
  },
  "created_at": "2026-01-13T19:19:05.928108",
  "last_updated": "2026-01-14T11:45:41.834452"
}